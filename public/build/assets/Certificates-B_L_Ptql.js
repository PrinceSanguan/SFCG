import{r as k,m as B,j as e,S as je}from"./app-nH0SzvUH.js";import{S as ue,H as ve}from"./sidebar-DneP32xg.js";import{C as S,b as N,c as C,a as T}from"./card-C4qXfvMZ.js";import{B as d}from"./button-DhH8EpEa.js";import{I as g}from"./input-ST8ZYCGV.js";import{L as l}from"./label-CRPGJHJl.js";import{S as c,a as x,b as h,c as o,d as a}from"./select-Cnrkrjq_.js";import{T as Q,a as W,b as A,c as i,d as X,e as t}from"./table-CHxxPrQt.js";import{T as V}from"./textarea-q4f401Hd.js";import{B as E}from"./badge-CBS6BzxF.js";import{T as ge,a as pe,b as F,c as L}from"./tabs-Boyk5FkQ.js";import{A as _e}from"./arrow-left-CNy3xEct.js";import{S as fe}from"./search-PVC3fRIF.js";import{D as Z}from"./download-CsJ5gOgS.js";import{P as $}from"./printer-AkLimiJY.js";/* empty css            */import"./dropdown-menu-Ch1dNX-Z.js";import"./Combination-DSCjxEv7.js";import"./index-C9Ugd_18.js";import"./separator-Dqi1mLPr.js";import"./users-D35yk6zG.js";import"./chevron-right-afLOw3M3.js";import"./crown-Dv05iJeY.js";import"./building-2-B0oZVMMy.js";import"./user-cog-r5XBBelc.js";import"./book-open-CxJeVQF-.js";import"./user-check-CxoH7Qjp.js";import"./graduation-cap-DN4JBiD6.js";import"./notebook-iqL4tuMj.js";import"./chart-no-axes-column-increasing-SxqXtg5F.js";import"./index-DGzOptAG.js";import"./index-CnK_qUoU.js";import"./check-uNOHOelt.js";function es({user:P,academicLevels:m,templates:j,recentCertificates:G,schoolYears:n}){const[Y,q]=k.useState((n==null?void 0:n[0])??"2024-2025"),[ee,se]=k.useState("templates"),[p,R]=k.useState({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),[z,H]=k.useState([]),[I,K]=k.useState(!1),{data:f,setData:b,post:le,processing:U}=B({student_id:"",template_id:"",academic_level_id:"",school_year:"",notes:""}),{data:r,setData:v,post:ae,processing:M}=B({academic_level_id:"",key:"",name:"",title:"Certificate",intro_line:"This is to certify that",student_id_label:"Student ID:",requirement_text:"has fulfilled the requirements for",additional_rules:""}),{data:w,setData:D,post:te,processing:J}=B({template_id:"",academic_level_id:"",school_year:"",student_ids_text:""});k.useEffect(()=>{m&&m.length>0&&v("academic_level_id",m[0].id.toString()),n&&n.length>0&&(q(n[0]),b("school_year",n[0]))},[m,n]);const ie=()=>{le(route("admin.academic.certificates.generate"),{onSuccess:()=>{b({student_id:"",template_id:"",academic_level_id:"",school_year:"",notes:""})}})},ne=()=>{ae(route("admin.academic.certificates.templates.store"),{onSuccess:()=>{v({academic_level_id:"",key:"",name:"",title:"Certificate",intro_line:"This is to certify that",student_id_label:"Student ID:",requirement_text:"has fulfilled the requirements for",additional_rules:""})}})},re=()=>{te(route("admin.academic.certificates.generate-bulk"),{onSuccess:()=>{D({template_id:"",academic_level_id:"",school_year:"",student_ids_text:""})}})},de=s=>{s.preventDefault(),K(!0),setTimeout(()=>{K(!1),H(G.filter(u=>u.serial_number.toLowerCase().includes(p.serial_number.toLowerCase())||u.student.name.toLowerCase().includes(p.student_name.toLowerCase())))},500)},y=(s,u)=>{R(_=>({..._,[s]:u}))},ce=()=>{R({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),H([])},xe=s=>{const _={generated:{variant:"secondary",text:"Generated"},downloaded:{variant:"default",text:"Downloaded"},printed:{variant:"outline",text:"Printed"},pending:{variant:"destructive",text:"Pending"}}[s]||{variant:"secondary",text:s};return e.jsx(E,{variant:_.variant,children:_.text})},he=s=>s?new Date(s).toLocaleString():"-",oe=(j==null?void 0:j.filter(s=>!f.academic_level_id||s.academic_level_id.toString()===f.academic_level_id))??[],me=(j==null?void 0:j.filter(s=>!w.academic_level_id||s.academic_level_id.toString()===w.academic_level_id))??[];return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(ue,{user:P}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(ve,{user:P}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>je.get("/registrar/academic"),children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Back to Academic"]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Certificates"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Templates, generation (individual/bulk), download and print tracking."})]}),e.jsxs(ge,{value:ee,onValueChange:se,className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-4",children:[e.jsx(F,{value:"templates",children:"Templates"}),e.jsx(F,{value:"generate",children:"Generate"}),e.jsx(F,{value:"bulk",children:"Bulk Generate"}),e.jsx(F,{value:"certificates",children:"All Certificates"})]}),e.jsxs(L,{value:"templates",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{className:"flex items-center gap-2",children:"Template Builder & Preview"})}),e.jsx(T,{children:e.jsxs("form",{onSubmit:s=>{s.preventDefault(),ne()},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(c,{value:r.academic_level_id,onValueChange:s=>v("academic_level_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select level"})}),e.jsx(o,{children:m.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"school_year",children:"School Year (Preview)"}),e.jsxs(c,{value:Y,onValueChange:q,children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsx(o,{children:n.map(s=>e.jsx(a,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"key",children:"Template Key"}),e.jsx(g,{id:"key",value:r.key,onChange:s=>v("key",s.target.value),placeholder:"e.g., elementary_recognition_v2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Template Name"}),e.jsx(g,{id:"name",value:r.name,onChange:s=>v("name",s.target.value),placeholder:"Display name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"title",children:"Title"}),e.jsx(g,{id:"title",value:r.title,onChange:s=>v("title",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"intro_line",children:"Intro line"}),e.jsx(g,{id:"intro_line",value:r.intro_line,onChange:s=>v("intro_line",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"student_id_label",children:"Student ID label"}),e.jsx(g,{id:"student_id_label",value:r.student_id_label,onChange:s=>v("student_id_label",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"requirement_text",children:"Requirement text"}),e.jsx(g,{id:"requirement_text",value:r.requirement_text,onChange:s=>v("requirement_text",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"additional_rules",children:"Additional Rules"}),e.jsx(V,{id:"additional_rules",value:r.additional_rules,onChange:s=>v("additional_rules",s.target.value),placeholder:"Any additional rules or requirements..."})]}),e.jsx(d,{type:"submit",disabled:M,className:"w-full",children:M?"Saving...":"Save Template"})]})})]}),e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{children:"Template Preview"})}),e.jsx(T,{children:e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:r.title}),e.jsx("p",{className:"text-gray-600",children:r.intro_line}),e.jsx("p",{className:"text-gray-600",children:"[Student Name]"}),e.jsxs("p",{className:"text-gray-600",children:[r.student_id_label," [ID]"]}),e.jsx("p",{className:"text-gray-600",children:r.requirement_text}),r.additional_rules&&e.jsx("p",{className:"text-gray-600 text-sm",children:r.additional_rules}),e.jsx("div",{className:"mt-8",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on: ",new Date().toLocaleDateString()]})})]})})})]})]}),e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{children:"Existing Templates"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[j.map(s=>{var u;return e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Key: ",s.key]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Level: ",(u=m.find(_=>_.id===s.academic_level_id))==null?void 0:u.name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"}),e.jsx(d,{variant:"outline",size:"sm",children:"Edit"}),e.jsx(d,{variant:"outline",size:"sm",children:"Duplicate"})]})]})},s.id)}),j.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No templates created yet."})]})})]})]}),e.jsx(L,{value:"generate",className:"space-y-6",children:e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{children:"Generate Individual Certificate"})}),e.jsx(T,{children:e.jsxs("form",{onSubmit:s=>{s.preventDefault(),ie()},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"gen_template_id",children:"Template"}),e.jsxs(c,{value:f.template_id,onValueChange:s=>b("template_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select template"})}),e.jsx(o,{children:oe.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"gen_academic_level_id",children:"Academic Level"}),e.jsxs(c,{value:f.academic_level_id,onValueChange:s=>b("academic_level_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select level"})}),e.jsx(o,{children:m.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"gen_school_year",children:"School Year"}),e.jsxs(c,{value:f.school_year,onValueChange:s=>b("school_year",s),children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsx(o,{children:n.map(s=>e.jsx(a,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"gen_student_id",children:"Student ID"}),e.jsx(g,{id:"gen_student_id",value:f.student_id,onChange:s=>b("student_id",s.target.value),placeholder:"Enter student ID or search..."})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"gen_notes",children:"Notes"}),e.jsx(V,{id:"gen_notes",value:f.notes,onChange:s=>b("notes",s.target.value),placeholder:"Any additional notes..."})]}),e.jsx(d,{type:"submit",disabled:U,className:"w-full",children:U?"Generating...":"Generate Certificate"})]})})]})}),e.jsx(L,{value:"bulk",className:"space-y-6",children:e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{children:"Bulk Certificate Generation"})}),e.jsx(T,{children:e.jsxs("form",{onSubmit:s=>{s.preventDefault(),re()},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template"}),e.jsxs(c,{value:w.template_id,onValueChange:s=>D("template_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select template"})}),e.jsx(o,{children:me.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(c,{value:w.academic_level_id,onValueChange:s=>D("academic_level_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select level"})}),e.jsx(o,{children:m.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),e.jsxs(c,{value:w.school_year,onValueChange:s=>D("school_year",s),children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsx(o,{children:n.map(s=>e.jsx(a,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student IDs (one per line)"}),e.jsx(V,{value:w.student_ids_text,onChange:s=>D("student_ids_text",s.target.value),placeholder:`Enter student IDs, one per line:
EL-2024-001
EL-2024-002
EL-2024-003`,rows:6}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter one student ID per line. The system will generate certificates for all listed students."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{type:"submit",disabled:J,className:"flex-1",children:J?"Generating...":"Generate Bulk Certificates"}),e.jsx(d,{type:"button",variant:"outline",onClick:()=>D("student_ids_text",""),children:"Clear List"})]})]})})]})}),e.jsx(L,{value:"certificates",className:"space-y-6",children:e.jsxs(S,{children:[e.jsxs(N,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5"}),"Search & Filter Certificates"]}),e.jsx("p",{className:"text-sm text-gray-600",children:'Use the filters below to find specific certificates. Leave filters empty or set to "All" to see broader results.'})]}),e.jsxs(T,{children:[e.jsxs("form",{onSubmit:de,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Serial Number"}),e.jsx(g,{value:p.serial_number,onChange:s=>y("serial_number",s.target.value),placeholder:"e.g., CERT-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by partial serial number"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Name"}),e.jsx(g,{value:p.student_name,onChange:s=>y("student_name",s.target.value),placeholder:"e.g., Maria Santos"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student's full or partial name"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Number"}),e.jsx(g,{value:p.student_number,onChange:s=>y("student_number",s.target.value),placeholder:"e.g., EL-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student number"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template"}),e.jsxs(c,{value:p.template_id,onValueChange:s=>y("template_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"All templates"})}),e.jsxs(o,{children:[e.jsx(a,{value:"all",children:"All templates"}),j&&j.length>0?j.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id)):e.jsx(a,{value:"no-templates",disabled:!0,children:"No templates available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(c,{value:p.academic_level_id,onValueChange:s=>y("academic_level_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"All levels"})}),e.jsxs(o,{children:[e.jsx(a,{value:"all",children:"All levels"}),m&&m.length>0?m.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id)):e.jsx(a,{value:"no-levels",disabled:!0,children:"No levels available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),e.jsxs(c,{value:p.school_year,onValueChange:s=>y("school_year",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"All years"})}),e.jsxs(o,{children:[e.jsx(a,{value:"all",children:"All years"}),n&&n.length>0?n.map(s=>e.jsx(a,{value:s,children:s},s)):e.jsx(a,{value:"no-years",disabled:!0,children:"No years available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Status"}),e.jsxs(c,{value:p.status,onValueChange:s=>y("status",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"All statuses"})}),e.jsxs(o,{children:[e.jsx(a,{value:"all",children:"All statuses"}),e.jsx(a,{value:"generated",children:"Generated"}),e.jsx(a,{value:"downloaded",children:"Downloaded"}),e.jsx(a,{value:"printed",children:"Printed"}),e.jsx(a,{value:"pending",children:"Pending"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{type:"submit",disabled:I,className:"flex-1",children:I?"Searching...":"Search Certificates"}),e.jsx(d,{type:"button",variant:"outline",onClick:ce,children:"Clear Filters"})]})]}),z.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-6",children:e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Serial"}),e.jsx(i,{children:"Student"}),e.jsx(i,{children:"Template"}),e.jsx(i,{children:"Level"}),e.jsx(i,{children:"School Year"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Generated"}),e.jsx(i,{children:"Actions"})]})}),e.jsx(X,{children:z.map(s=>e.jsxs(A,{children:[e.jsx(t,{className:"font-mono text-sm",children:s.serial_number}),e.jsx(t,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.student.name}),s.student.student_number&&e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.student.student_number]})]})}),e.jsx(t,{children:s.template.name}),e.jsx(t,{children:s.academicLevel.name}),e.jsx(t,{children:s.school_year}),e.jsx(t,{children:xe(s.status)}),e.jsx(t,{children:he(s.generated_at)}),e.jsx(t,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",children:e.jsx($,{className:"h-4 w-4"})})]})})]},s.id))})]})})}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:I?"Searching...":"No certificates found. Use the search filters above to find certificates."})]})]})})]}),e.jsxs(S,{children:[e.jsx(N,{children:e.jsx(C,{children:"Recent Certificates"})}),e.jsx(T,{children:e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Serial"}),e.jsx(i,{children:"Student"}),e.jsx(i,{children:"Template"}),e.jsx(i,{children:"Level"}),e.jsx(i,{children:"School Year"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Generated"}),e.jsx(i,{children:"Downloaded"}),e.jsx(i,{children:"Printed"}),e.jsx(i,{children:"Actions"})]})}),e.jsxs(X,{children:[G.map(s=>{var u,_,O;return e.jsxs(A,{children:[e.jsx(t,{children:s.serial_number}),e.jsx(t,{children:(u=s.student)==null?void 0:u.name}),e.jsx(t,{children:(_=s.template)==null?void 0:_.name}),e.jsx(t,{children:(O=s.academicLevel)==null?void 0:O.name}),e.jsx(t,{children:s.school_year}),e.jsx(t,{children:e.jsx(E,{variant:s.status==="generated"?"secondary":s.status==="downloaded"?"default":"outline",children:s.status})}),e.jsx(t,{children:s.generated_at?new Date(s.generated_at).toLocaleString():"-"}),e.jsx(t,{children:s.downloaded_at?new Date(s.downloaded_at).toLocaleString():"-"}),e.jsx(t,{children:s.printed_at?new Date(s.printed_at).toLocaleString():"-"}),e.jsxs(t,{className:"space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",children:e.jsx($,{className:"h-4 w-4"})})]})]},s.id)}),G.length===0&&e.jsx(A,{children:e.jsx(t,{colSpan:10,className:"text-center py-8 text-gray-500",children:"No certificates found."})})]})]})})]})]})})]})]})}export{es as default};
