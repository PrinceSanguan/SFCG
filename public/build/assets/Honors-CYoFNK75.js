import{r as a,R as G,m as P,j as e,C as L,S as B}from"./app-DR6sD-DK.js";import{S as O,H as q}from"./sidebar-BCNRlD0P.js";import{C as j,b as f,c as y,a as _}from"./card-BoVaFnGa.js";import{B as l}from"./button-C_BExgkC.js";import{L as N}from"./label-BFJlIZ2q.js";import{S,a as v,b,c as C,d as k}from"./select-DWTZkah6.js";import{A as w,a as H}from"./alert-aqhR50Ii.js";import{G as V}from"./graduation-cap-B0o3NCaS.js";/* empty css            */import"./dropdown-menu-C0sgcMD1.js";import"./Combination-Dh8HBPKT.js";import"./index--iwrJTQ8.js";import"./separator-M_NtJdk9.js";import"./users-CZBD5C2D.js";import"./chevron-right-ek-HQxIb.js";import"./crown-Dt5PBMzH.js";import"./building-2-CQKbFqfY.js";import"./user-cog-CWk5Gp5U.js";import"./book-open-BkjZQZkJ.js";import"./user-check-CmK-2DgG.js";import"./notebook-T1nQ83-E.js";import"./chart-no-axes-column-increasing-CJD30E7J.js";import"./index-BLLCpcVm.js";import"./index-AoYWojH5.js";import"./check-DdJoQ5Dd.js";function we({user:m,academicLevels:t,honorTypes:$,criteria:T,schoolYears:c,honorResults:D,groupedHonorResults:I}){const[o,g]=a.useState(null),[i,F]=a.useState(()=>"2024-2025"),[x,p]=a.useState(!1),[d,n]=a.useState(null),[J,M]=a.useState(null),[X,Y]=a.useState({min_gpa:"",max_gpa:"",min_grade:"",min_grade_all:"",min_year:"",max_year:"",require_consistent_honor:!1}),[z,K]=a.useState(!1),u=r=>{const s={elementary:"/registrar/academic/honors/elementary",junior_highschool:"/registrar/academic/honors/junior-high-school",senior_highschool:"/registrar/academic/honors/senior-high-school",college:"/registrar/academic/honors/college"};s[r]&&B.visit(s[r])};G.useEffect(()=>{if(t&&t.length>0){const r=t[0].id;g(r)}},[t]);const{data:Q,setData:U,post:W,processing:Z,errors:ee,reset:re}=P({academic_level_id:"",honor_type_id:"",school_year:i,min_gpa:"",max_gpa:"",min_grade:"",min_grade_all:"",min_year:"",max_year:"",require_consistent_honor:!1}),R=()=>{var r;if(!o){n({type:"error",text:"Please select an academic level first."});return}p(!0),fetch("/registrar/academic/honors/generate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({academic_level_id:o,school_year:i})}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.json()}).then(s=>n({type:s.success?"success":"error",text:s.message||(s.success?"Honor roll generated successfully!":"Failed to generate honor roll.")})).catch(()=>n({type:"error",text:"Failed to generate honor roll. Please try again."})).finally(()=>p(!1))},E=()=>{if(!o){n({type:"error",text:"Please select an academic level first."});return}window.open(`/registrar/academic/honors/export?academic_level_id=${o}&school_year=${i}`)},A=r=>{const s=T.filter(h=>h.academic_level_id===r);return console.log("ðŸ” getCriteriaForLevel for level",r,":",s),s.length>0&&(console.log("ðŸ” First filtered criterion:",s[0]),console.log("ðŸ” honorType property:",s[0].honorType),console.log("ðŸ” honor_type_id:",s[0].honor_type_id)),s};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(O,{user:m}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(q,{user:m}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Honor Tracking & Ranking"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Set honor criteria, generate honor rolls, and track student achievements."})]}),e.jsx(l,{variant:"outline",onClick:()=>window.history.back(),children:"Back to Academic"})]}),(!t||t.length===0)&&e.jsx(w,{className:"border-yellow-500",children:e.jsx(H,{children:"Loading academic levels and honor data..."})}),d&&e.jsxs(w,{className:d.type==="success"?"border-green-500":"border-red-500",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(H,{children:d.text})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:t.filter(r=>["elementary","junior_highschool","senior_highschool","college"].includes(r.key)).map(r=>{const s=A(r.id);return e.jsxs(j,{className:"transition-all duration-200 hover:shadow-lg cursor-pointer",onClick:()=>u(r.key),children:[e.jsx(f,{className:"pb-3",children:e.jsx(y,{className:"text-lg font-semibold text-center",children:r.name})}),e.jsx(_,{className:"pt-0",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[s.length," criteria set"]}),e.jsx(l,{variant:"outline",className:"w-full",onClick:h=>{h.stopPropagation(),u(r.key)},children:"Open"})]})})]},r.id)})}),e.jsxs(j,{className:"mt-6",children:[e.jsx(f,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"Honor Roll Generation & Export"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Academic Level"}),t&&t.length>0?e.jsxs(S,{value:o?o.toString():"",onValueChange:r=>g(Number(r)),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select level to generate honor roll"})}),e.jsx(C,{children:t.filter(r=>r.id&&r.name).map(r=>e.jsx(k,{value:r.id.toString(),children:r.name},r.id))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading academic levels..."})]}),e.jsxs("div",{children:[e.jsx(N,{children:"School Year"}),c&&c.length>0?e.jsxs(S,{value:i||"",onValueChange:F,children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select school year"})}),e.jsx(C,{children:c.filter(r=>r&&r.trim()!=="").map(r=>e.jsx(k,{value:r,children:r},r))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading school years..."})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:R,disabled:!o||x,children:x?"Generating...":"Generate Honor Roll"}),e.jsx(l,{variant:"outline",onClick:E,disabled:!o,children:"Export Honor List"})]})]})]})]})})]})]})}export{we as default};
