import{c as xe,r as g,m as N,j as e,S as b}from"./app-4Fw4o22u.js";import{S as he,H as ue}from"./sidebar-fva-NwRE.js";import{C as k,a as S,b as pe,c as ge}from"./card-DJ7fdxSi.js";import{B as r}from"./button-gNCVOgNq.js";import{S as z,a as U,b as O,c as q,d as T}from"./select-6bpZQs5k.js";import{T as je,a as fe,b as J,c as d,d as ve,e as o}from"./table-Bk3AyZKR.js";import{D as ye,a as _e,b as Ne,c as K,d as be}from"./dropdown-menu-D6-_Ft-G.js";import{B as w}from"./badge-SneF3cHW.js";import{A as Q}from"./arrow-left-DBqqZNiq.js";import{S as ke}from"./school-z0QpLW-2.js";import{B as Se}from"./book-open-BXcBMdRc.js";import{G as we}from"./graduation-cap-DQuwBf51.js";import{U as Ce}from"./users-D6C8imcn.js";import{F as G}from"./file-text-CNBdEk4m.js";import{D as B}from"./download-CwWxkbmL.js";import{E as De,P as Te}from"./printer-D8nakDts.js";/* empty css            */import"./separator-CyPAhbL9.js";import"./index-B8WdjkTd.js";import"./chevron-down-hlat33IM.js";import"./chevron-right-CNgOdbOL.js";import"./building-2-DmPfYsr7.js";import"./crown-KeJuHY6x.js";import"./user-cog-CV6l5NFk.js";import"./user-check-BO5Cn4kj.js";import"./notebook-Dr4DqkgJ.js";import"./chart-no-axes-column-increasing-x0klZ01W.js";import"./Combination-QrKwmNkq.js";import"./index-DXxs4UjQ.js";import"./index-C6l-0toZ.js";import"./check-BdzZtWqb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Be=xe("Package",Ge),A=[{key:"elementary",name:"Elementary",icon:ke,color:"bg-blue-500 hover:bg-blue-600",iconColor:"text-blue-600"},{key:"junior_highschool",name:"Junior High School",icon:Se,color:"bg-green-500 hover:bg-green-600",iconColor:"text-green-600"},{key:"senior_highschool",name:"Senior High School",icon:we,color:"bg-orange-500 hover:bg-orange-600",iconColor:"text-orange-600"},{key:"college",name:"College",icon:Ce,color:"bg-purple-500 hover:bg-purple-600",iconColor:"text-purple-600"}];function vs({user:P,academicLevels:v,honorTypes:Ae=[],templates:W,allHonors:C=[],generatedCertificates:l=[],schoolYears:y,currentSchoolYear:X,stats:Pe}){var V,R;const[i,M]=g.useState(null),[n,Z]=g.useState(X||(y==null?void 0:y[0])||"2024-2025"),[u,H]=g.useState(""),[m,_]=g.useState([]),[Me,He]=g.useState([]),[Ee,Fe]=g.useState(!1),{data:Ie,setData:Y,post:ee,processing:se}=N({student_id:"",template_id:"",academic_level_id:"",school_year:n}),{data:Le,setData:ae,post:te,processing:E}=N({student_ids:[],template_id:"",academic_level_id:"",school_year:n}),{data:$e,setData:F,post:I,processing:D}=N({certificate_ids:[]}),{data:Ve,setData:le,post:ie,processing:L}=N({academic_level_id:"",school_year:n,honor_type_id:""}),$=s=>C.length?C.filter(a=>a&&a.academic_level&&a.academic_level.key===s&&a.school_year===n).sort((a,t)=>a.year_level!==t.year_level?(a.year_level||"").localeCompare(t.year_level||""):a.section_id!==t.section_id?(a.section_id||0)-(t.section_id||0):(a.gpa||0)-(t.gpa||0)):[],ne=s=>{const a=v.find(t=>t.key===s);return a?W.filter(t=>t.academic_level_id===a.id&&t.is_active):[]},ce=s=>{Y({student_id:s.student.id.toString(),template_id:u,academic_level_id:s.academic_level.id.toString(),school_year:n}),ee(route("registrar.academic.certificates.generate"),{onSuccess:()=>{b.reload()}})},re=()=>{if(m.length===0||!u)return;const s=v.find(a=>a.key===i);s&&(ae({student_ids:m,template_id:u,academic_level_id:s.id.toString(),school_year:n}),te(route("registrar.academic.certificates.generate-bulk"),{onSuccess:()=>{_([]),b.reload()}}))},de=s=>{_(a=>a.includes(s)?a.filter(t=>t!==s):[...a,s])},oe=()=>{const a=$(i).map(t=>t.student.id);_(m.length===a.length?[]:a)},me=()=>{const s=v.find(a=>a.key===i);s&&(le({academic_level_id:s.id.toString(),school_year:n,honor_type_id:""}),ie(route("registrar.academic.certificates.bulk-generate-by-level"),{onSuccess:()=>{b.reload()}}))},x=i?$(i):[],j=i?ne(i):[];return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(he,{user:P}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(ue,{user:P}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>b.get("/registrar/academic"),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Back to Academic"]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Certificate Management"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Generate and manage honor certificates by academic level."})]}),e.jsx(k,{children:e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"School Year:"}),e.jsxs(z,{value:n,onValueChange:Z,children:[e.jsx(U,{className:"w-40",children:e.jsx(O,{})}),e.jsx(q,{children:y.map(s=>e.jsx(T,{value:s,children:s},s))})]})]})})}),i?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(r,{variant:"outline",onClick:()=>{M(null),_([]),H("")},children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Back to Categories"]}),e.jsxs("h2",{className:"text-2xl font-bold",children:[(V=A.find(s=>s.key===i))==null?void 0:V.name," Honor Students"]}),e.jsxs(w,{variant:"outline",children:[x.length," students"]})]})}),e.jsxs(k,{children:[e.jsx(pe,{children:e.jsx(ge,{children:"Certificate Generation"})}),e.jsx(S,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Select Certificate Template",j.length===0&&e.jsx("span",{className:"ml-2 text-xs text-red-600 font-normal",children:"(No templates - Run: php artisan db:seed --class=CertificateTemplateSeeder)"})]}),e.jsxs(z,{value:u,onValueChange:H,children:[e.jsx(U,{className:j.length===0?"border-red-300":"",children:e.jsx(O,{placeholder:j.length>0?"Choose a template...":"⚠️ No templates available - seed database first"})}),e.jsx(q,{children:j.length>0?j.map(s=>e.jsx(T,{value:s.id.toString(),children:s.name},s.id)):e.jsx(T,{value:"none",disabled:!0,children:"No templates available - run CertificateTemplateSeeder"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[m.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(r,{onClick:re,disabled:!u||E,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),E?"Generating...":`Generate ${m.length} Selected`]}),e.jsxs(r,{onClick:()=>{const s=x.filter(a=>m.includes(a.student.id)).map(a=>{const t=l==null?void 0:l.find(c=>c.student.id===a.student.id&&c.academic_level.id===a.academic_level.id&&c.school_year===a.school_year);return t==null?void 0:t.id}).filter(a=>a!==void 0);s.length>0?(F({certificate_ids:s}),I(route("registrar.academic.certificates.bulk-print-pdf"))):alert("No generated certificates found for selected students. Please generate certificates first.")},disabled:D,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),D?"Preparing...":`Download ${m.length} Selected (PDF)`]})]}):e.jsxs(r,{onClick:me,disabled:x.length===0||L,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),L?"Generating All...":"Generate All Missing Certificates"]}),e.jsxs(ye,{children:[e.jsx(_e,{asChild:!0,children:e.jsxs(r,{variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"More Actions"]})}),e.jsxs(Ne,{align:"end",className:"w-56",children:[e.jsxs(K,{onClick:()=>{var s;return window.open(`/registrar/academic/certificates/honor-roll/pdf?academic_level_id=${(s=v.find(a=>a.key===i))==null?void 0:s.id}&school_year=${n}`,"_blank")},children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Export Honor Roll PDF"]}),e.jsx(be,{}),e.jsxs(K,{onClick:()=>{const s=(l==null?void 0:l.filter(a=>a.academic_level.key===i&&a.school_year===n).map(a=>a.id))||[];s.length>0?(F({certificate_ids:s}),I(route("registrar.academic.certificates.bulk-print-pdf"))):alert("No generated certificates found for this level.")},disabled:D,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Download All Certificates (This Level)"]})]})]})]})]})})]}),e.jsx(k,{children:e.jsx(S,{children:x.length>0?e.jsxs(je,{children:[e.jsx(fe,{children:e.jsxs(J,{children:[e.jsx(d,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:m.length===x.length&&x.length>0,onChange:oe})}),e.jsx(d,{children:"Rank"}),e.jsx(d,{children:"Student Name"}),e.jsx(d,{children:"Student Number"}),e.jsx(d,{children:"Year Level"}),e.jsx(d,{children:"Section"}),e.jsx(d,{children:"Honor Type"}),e.jsx(d,{children:"GPA"}),e.jsx(d,{children:"Certificate"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(ve,{children:x.map((s,a)=>{var t,c,f;return!s||!s.student?null:e.jsxs(J,{children:[e.jsx(o,{children:e.jsx("input",{type:"checkbox",checked:m.includes(s.student.id),onChange:()=>de(s.student.id)})}),e.jsxs(o,{className:"font-medium",children:["#",a+1]}),e.jsx(o,{className:"font-medium",children:s.student.name}),e.jsx(o,{children:s.student.student_number||"N/A"}),e.jsx(o,{children:s.year_level||s.student.year_level||"N/A"}),e.jsx(o,{children:((t=s.section)==null?void 0:t.name)||((c=s.student.section)==null?void 0:c.name)||"N/A"}),e.jsx(o,{children:e.jsx(w,{variant:"secondary",children:((f=s.honor_type)==null?void 0:f.name)||"Unknown Honor"})}),e.jsx(o,{className:"font-mono",children:s.gpa?s.gpa.toFixed(2):"N/A"}),e.jsx(o,{children:(()=>{const p=l==null?void 0:l.find(h=>h.student.id===s.student.id&&h.academic_level.id===s.academic_level.id&&h.school_year===s.school_year);return p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"default",className:"text-xs",children:"Generated"}),e.jsx("span",{className:"text-xs text-gray-500",children:p.serial_number})]}):e.jsx(w,{variant:"outline",className:"text-xs",children:"Pending"})})()}),e.jsx(o,{children:e.jsx("div",{className:"flex gap-1",children:(()=>{const p=l==null?void 0:l.find(h=>h.student.id===s.student.id&&h.academic_level.id===s.academic_level.id&&h.school_year===s.school_year);return p?e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",variant:"outline",onClick:()=>window.open(`/registrar/academic/certificates/${p.id}/download`,"_blank"),className:"h-8 px-2",children:e.jsx(B,{className:"h-3 w-3"})}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>window.open(`/registrar/academic/certificates/${p.id}/print`,"_blank"),className:"h-8 px-2",children:e.jsx(Te,{className:"h-3 w-3"})})]}):e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>ce(s),disabled:!u||se,className:"h-8 px-2",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Generate"]})})()})})]},s.id||a)})})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Honor Students Found"}),e.jsxs("p",{className:"text-sm",children:["No approved honor students for ",(R=A.find(s=>s.key===i))==null?void 0:R.name," in ",n,"."]})]})})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:A.map(s=>{const a=s.icon,t=C.filter(c=>{var f;return((f=c==null?void 0:c.academic_level)==null?void 0:f.key)===s.key&&c.school_year===n}).length;return e.jsx(k,{className:"cursor-pointer transition-all hover:shadow-lg",onClick:()=>M(s.key),children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-gray-100",children:e.jsx(a,{className:`h-8 w-8 ${s.iconColor}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t," honor students"]})]}),e.jsx(r,{className:`w-full ${s.color} text-white`,children:"View Students"})]})})},s.key)})})]})})]})]})}export{vs as default};
