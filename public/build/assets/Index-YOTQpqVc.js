import{r as m,m as X,j as e,$ as ke,R as De}from"./app-CRB7Vkow.js";import{H as Ee}from"./header-B_w37WOv.js";import{S as Ae}from"./sidebar-D4RUaT9f.js";import{C as P,b as B,c as L,a as F}from"./card-B3X3XlfX.js";import{B as g}from"./button-Cg4mH40A.js";import{I as u}from"./input-v05ZLmeZ.js";import{L as a}from"./label-DkvBXY46.js";import{S as v,a as _,b as f,c as b,d as l}from"./select-DDBDqe2r.js";import{T as de,a as ce,b as z,c as d,d as oe,e as c}from"./table-CJf3MZmi.js";import{T as Ie}from"./textarea-BBA0pIY_.js";import{B as he}from"./badge-BUCgrGlw.js";import{T as Pe,a as Be,b as O,c as U}from"./tabs-DwztGZIf.js";import{S as xe}from"./search-DVfTH53x.js";import{F as Le}from"./filter-ByWj7WKJ.js";import{D as Fe}from"./download-DzLg7vx9.js";import{P as Ge}from"./printer-5xFwMCw-.js";/* empty css            */import"./dropdown-menu-C-HXr_Hi.js";import"./Combination-CAawp2Lb.js";import"./index-9EEPBnTe.js";import"./separator-8Uc9AAVt.js";import"./users-ByfpQJpD.js";import"./chevron-right-BM7hkrJx.js";import"./crown-BDavmclC.js";import"./user-check-CQoDSUmN.js";import"./user-cog-LXm_epGx.js";import"./book-open-DnXSirf0.js";import"./graduation-cap-BGaNdPc5.js";import"./chart-no-axes-column-increasing-BhpeRP0R.js";import"./shield-cAeoZOoQ.js";import"./index-SyVjcTXi.js";import"./index-XV-t6QwA.js";class Ve extends De.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,x){console.error("Certificate component error:",s,x)}render(){return this.state.hasError?e.jsx("div",{className:"flex min-h-screen bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error loading the certificates page."}),e.jsx(g,{onClick:()=>window.location.reload(),children:"Reload Page"})]})})}):this.props.children}}function ft({user:D,academicLevels:s,templates:x,recentCertificates:M,schoolYears:r}){var ne;const[o,$e]=m.useState(((ne=s==null?void 0:s[0])==null?void 0:ne.id)??null),[y,He]=m.useState((r==null?void 0:r[0])??"2024-2025"),[V,R]=m.useState("templates"),[h,A]=m.useState({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),[$,Z]=m.useState([]),[K,Y]=m.useState(!1),[I,G]=m.useState(1),[J,ee]=m.useState(1),{data:p,setData:k,post:ue,processing:te}=X({template_id:"",academic_level_id:o?o.toString():"",school_year:y,student_id:""}),[se,me]=m.useState(""),[i,E]=m.useState({title:"Certificate",introText:"This is to certify that",studentIdLabel:"Student ID:",requirementText:"has fulfilled the requirements for",schoolYearLabel:"School Year:",issuedOnLabel:"Issued on",signatoryLabel:"Authorized Signatory"}),{data:Q,setData:H,post:je,processing:ge}=X({academic_level_id:o?o.toString():"",key:"",name:"",content_html:""}),{data:C,setData:S,post:pe,processing:ae,reset:ve}=X({template_id:"",academic_level_id:o?o.toString():"",school_year:y,student_ids_text:"",student_ids:[]});m.useEffect(()=>{o&&S("academic_level_id",o.toString()),S("school_year",y)},[o,y,S]),m.useEffect(()=>{(s==null?void 0:s.length)>0&&h.academic_level_id==="all"&&A(t=>({...t,academic_level_id:s[0].id.toString()})),(r==null?void 0:r.length)>0&&h.school_year==="all"&&A(t=>({...t,school_year:r[0]}))},[s,r]),m.useEffect(()=>{V==="generate"&&o&&y&&k(t=>({...t,academic_level_id:o.toString(),school_year:y})),V==="bulk"&&o&&y&&S(t=>({...t,academic_level_id:o.toString(),school_year:y}))},[V,o,y]);const _e=[{label:"Generate Today's Certificates",action:()=>R("bulk")},{label:"View Recent Downloads",action:()=>{A(t=>({...t,status:"downloaded"})),R("certificates")}},{label:"Pending Certificates",action:()=>{A(t=>({...t,status:"generated"})),R("certificates")}}],q=async(t=1)=>{Y(!0);try{const n={};Object.entries(h).forEach(([Te,W])=>{W&&W!=="all"&&(n[Te]=W)});const j=new URLSearchParams({...n,page:t.toString()}),T=await(await fetch(`/admin/academic/certificates/search?${j}`)).json();Z(T.data||[]),G(T.current_page||1),ee(T.last_page||1)}catch(n){console.error("Search failed:",n),Z([]),G(1),ee(1)}finally{Y(!1)}},w=(t,n)=>{A(j=>({...j,[t]:n}))},fe=t=>{t.preventDefault(),G(1),q(1)},le=t=>{G(t),q(t)},be=()=>{A({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),G(1),q(1)},ye=t=>{t.preventDefault(),ue(route("admin.academic.certificates.generate"))},re=(x==null?void 0:x.filter(t=>!p.academic_level_id||t.academic_level_id.toString()===p.academic_level_id))??[],Se=(x==null?void 0:x.filter(t=>!C.academic_level_id||t.academic_level_id.toString()===C.academic_level_id))??[],ie=()=>`
<div style="text-align:center; padding:24px; border:4px double #333;">
  <h1 style="margin:0; font-size:28px;">${i.title}</h1>
  <p style="margin:8px 0 0 0;">${i.introText}</p>
  <h2 style="margin:8px 0;">{{student_name}}</h2>
  <p style="margin:0;">${i.studentIdLabel} <strong>{{student_number}}</strong></p>
  <p style="margin:8px 0 0 0;">${i.requirementText}</p>
  <h3 style="margin:8px 0;">{{academic_level}}</h3>
  <p style="margin:0;">${i.schoolYearLabel} <strong>{{school_year}}</strong></p>
  <div style="margin-top:24px;">${i.issuedOnLabel} {{date_now}}</div>
  <div style="margin-top:32px;">_________________________<br/>${i.signatoryLabel}</div>
  <div style="margin-top:8px; font-size:10px;">Serial: will appear in PDF filename</div>
</div>`,Ne=m.useMemo(()=>{const t=s.find(N=>N.id.toString()===(p.academic_level_id||(o==null?void 0:o.toString())||"")),n=ie(),j={"{{student_name}}":"Sample Student","{{student_number}}":"EL-2024-001","{{school_year}}":p.school_year||y,"{{academic_level}}":(t==null?void 0:t.name)||"Elementary","{{date_now}}":new Date().toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})};return Object.keys(j).reduce((N,T)=>N.replaceAll(T,j[T]),n)},[i,p.school_year,s,o,y,p.academic_level_id]),Ce=t=>{t.preventDefault(),H("content_html",ie()),je(route("admin.academic.certificates.templates.store"))},we=t=>{t.preventDefault();const n=(C.student_ids_text||"").split(`
`).map(j=>j.trim()).filter(Boolean);n.length!==0&&(S("student_ids",n),pe(route("admin.academic.certificates.generate-bulk"),{preserveScroll:!0,onSuccess:()=>{ve("student_ids_text"),q(I)}}))};return e.jsx(Ve,{children:e.jsxs("div",{className:"flex min-h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(Ae,{user:D}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Ee,{user:D}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 min-h-0",children:e.jsxs("div",{className:"flex flex-col gap-6 pb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Certificates"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Templates, generation (individual/bulk), download and print tracking."})]}),e.jsx(ke,{href:route("admin.academic.index"),children:e.jsx(g,{variant:"outline",children:"Back to Academic"})})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:_e.map((t,n)=>e.jsx(g,{variant:"outline",size:"sm",onClick:t.action,className:"flex items-center gap-2",children:e.jsx("span",{children:t.label})},n))}),e.jsxs(Pe,{value:V,onValueChange:R,className:"w-full",children:[e.jsxs(Be,{className:"grid w-full grid-cols-4",children:[e.jsx(O,{value:"templates",children:"Templates"}),e.jsx(O,{value:"generate",children:"Generate"}),e.jsx(O,{value:"bulk",children:"Bulk Generate"}),e.jsx(O,{value:"certificates",children:"All Certificates"})]}),e.jsx(U,{value:"templates",className:"space-y-6",children:e.jsxs(P,{children:[e.jsx(B,{children:e.jsx(L,{children:"Template Builder & Preview"})}),e.jsx(F,{children:e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Academic Level"}),e.jsxs(v,{value:Q.academic_level_id,onValueChange:t=>{H("academic_level_id",t),k("academic_level_id",t)},children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select level"})}),e.jsx(b,{children:s&&s.length>0?s.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"School Year (Preview)"}),e.jsxs(v,{value:p.school_year,onValueChange:t=>k("school_year",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select year"})}),e.jsx(b,{children:r&&r.length>0?r.map(t=>e.jsx(l,{value:t,children:t},t)):e.jsx(l,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Template Key"}),e.jsx(u,{value:Q.key,onChange:t=>H("key",t.target.value),placeholder:"e.g., elementary_recognition_v2"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Template Name"}),e.jsx(u,{value:Q.name,onChange:t=>H("name",t.target.value),placeholder:"Display name"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Title"}),e.jsx(u,{value:i.title,onChange:t=>E({...i,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Intro line"}),e.jsx(u,{value:i.introText,onChange:t=>E({...i,introText:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Student ID label"}),e.jsx(u,{value:i.studentIdLabel,onChange:t=>E({...i,studentIdLabel:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Requirement text"}),e.jsx(u,{value:i.requirementText,onChange:t=>E({...i,requirementText:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{children:"School year label"}),e.jsx(u,{value:i.schoolYearLabel,onChange:t=>E({...i,schoolYearLabel:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Issued on label"}),e.jsx(u,{value:i.issuedOnLabel,onChange:t=>E({...i,issuedOnLabel:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(a,{children:"Signatory label"}),e.jsx(u,{value:i.signatoryLabel,onChange:t=>E({...i,signatoryLabel:t.target.value})})]})]}),e.jsx("div",{className:"rounded border bg-white p-4 shadow-sm dark:bg-gray-800 overflow-auto max-h-[600px]",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Ne}})}),e.jsx("div",{children:e.jsx(g,{type:"submit",disabled:ge,children:"Save Template"})})]})})]})}),e.jsx(U,{value:"generate",className:"space-y-6",children:e.jsxs(P,{children:[e.jsxs(B,{children:[e.jsx(L,{children:"Generate (Individual)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate a single certificate for one student. Fill in the details below."})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Template"}),e.jsxs(v,{value:p.template_id,onValueChange:t=>k("template_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select template"})}),e.jsx(b,{children:re.length>0?re.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"loading",disabled:!0,children:"No templates for this level"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the certificate template to use"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Academic Level"}),e.jsxs(v,{value:p.academic_level_id,onValueChange:t=>k("academic_level_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select level"})}),e.jsx(b,{children:s&&s.length>0?s.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"School Year"}),e.jsxs(v,{value:p.school_year,onValueChange:t=>k("school_year",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select year"})}),e.jsx(b,{children:r&&r.length>0?r.map(t=>e.jsx(l,{value:t,children:t},t)):e.jsx(l,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Student Identifier"}),e.jsx(u,{value:p.student_id,onChange:t=>k("student_id",t.target.value),placeholder:"Enter numeric user ID or student_number (e.g., EL-2024-001)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the student's User ID or Student Number"}),p.student_id&&e.jsx(Re,{identifier:p.student_id,onResolved:t=>me(t)}),se&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800",children:["✓ Student Found: ",se]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{type:"submit",disabled:te,className:"flex items-center gap-2",children:te?"Generating...":"Generate Certificate"}),e.jsx(g,{type:"button",variant:"outline",onClick:()=>k("student_id",""),children:"Clear Form"})]})]})})]})}),e.jsx(U,{value:"bulk",className:"space-y-6",children:e.jsxs(P,{children:[e.jsxs(B,{children:[e.jsx(L,{children:"Generate (Bulk)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate multiple certificates at once. Enter student identifiers (one per line) in the text area below."})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:we,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Template"}),e.jsxs(v,{value:C.template_id,onValueChange:t=>S("template_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select template"})}),e.jsx(b,{children:Se.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id))})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the certificate template to use for all students"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Academic Level"}),e.jsxs(v,{value:C.academic_level_id,onValueChange:t=>S("academic_level_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select level"})}),e.jsx(b,{children:s&&s.length>0?s.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"School Year"}),e.jsxs(v,{value:C.school_year,onValueChange:t=>S("school_year",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"Select year"})}),e.jsx(b,{children:r&&r.length>0?r.map(t=>e.jsx(l,{value:t,children:t},t)):e.jsx(l,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Student Identifiers (one per line)"}),e.jsx(Ie,{value:C.student_ids_text,onChange:t=>S("student_ids_text",t.target.value),placeholder:`Enter user IDs or student numbers, one per line
Example:
EL-2024-001
EL-2024-002
12345`,rows:8}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:C.student_ids_text?`${C.student_ids_text.split(`
`).filter(t=>t.trim()).length} student(s) detected`:"Enter student identifiers above"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: User ID, Student Number"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{type:"submit",disabled:ae,className:"flex items-center gap-2",children:ae?"Generating...":"Generate Bulk Certificates"}),e.jsx(g,{type:"button",variant:"outline",onClick:()=>S("student_ids_text",""),children:"Clear List"})]})]})})]})}),e.jsxs(U,{value:"certificates",className:"space-y-6",children:[e.jsxs(P,{children:[e.jsxs(B,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"Search & Filter Certificates"]}),e.jsx("p",{className:"text-sm text-gray-600",children:'Use the filters below to find specific certificates. Leave filters empty or set to "All" to see broader results.'})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Serial Number"}),e.jsx(u,{value:h.serial_number,onChange:t=>w("serial_number",t.target.value),placeholder:"e.g., CERT-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by partial serial number"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Student Name"}),e.jsx(u,{value:h.student_name,onChange:t=>w("student_name",t.target.value),placeholder:"e.g., Maria Santos"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student's full or partial name"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Student Number"}),e.jsx(u,{value:h.student_number,onChange:t=>w("student_number",t.target.value),placeholder:"e.g., EL-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student number"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Template"}),e.jsxs(v,{value:h.template_id,onValueChange:t=>w("template_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"All templates"})}),e.jsxs(b,{children:[e.jsx(l,{value:"all",children:"All templates"}),x&&x.length>0?x.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"no-templates",disabled:!0,children:"No templates available"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Academic Level"}),e.jsxs(v,{value:h.academic_level_id,onValueChange:t=>w("academic_level_id",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"All levels"})}),e.jsxs(b,{children:[e.jsx(l,{value:"all",children:"All levels"}),s&&s.length>0?s.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id)):e.jsx(l,{value:"no-levels",disabled:!0,children:"No levels available"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"School Year"}),e.jsxs(v,{value:h.school_year,onValueChange:t=>w("school_year",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"All years"})}),e.jsxs(b,{children:[e.jsx(l,{value:"all",children:"All years"}),r&&r.length>0?r.map(t=>e.jsx(l,{value:t,children:t},t)):e.jsx(l,{value:"no-years",disabled:!0,children:"No years available"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Status"}),e.jsxs(v,{value:h.status,onValueChange:t=>w("status",t),children:[e.jsx(_,{children:e.jsx(f,{placeholder:"All statuses"})}),e.jsxs(b,{children:[e.jsx(l,{value:"all",children:"All statuses"}),e.jsx(l,{value:"generated",children:"Generated"}),e.jsx(l,{value:"downloaded",children:"Downloaded"}),e.jsx(l,{value:"printed",children:"Printed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Date From"}),e.jsx(u,{type:"date",value:h.date_from,onChange:t=>w("date_from",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Date To"}),e.jsx(u,{type:"date",value:h.date_to,onChange:t=>w("date_to",t.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{type:"submit",disabled:K,className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),K?"Searching...":"Search"]}),e.jsxs(g,{type:"button",variant:"outline",onClick:be,className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"Clear Filters"]})]})]})})]}),e.jsxs(P,{children:[e.jsxs(B,{children:[e.jsx(L,{children:"Search Results"}),$.length>0&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Found ",$.length," certificate(s)"]}),h.serial_number&&e.jsxs("span",{children:["• Serial: ",h.serial_number]}),h.student_name&&e.jsxs("span",{children:["• Student: ",h.student_name]}),h.status!=="all"&&e.jsxs("span",{children:["• Status: ",h.status]})]})]}),e.jsx(F,{children:$.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(de,{children:[e.jsx(ce,{children:e.jsxs(z,{children:[e.jsx(d,{children:"Serial"}),e.jsx(d,{children:"Student"}),e.jsx(d,{children:"Student Number"}),e.jsx(d,{children:"Template"}),e.jsx(d,{children:"Level"}),e.jsx(d,{children:"School Year"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Generated"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(oe,{children:$.map(t=>{var n,j,N,T;return e.jsxs(z,{className:"hover:bg-gray-50",children:[e.jsx(c,{className:"font-mono text-sm",children:t.serial_number}),e.jsx(c,{className:"font-medium",children:(n=t.student)==null?void 0:n.name}),e.jsx(c,{children:((j=t.student)==null?void 0:j.student_number)||"-"}),e.jsx(c,{children:(N=t.template)==null?void 0:N.name}),e.jsx(c,{children:(T=t.academicLevel)==null?void 0:T.name}),e.jsx(c,{children:t.school_year}),e.jsx(c,{children:e.jsx(he,{variant:t.status==="generated"?"secondary":t.status==="downloaded"?"default":"outline",children:t.status})}),e.jsx(c,{children:t.generated_at?new Date(t.generated_at).toLocaleDateString():"-"}),e.jsxs(c,{className:"space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",asChild:!0,children:e.jsx("a",{href:route("admin.academic.certificates.download",{certificate:t.id}),children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsx(g,{size:"sm",variant:"outline",asChild:!0,children:e.jsx("a",{href:route("admin.academic.certificates.print",{certificate:t.id}),target:"_blank",children:e.jsx(Ge,{className:"h-4 w-4"})})})]})]},t.id)})})]}),J>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",I," of ",J]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>le(I-1),disabled:I<=1,children:"Previous"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>le(I+1),disabled:I>=J,children:"Next"})]})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:K?"Searching...":"No certificates found. Use the search filters above to find certificates."})})]})]})]}),e.jsxs(P,{children:[e.jsx(B,{children:e.jsx(L,{children:"Recent Certificates"})}),e.jsx(F,{children:e.jsxs(de,{children:[e.jsx(ce,{children:e.jsxs(z,{children:[e.jsx(d,{children:"Serial"}),e.jsx(d,{children:"Student"}),e.jsx(d,{children:"Template"}),e.jsx(d,{children:"Level"}),e.jsx(d,{children:"School Year"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Generated"}),e.jsx(d,{children:"Downloaded"}),e.jsx(d,{children:"Printed"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(oe,{children:M.map(t=>{var n,j,N;return e.jsxs(z,{children:[e.jsx(c,{children:t.serial_number}),e.jsx(c,{children:(n=t.student)==null?void 0:n.name}),e.jsx(c,{children:(j=t.template)==null?void 0:j.name}),e.jsx(c,{children:(N=t.academicLevel)==null?void 0:N.name}),e.jsx(c,{children:t.school_year}),e.jsx(c,{children:e.jsx(he,{variant:t.status==="generated"?"secondary":t.status==="downloaded"?"default":"outline",children:t.status})}),e.jsx(c,{children:t.generated_at?new Date(t.generated_at).toLocaleString():"-"}),e.jsx(c,{children:t.downloaded_at?new Date(t.downloaded_at).toLocaleString():"-"}),e.jsx(c,{children:t.printed_at?new Date(t.printed_at).toLocaleString():"-"}),e.jsxs(c,{className:"space-x-2",children:[e.jsx("a",{className:"text-blue-600",href:route("admin.academic.certificates.download",{certificate:t.id}),children:"Download"}),e.jsx("a",{className:"text-blue-600",href:route("admin.academic.certificates.print",{certificate:t.id}),target:"_blank",children:"Print"})]})]},t.id)})})]})})]})]})})]})]})})}function Re({identifier:D,onResolved:s}){return m.useEffect(()=>{let x=!0;if(!D)return;const M=route("admin.academic.certificates.resolve-student",{q:D});return fetch(M).then(r=>r.json()).then(r=>{x&&(r.found?s(r.name+(r.student_number?` (${r.student_number})`:"")):s(""))}).catch(()=>{x&&s("")}),()=>{x=!1}},[D]),null}export{ft as default};
