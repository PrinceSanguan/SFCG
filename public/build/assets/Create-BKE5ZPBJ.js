import{m as D,r as T,j as e,$ as C}from"./app-igJwWJE0.js";import{S as z,H as M}from"./sidebar-Oq4zOojR.js";import{C as P,b as A,c as V,a as Y}from"./card-Bxy2jX5X.js";import{B as _}from"./button-DIVvTSkr.js";import{I as S}from"./input-CeOKivYb.js";import{L as h}from"./label-DHLCrGXh.js";import{S as p,a as f,b as v,c as y,d as o,e as H,f as R}from"./select-BDlRYqsS.js";import{A as J}from"./arrow-left-2z-KkLTU.js";import{P as O}from"./plus-BTNaxkHJ.js";import{S as U}from"./save-nQvrAcpe.js";/* empty css            */import"./dropdown-menu-CwRgJ0aO.js";import"./Combination-D4ESjq4r.js";import"./index-D-blu8Ci.js";import"./user-sDvBPFvJ.js";import"./log-out-CJ8shhNn.js";import"./book-open-d3lkUKpF.js";import"./graduation-cap-Bf5uEjfG.js";import"./upload-BnLAjRfT.js";import"./crown-DxXpH-M9.js";import"./index-tkIhRwir.js";import"./index-C0Z3W7pA.js";import"./check-BQMSuGOa.js";function ve({user:I,academicLevels:w,gradingPeriods:x,assignedSubjects:u,selectedStudent:g}){var k,G,F,E;const{data:i,setData:a,post:q,processing:b,errors:t}=D({student_id:"",subject_id:"",academic_level_id:"",grading_period_id:"0",school_year:"2024-2025",year_of_study:"",grade:""});T.useEffect(()=>{var l;const s=new URLSearchParams(window.location.search),d=s.get("student_id"),m=s.get("subject_id"),c=s.get("academic_level_id"),j=s.get("academic_level_key"),r=s.get("school_year");if(d&&m&&c){a("student_id",d),a("subject_id",m),a("academic_level_id",c),a("school_year",r||"2024-2025"),a("year_of_study",""),a("grade",""),j&&w.find($=>$.id.toString()===c)&&a("academic_level_id",c);const n=window.location.pathname;window.history.replaceState({},"",n)}else g&&(a("student_id",g.id.toString()),a("subject_id",((l=g.subjectId)==null?void 0:l.toString())||""),a("academic_level_id",g.academicLevelKey||""),a("school_year","2024-2025"),a("year_of_study",""),a("grade",""))},[g,a]);const B=s=>{if(!s)return null;for(const d of u)if(d.enrolled_students.find(c=>c.student.id.toString()===s))return{subjectId:d.subject.id,academicLevelId:d.academicLevel.id,academicLevelKey:d.academicLevel.key,schoolYear:d.school_year};return null},K=s=>{if(a("student_id",s),s){const d=B(s);d&&(a("subject_id",d.subjectId.toString()),a("academic_level_id",d.academicLevelId.toString()),a("school_year",d.schoolYear))}else a("subject_id",""),a("academic_level_id",""),a("grade","")},L=s=>{s.preventDefault(),q(route("teacher.grades.store"),{onSuccess:()=>{},onError:d=>{}})},N=i.student_id&&i.subject_id&&i.academic_level_id;return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(z,{user:I}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(M,{user:I}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{href:route("teacher.grades.index"),children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:N?"Input Grade":"Input New Grade"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:N?"Enter a grade for the selected student.":"Enter a new grade for a student in your assigned course."})]})]})}),e.jsxs(P,{className:"max-w-2xl",children:[e.jsx(A,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Grade Information"]})}),e.jsx(Y,{children:N?e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Student:"}),e.jsx("p",{className:"font-medium",children:((G=(k=u.find(s=>s.enrolled_students.some(d=>d.student.id.toString()===i.student_id)))==null?void 0:k.enrolled_students.find(s=>s.student.id.toString()===i.student_id))==null?void 0:G.student.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Subject:"}),e.jsx("p",{className:"font-medium",children:((F=u.find(s=>s.subject.id.toString()===i.subject_id))==null?void 0:F.subject.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Academic Level:"}),e.jsx("p",{className:"font-medium",children:((E=w.find(s=>s.id.toString()===i.academic_level_id))==null?void 0:E.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"School Year:"}),e.jsx("p",{className:"font-medium",children:i.school_year})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grade",children:"Grade"}),e.jsx(S,{id:"grade",type:"number",step:"0.1",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:i.grade,onChange:s=>a("grade",s.target.value),className:t.grade?"border-red-500":"",autoFocus:!0}),t.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Senior High School: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(p,{value:i.grading_period_id,onValueChange:s=>a("grading_period_id",s),children:[e.jsx(f,{className:t.grading_period_id?"border-red-500":"",children:e.jsx(v,{placeholder:"Select grading period"})}),e.jsxs(y,{children:[e.jsx(o,{value:"0",children:"No Period"}),x&&x.length>0?e.jsx(e.Fragment,{children:(()=>{const s=parseInt(i.academic_level_id),d=x.filter(r=>r.academic_level_id===s),m=d.filter(r=>r.parent_id===null&&r.type==="semester"),c=d.filter(r=>r.parent_id!==null&&r.period_type!=="final");if(m.length===0&&c.length===0)return e.jsx(o,{value:"none",disabled:!0,children:"No grading periods available for this academic level"});const j=m.sort((r,l)=>r.sort_order-l.sort_order).map(r=>({parent:r,children:c.filter(l=>l.parent_id===r.id).sort((l,n)=>l.sort_order-n.sort_order)}));return e.jsx(e.Fragment,{children:j.map(({parent:r,children:l})=>l.length>0&&e.jsxs(H,{children:[e.jsx(R,{children:r.name}),l.map(n=>e.jsx(o,{value:n.id.toString(),children:n.name},n.id))]},r.id))})})()}):e.jsx(o,{value:"none",disabled:!0,children:"No grading periods available"})]})]}),t.grading_period_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.grading_period_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select which grading period this grade belongs to"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(_,{type:"submit",disabled:b,className:"flex-1",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),b?"Saving...":"Save Grade"]}),e.jsx(C,{href:route("teacher.grades.index"),className:"flex-1",children:e.jsx(_,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]}):e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"student_id",children:"Student"}),e.jsxs(p,{value:i.student_id,onValueChange:K,children:[e.jsx(f,{className:t.student_id?"border-red-500":"",children:e.jsx(v,{placeholder:"Select a student"})}),e.jsx(y,{children:u.flatMap(s=>s.enrolled_students.map(d=>e.jsxs(o,{value:d.student.id.toString(),children:[d.student.name," - ",s.subject.name]},d.student.id)))})]}),t.student_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.student_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select a student from your assigned subjects"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(p,{value:i.subject_id,onValueChange:s=>a("subject_id",s),children:[e.jsx(f,{className:t.subject_id?"border-red-500":"",children:e.jsx(v,{placeholder:"Select a subject"})}),e.jsx(y,{children:u.map(s=>e.jsxs(o,{value:s.subject.id.toString(),children:[s.subject.name," (",s.subject.code,")",s.subject.course&&` - ${s.subject.course.name}`]},s.subject.id))})]}),t.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(p,{value:i.academic_level_id,onValueChange:s=>a("academic_level_id",s),children:[e.jsx(f,{className:t.academic_level_id?"border-red-500":"",children:e.jsx(v,{placeholder:"Select academic level"})}),e.jsx(y,{children:w.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))})]}),t.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(p,{value:i.grading_period_id,onValueChange:s=>a("grading_period_id",s),children:[e.jsx(f,{children:e.jsx(v,{placeholder:"Select grading period (optional)"})}),e.jsxs(y,{children:[e.jsx(o,{value:"0",children:"No Period"}),x&&x.length>0?e.jsx(e.Fragment,{children:(()=>{const s=parseInt(i.academic_level_id);if(!s)return null;const d=x.filter(r=>r.academic_level_id===s),m=d.filter(r=>r.parent_id===null&&r.type==="semester"),c=d.filter(r=>r.parent_id!==null&&r.period_type!=="final");if(m.length===0&&c.length===0)return e.jsx(o,{value:"none",disabled:!0,children:"No grading periods available for this academic level"});const j=m.sort((r,l)=>r.sort_order-l.sort_order).map(r=>({parent:r,children:c.filter(l=>l.parent_id===r.id).sort((l,n)=>l.sort_order-n.sort_order)}));return e.jsx(e.Fragment,{children:j.map(({parent:r,children:l})=>l.length>0&&e.jsxs(H,{children:[e.jsx(R,{children:r.name}),l.map(n=>e.jsx(o,{value:n.id.toString(),children:n.name},n.id))]},r.id))})})()}):null]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"school_year",children:"School Year"}),e.jsx(S,{id:"school_year",type:"text",placeholder:"e.g., 2024-2025",value:i.school_year,onChange:s=>a("school_year",s.target.value),className:t.school_year?"border-red-500":""}),t.school_year&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.school_year})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"year_of_study",children:"Year of Study"}),e.jsx(S,{id:"year_of_study",type:"number",min:"1",max:"10",placeholder:"e.g., 1, 2, 3, 4",value:i.year_of_study,onChange:s=>a("year_of_study",s.target.value),className:t.year_of_study?"border-red-500":""}),t.year_of_study&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.year_of_study}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required for college level"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grade",children:"Grade"}),e.jsx(S,{id:"grade",type:"number",step:"0.01",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:i.grade,onChange:s=>a("grade",s.target.value),className:t.grade?"border-red-500":""}),t.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(_,{type:"submit",disabled:b,className:"flex-1",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),b?"Saving...":"Save Grade"]}),e.jsx(C,{href:route("teacher.grades.index"),className:"flex-1",children:e.jsx(_,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]})})]}),e.jsxs(P,{children:[e.jsx(A,{children:e.jsx(V,{children:"Help & Guidelines"})}),e.jsx(Y,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Student:"})," Select a student from your assigned subjects"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Subject:"})," Automatically populated when student is selected"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Grade Scale:"})," College uses 1.0-5.0 scale (1.0 highest, 3.0 passing), Elementary/Senior High uses 75-100 scale (75 passing)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Validation:"})," Grades are automatically submitted for validation after saving"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Editing:"})," You can edit grades before they are validated by the registrar"]})]})})]})]})})]})]})}export{ve as default};
