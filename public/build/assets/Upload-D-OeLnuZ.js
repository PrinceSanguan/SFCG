import{c as S,K as w,m as C,j as e}from"./app-Cp9NjWYG.js";import{S as D,H as V}from"./sidebar-B4X-xFWC.js";import{C as U,b as P,c as G,a as T}from"./card-BQSU5Dlj.js";import{B as h}from"./button-DZaBrzx3.js";import{I as p}from"./input-1wGXUeNP.js";import{L as c}from"./label-Cy8O6Ds9.js";import{S as j,a as u,b as _,c as b,d as f}from"./select-DzRaXHEp.js";import{C as F}from"./checkbox-Czp1Nm-w.js";import{T as A}from"./triangle-alert-HZrrM4IG.js";import{C as H}from"./circle-x-QI7b_OlE.js";import{U as I}from"./upload-DZfwFCbu.js";import{D as O}from"./download-CwVxIylM.js";/* empty css            */import"./dropdown-menu-atARtuT6.js";import"./Combination-CFAD2So3.js";import"./index-6PVpn6-Y.js";import"./user-DFEvrC81.js";import"./log-out-maoecu2N.js";import"./book-open-tyrdWMvg.js";import"./graduation-cap-DClvfwMN.js";import"./crown-CJ6-i-19.js";import"./index-DmRWeeiQ.js";import"./index-CXvyxhQA.js";import"./check-sTGVbyFp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],E=S("CircleCheck",B);function me({user:m,assignedSubjects:v,academicLevels:o,gradingPeriods:x,schoolYear:y}){const{flash:i}=w().props,{data:s,setData:t,post:N,processing:g,errors:a}=C({csv_file:null,subject_id:"",academic_level_id:"",grading_period_ids:[],school_year:y||"2024-2025",year_of_study:""}),k=r=>{r.preventDefault();const l=new FormData;Object.entries(s).forEach(([d,n])=>l.append(d,n)),N(route("adviser.grades.upload.process"),{forceFormData:!0})};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(D,{user:m}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(V,{user:m}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-4",children:[(i==null?void 0:i.success)&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(E,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:i.success})})]}),(i==null?void 0:i.warning)&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 whitespace-pre-line",children:i.warning})})]}),Object.keys(a).length>0&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:Object.values(a).map((r,l)=>e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:r},l))})]}),e.jsxs(U,{children:[e.jsxs(P,{children:[e.jsx(G,{children:"Upload Grades CSV"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Upload multiple student grades at once using a CSV file. Select the subject and academic level, then download the template pre-filled with your students."})]}),e.jsx(T,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsxs(c,{children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(j,{value:s.subject_id,onValueChange:r=>t("subject_id",r),children:[e.jsx(u,{children:e.jsx(_,{placeholder:"Select subject"})}),e.jsx(b,{children:v.map(r=>e.jsx(f,{value:r.subject.id.toString(),children:r.subject.name},r.subject.id))})]}),a.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs(c,{children:["Academic Level ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(j,{value:s.academic_level_id,onValueChange:r=>t({...s,academic_level_id:r,grading_period_ids:[]}),children:[e.jsx(u,{children:e.jsx(_,{placeholder:"Select academic level"})}),e.jsx(b,{children:o.map(r=>e.jsx(f,{value:r.id.toString(),children:r.name},r.id))})]}),a.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.academic_level_id})]}),e.jsxs("div",{children:[e.jsxs(c,{children:["Grading Periods ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Select one or more grading periods to apply these grades to."}),!s.academic_level_id&&e.jsx("p",{className:"text-sm text-gray-500 italic py-3 px-4 border rounded-lg",children:"Please select an academic level first"}),s.academic_level_id&&e.jsxs("div",{className:"space-y-2 border rounded-lg p-3 max-h-48 overflow-y-auto bg-white dark:bg-gray-800",children:[x.filter(r=>{var d;if(((d=r.academic_level_id)==null?void 0:d.toString())!==s.academic_level_id)return!1;const l=o.find(n=>n.id.toString()===s.academic_level_id);return(l==null?void 0:l.key)==="senior_highschool"||(l==null?void 0:l.key)==="college"?!r.parent_id:!0}).map(r=>e.jsxs("div",{className:"flex items-center space-x-2 hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded",children:[e.jsx(F,{id:`period-${r.id}`,checked:s.grading_period_ids.includes(r.id.toString()),onCheckedChange:l=>{l?t("grading_period_ids",[...s.grading_period_ids,r.id.toString()]):t("grading_period_ids",s.grading_period_ids.filter(d=>d!==r.id.toString()))}}),e.jsx(c,{htmlFor:`period-${r.id}`,className:"cursor-pointer font-normal flex-1",children:r.name})]},r.id)),x.filter(r=>{var d;if(((d=r.academic_level_id)==null?void 0:d.toString())!==s.academic_level_id)return!1;const l=o.find(n=>n.id.toString()===s.academic_level_id);return(l==null?void 0:l.key)==="senior_highschool"||(l==null?void 0:l.key)==="college"?!r.parent_id:!0}).length===0&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No grading periods available for this academic level"})]}),s.grading_period_ids.length>0&&e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-2",children:["‚úì ",s.grading_period_ids.length," grading period",s.grading_period_ids.length>1?"s":""," selected"]}),s.grading_period_ids.length===0&&s.academic_level_id&&e.jsx("p",{className:"text-sm text-amber-600 dark:text-amber-400 mt-2",children:"‚ö†Ô∏è Please select at least one grading period"}),a.grading_period_ids&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.grading_period_ids})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(c,{children:"School Year"}),e.jsx(p,{value:s.school_year,onChange:r=>t("school_year",r.target.value)})]}),e.jsxs("div",{children:[e.jsxs(c,{children:["CSV File ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{type:"file",accept:".csv,text/csv",onChange:r=>t("csv_file",r.target.files?r.target.files[0]:null)}),a.csv_file&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.csv_file}),s.csv_file&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["‚úì File selected: ",s.csv_file.name]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:"üìã How to Upload Grades"}),e.jsxs("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Select the ",e.jsx("strong",{children:"Subject"})," and ",e.jsx("strong",{children:"Academic Level"})]}),e.jsxs("li",{children:["Select ",e.jsx("strong",{children:"one or more Grading Periods"})," to apply grades to"]}),e.jsxs("li",{children:["Click ",e.jsx("strong",{children:'"Download Template"'})," to get a CSV with enrolled students"]}),e.jsxs("li",{children:["Fill in the ",e.jsx("strong",{children:"Grade"})," column (values: 75-100)"]}),e.jsx("li",{children:"Save the file and upload it using the form above"}),e.jsxs("li",{children:["Grades will be created/updated for ",e.jsx("strong",{children:"ALL selected periods"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h,{type:"submit",disabled:g||!s.subject_id||!s.academic_level_id||!s.csv_file||s.grading_period_ids.length===0,className:"flex items-center gap-2",title:s.subject_id?s.academic_level_id?s.grading_period_ids.length===0?"Please select at least one grading period":s.csv_file?"Upload grades from CSV":"Please select a CSV file":"Please select an academic level":"Please select a subject",children:[e.jsx(I,{className:"h-4 w-4"}),g?"Uploading...":"Upload CSV"]}),e.jsx("a",{href:route("adviser.grades.template",{subject_id:s.subject_id||void 0,school_year:s.school_year}),download:!0,children:e.jsxs(h,{type:"button",variant:"outline",className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),s.subject_id?"Download Template (with students)":"Download Template"]})})]}),(!s.subject_id||!s.academic_level_id||!s.csv_file)&&e.jsx("p",{className:"text-sm text-amber-600 dark:text-amber-400",children:"‚ö†Ô∏è Please fill in all required fields (*) to enable upload"})]})]})})]})]})})]})]})}export{me as default};
