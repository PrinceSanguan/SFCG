import{m as M,r as P,j as e,$ as S}from"./app-D4d_CnOG.js";import{S as V,H as Y}from"./sidebar-CWNe4Gzs.js";import{C as A,b as H,c as U,a as q}from"./card-Ddd1PbJm.js";import{B as m}from"./button-BNY9pfxV.js";import{I as b}from"./input-8udAFdwg.js";import{L as i}from"./label-DUZH2A38.js";import{S as x,a as h,b as u,c as g,d as l}from"./select-BXdu2run.js";import{A as J}from"./arrow-left-D7rCR_6w.js";import{P as O}from"./plus-BMDvNPjd.js";import{S as z}from"./save-muPh7Asa.js";/* empty css            */import"./dropdown-menu-C8j3iGLG.js";import"./Combination-DV3hOdVE.js";import"./index--LpZLMxA.js";import"./user-9Qs8i3Y1.js";import"./log-out-B1DUJlT7.js";import"./book-open-BuG7Pj3m.js";import"./graduation-cap-639r0NlY.js";import"./upload-oPN4Z0XZ.js";import"./crown-CpcUdmWy.js";import"./index-0i3Iw_XU.js";import"./index-BWE3IbqW.js";import"./check-DiMX6rTc.js";function _e({user:j,academicLevels:N,gradingPeriods:w,assignedSubjects:n,selectedStudent:c}){var k,G,L,F;const p=new URLSearchParams(window.location.search),f=p.get("student_id")||"",_=p.get("subject_id")||"",v=p.get("academic_level_id")||"",C=p.get("school_year")||"2024-2025",{data:t,setData:d,post:R,processing:y,errors:a}=M({student_id:f,subject_id:_,academic_level_id:v,grading_period_id:"0",school_year:C,year_of_study:"",grade:""}),[B,$]=P.useState(!1);P.useEffect(()=>{var s;if(f||_||v){console.log("Form initialized with URL params:",{initialStudentId:f,initialSubjectId:_,initialAcademicLevelId:v,initialSchoolYear:C});const r=window.location.pathname;window.history.replaceState({},"",r)}else c&&(d("student_id",c.id.toString()),d("subject_id",((s=c.subjectId)==null?void 0:s.toString())||""),d("academic_level_id",c.academicLevelKey||""),d("school_year","2024-2025"),d("year_of_study",""),d("grade",""),console.log("Form data set from selectedStudent prop"));$(!0)},[c,d,f,_,v]);const D=s=>{if(!s)return null;for(const r of n)if(r.enrolled_students.find(T=>T.student.id.toString()===s))return{subjectId:r.subject.id,academicLevelId:r.academicLevel.id,academicLevelKey:r.academicLevel.key,schoolYear:r.school_year};return null},K=s=>{if(d("student_id",s),s){const r=D(s);r&&(d("subject_id",r.subjectId.toString()),d("academic_level_id",r.academicLevelId.toString()),d("school_year",r.schoolYear))}else d("subject_id",""),d("academic_level_id",""),d("grade","")},I=s=>{s.preventDefault(),console.log("Form submitted with data:",t),console.log("Has pre-selected student:",o),R(route("instructor.grades.store"),{onSuccess:()=>{console.log("Grade created successfully")},onError:r=>{console.log("Grade creation failed:",r)}})},o=t.student_id&&t.subject_id&&t.academic_level_id;return B?e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(V,{user:j}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Y,{user:j}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{href:route("instructor.grades.index"),children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:o?"Input Grade":"Input New Grade"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:o?"Enter a grade for the selected student.":"Enter a new grade for a student in your assigned course."})]})]})}),e.jsxs(A,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Grade Information"]})}),e.jsx(q,{children:o?e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Student:"}),e.jsx("p",{className:"font-medium",children:((G=(k=n.find(s=>s.enrolled_students.some(r=>r.student.id.toString()===t.student_id)))==null?void 0:k.enrolled_students.find(s=>s.student.id.toString()===t.student_id))==null?void 0:G.student.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Subject:"}),e.jsx("p",{className:"font-medium",children:((L=n.find(s=>s.subject.id.toString()===t.subject_id))==null?void 0:L.subject.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Academic Level:"}),e.jsx("p",{className:"font-medium",children:((F=N.find(s=>s.id.toString()===t.academic_level_id))==null?void 0:F.name)||"College"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"School Year:"}),e.jsx("p",{className:"font-medium",children:t.school_year})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(b,{id:"grade",type:"number",step:"0.1",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:t.grade,onChange:s=>d("grade",s.target.value),className:a.grade?"border-red-500":"",autoFocus:!0}),a.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(x,{value:t.grading_period_id,onValueChange:s=>d("grading_period_id",s),children:[e.jsx(h,{className:a.grading_period_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Select grading period"})}),e.jsx(g,{children:w.filter(s=>{const r=N.find(E=>E.id.toString()===t.academic_level_id);return r?s.academic_level_id===r.id:!0}).map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]}),a.grading_period_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.grading_period_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select which grading period this grade belongs to"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(m,{type:"submit",disabled:y,className:"flex-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Save Grade"]}),e.jsx(S,{href:route("instructor.grades.index"),className:"flex-1",children:e.jsx(m,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]}):e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"student_id",children:"Student"}),e.jsxs(x,{value:t.student_id,onValueChange:K,children:[e.jsx(h,{className:a.student_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Select a student"})}),e.jsx(g,{children:n.flatMap(s=>s.enrolled_students.map(r=>e.jsxs(l,{value:r.student.id.toString(),children:[r.student.name," - ",s.subject.name]},r.student.id)))})]}),a.student_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.student_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select a student from your assigned subjects"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(x,{value:t.subject_id,onValueChange:s=>d("subject_id",s),children:[e.jsx(h,{className:a.subject_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Select a subject"})}),e.jsx(g,{children:n.map(s=>e.jsxs(l,{value:s.subject.id.toString(),children:[s.subject.name," (",s.subject.code,")",s.subject.course&&` - ${s.subject.course.name}`]},s.subject.id))})]}),a.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(x,{value:t.academic_level_id,onValueChange:s=>d("academic_level_id",s),children:[e.jsx(h,{className:a.academic_level_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Select academic level"})}),e.jsx(g,{children:N.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]}),a.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(x,{value:t.grading_period_id,onValueChange:s=>d("grading_period_id",s),children:[e.jsx(h,{children:e.jsx(u,{placeholder:"Select grading period (optional)"})}),e.jsxs(g,{children:[e.jsx(l,{value:"0",children:"No Period"}),w.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"school_year",children:"School Year"}),e.jsx(b,{id:"school_year",type:"text",placeholder:"e.g., 2024-2025",value:t.school_year,onChange:s=>d("school_year",s.target.value),className:a.school_year?"border-red-500":""}),a.school_year&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.school_year})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"year_of_study",children:"Year of Study"}),e.jsx(b,{id:"year_of_study",type:"number",min:"1",max:"10",placeholder:"e.g., 1, 2, 3, 4",value:t.year_of_study,onChange:s=>d("year_of_study",s.target.value),className:a.year_of_study?"border-red-500":""}),a.year_of_study&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.year_of_study}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required for college level"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(b,{id:"grade",type:"number",step:"0.1",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:t.grade,onChange:s=>d("grade",s.target.value),className:a.grade?"border-red-500":""}),a.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(m,{type:"submit",disabled:y,className:"flex-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Save Grade"]}),e.jsx(S,{href:route("instructor.grades.index"),className:"flex-1",children:e.jsx(m,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]})})]}),e.jsxs(A,{children:[e.jsx(H,{children:e.jsx(U,{children:"Help & Guidelines"})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Student:"})," Select a student from your assigned subjects"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Subject:"})," Automatically populated when student is selected"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Grade Scale:"})," College uses 1.0-5.0 scale (1.0 highest, 5.0 lowest, 3.0 passing equivalent to 75%)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Validation:"})," Grades are automatically submitted for validation after saving"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Editing:"})," You can edit grades before they are validated by the registrar"]})]})})]})]})})]})]}):e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(V,{user:j}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Y,{user:j}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading form..."})]})})})]})]})}export{_e as default};
