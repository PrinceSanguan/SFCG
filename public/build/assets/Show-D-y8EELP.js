import{j as e,$ as G}from"./app-amIQygQf.js";import{S as D,H as T}from"./sidebar-C9gcBeBO.js";import{C as w,b as k,c as _,a as S}from"./card-BZz6pFlG.js";import{B as F}from"./button-D-ThuB9i.js";import{B as C}from"./badge-JzcZ6yjG.js";import{A as V}from"./arrow-left-C7srEuqF.js";import{U as b}from"./user-Cre4oXRT.js";import{M as H}from"./mail-BhYS3NCU.js";import{B as P}from"./book-open-5YNx6lOt.js";import{G as B}from"./graduation-cap-D3PXwbfu.js";import{C as I}from"./calendar-D7rN4Ynz.js";import{P as R}from"./plus-CrZafDrF.js";import{S as O}from"./square-pen-Dc0zc-Qf.js";/* empty css            */import"./dropdown-menu-DX9DNke_.js";import"./Combination-B9WtIDLh.js";import"./index-DnDAp_6W.js";import"./log-out-Dccl86o2.js";import"./upload-DmKIdr9q.js";import"./crown-AjgVpnV1.js";function ge({user:A,student:m,subject:f,academicLevel:N,grades:p,gradingPeriods:y}){const x=p.length>0?p[0]:null,j=N.key,$=(s,d)=>d==="college"||d==="senior_highschool"?s<=1.5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s<=2.5?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s<=3?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":s>=90?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s>=80?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s>=75?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",E=(s,d)=>d==="college"||d==="senior_highschool"?s<=1.5?"Superior":s<=2?"Very Good":s<=2.5?"Good":s<=3?"Satisfactory":"Failing":s>=95?"Outstanding":s>=90?"Very Good":s>=85?"Good":s>=80?"Satisfactory":s>=75?"Fair":"Failing",h=(()=>{console.log("🔍 DEBUG - getSemesterStructure called with:",{academicLevelKey:j,allGradingPeriods:y.map(t=>({id:t.id,name:t.name,code:t.code}))});let s=y.filter(t=>{const a=j,r=t.name.toLowerCase(),l=t.code.toLowerCase(),n=[a.toLowerCase(),a.toLowerCase().replace("_",""),a.toLowerCase().replace("_"," ")];a==="college"&&n.push("tertiary","university","higher"),a==="senior_highschool"&&n.push("senior high","shs","senior_high","seniorhigh");const u=n.some(c=>l.includes(c)||r.includes(c));return console.log(`🔍 Period "${t.name}" (${t.code}) relevant for ${a}:`,u),u});if(s.length===0&&(console.log("🔍 No level-specific periods found, using all active periods as fallback"),s=y.filter(t=>t.is_active)),console.log("🔍 DEBUG - Relevant periods after filtering:",s.map(t=>({id:t.id,name:t.name,code:t.code}))),["senior_highschool","college"].includes(j)){const t={};s.forEach(r=>{let l=1;const n=r.name.toLowerCase(),u=r.code.toLowerCase();["s2","2nd","second","_s2","semester_2","sem_2","sem2","2nd semester","second semester","semester 2","sem 2","2nd sem","second sem","ii"," 2 ","_2_","-2-","spring","winter"].some(i=>u.includes(i)||n.includes(i))&&(l=2),console.log(`🔍 Period "${r.name}" (${r.code}) assigned to Semester ${l}`),t[l]||(t[l]={name:`${l===1?"First":"Second"} Semester`,periods:[]}),!r.name.toLowerCase().includes("final average")&&!r.code.includes("FA")&&!r.name.toLowerCase().includes("final")&&!r.code.toLowerCase().includes("final")&&t[l].periods.push({id:r.id,name:r.name,code:r.code,gradingPeriodId:r.id})});let a=Object.keys(t).map(r=>({semesterNumber:parseInt(r),...t[r]}));if(a.length===0||a.every(r=>r.periods.length===0)){console.log("🔍 No periods grouped by semester, creating fallback structure");const r=s.filter(l=>!l.name.toLowerCase().includes("final average")&&!l.code.includes("FA")&&!l.name.toLowerCase().includes("final")&&!l.code.toLowerCase().includes("final"));if(console.log("🔍 All input periods for fallback:",r.map(l=>({id:l.id,name:l.name,code:l.code}))),r.length>0)if(r.length>=2){const l=Math.ceil(r.length/2);a=[{semesterNumber:1,name:"First Semester",periods:r.slice(0,l).map(n=>({id:n.id,name:n.name,code:n.code,gradingPeriodId:n.id}))},{semesterNumber:2,name:"Second Semester",periods:r.slice(l).map(n=>({id:n.id,name:n.name,code:n.code,gradingPeriodId:n.id}))}].filter(n=>n.periods.length>0)}else a=[{semesterNumber:1,name:"Semester",periods:r.map(l=>({id:l.id,name:l.name,code:l.code,gradingPeriodId:l.id}))}]}return console.log("🔍 Final semester structure (semester-based):",a),a}else{const t=[{semesterNumber:1,name:"Academic Year",periods:s.filter(a=>!a.name.toLowerCase().includes("final average")&&!a.code.includes("FA")).sort((a,r)=>a.id-r.id).map(a=>({id:a.id,name:a.name,code:a.code,gradingPeriodId:a.id}))}];return console.log("🔍 Final quarter structure:",t),t}})();console.log("🔍 DEBUG - Show component data:",{academicLevelKey:j,academicLevel:N,gradingPeriods:y.map(s=>({id:s.id,name:s.name,code:s.code})),semesterStructure:h,totalGradingPeriods:y.length,semesterStructureLength:h.length,totalPeriodsInStructure:h.reduce((s,d)=>s+d.periods.length,0)});const L=()=>{if(!["college","senior_highschool"].includes(j)){const c=p.filter(i=>i.grade!==null&&i.grade!==void 0).map(i=>i.grade);return c.length>0?{semester1Average:null,semester2Average:null,overallAverage:c.reduce((i,o)=>i+o,0)/c.length}:{semester1Average:null,semester2Average:null,overallAverage:null}}const d=p.find(c=>{var o,g;const i=((g=(o=c.gradingPeriod)==null?void 0:o.code)==null?void 0:g.toUpperCase())||"";return i.includes("S1_MT")||i.includes("_S1_MT")}),t=p.find(c=>{var o,g;const i=((g=(o=c.gradingPeriod)==null?void 0:o.code)==null?void 0:g.toUpperCase())||"";return i.includes("S1_PF")||i.includes("_S1_PF")});let a=null;(d==null?void 0:d.grade)!==null&&(d==null?void 0:d.grade)!==void 0&&(t==null?void 0:t.grade)!==null&&(t==null?void 0:t.grade)!==void 0&&(a=(parseFloat(d.grade)+parseFloat(t.grade))/2);const r=p.find(c=>{var o,g;const i=((g=(o=c.gradingPeriod)==null?void 0:o.code)==null?void 0:g.toUpperCase())||"";return i.includes("S2_MT")||i.includes("_S2_MT")}),l=p.find(c=>{var o,g;const i=((g=(o=c.gradingPeriod)==null?void 0:o.code)==null?void 0:g.toUpperCase())||"";return i.includes("S2_PF")||i.includes("_S2_PF")});let n=null;(r==null?void 0:r.grade)!==null&&(r==null?void 0:r.grade)!==void 0&&(l==null?void 0:l.grade)!==null&&(l==null?void 0:l.grade)!==void 0&&(n=(parseFloat(r.grade)+parseFloat(l.grade))/2);let u=null;return a!==null&&n!==null?u=(a+n)/2:a!==null?u=a:n!==null&&(u=n),console.log("🔍 Semester averages:",{semester1:{midterm:d==null?void 0:d.grade,preFinal:t==null?void 0:t.grade,average:a},semester2:{midterm:r==null?void 0:r.grade,preFinal:l==null?void 0:l.grade,average:n},overall:u}),{semester1Average:a,semester2Average:n,overallAverage:u}},{semester1Average:Y,semester2Average:z,overallAverage:U}=L(),v=U;return h.reduce((s,d)=>s+d.periods.length,0),e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(D,{user:A}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(T,{user:A}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(G,{href:route("instructor.grades.index"),children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Student Details"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["View and manage grades for ",m.name]})]})]})}),e.jsxs(w,{children:[e.jsx(k,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Personal Information"]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx("p",{className:"font-medium",children:m.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Student ID"}),e.jsx("p",{className:"font-medium",children:m.student_number||m.id})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:e.jsx(H,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"font-medium",children:m.email})]})]})]})})]}),m.parents&&m.parents.length>0&&e.jsxs(w,{children:[e.jsx(k,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Linked Parents"]})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-3",children:m.parents.map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]}),e.jsx(C,{variant:"outline",children:s.pivot.relationship_type.charAt(0).toUpperCase()+s.pivot.relationship_type.slice(1)})]}),s.pivot.emergency_contact&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Emergency Contact: ",s.pivot.emergency_contact]}),s.pivot.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Notes: ",s.pivot.notes]})]})},s.id))})})]}),e.jsxs(w,{children:[e.jsx(k,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),"Subject & Course Information"]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Subject"}),e.jsxs("p",{className:"font-medium",children:[f.name," (",f.code,")"]})]})]}),f.course&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:e.jsx(B,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Course"}),e.jsxs("p",{className:"font-medium",children:[f.course.name," (",f.course.code,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center",children:e.jsx(B,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Academic Level"}),e.jsx("p",{className:"font-medium",children:N.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center",children:e.jsx(I,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"School Year"}),e.jsx("p",{className:"font-medium",children:(x==null?void 0:x.school_year)||"N/A"})]})]})]})})]}),e.jsxs(w,{className:"bg-white shadow-sm",children:[e.jsx(k,{children:e.jsxs(_,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(I,{className:"h-5 w-5 text-gray-600"}),"Detailed Grades"]})}),e.jsx(S,{children:p.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:(()=>{const s=["senior_highschool","college"].includes(j),d=h.reduce((a,r)=>a+r.periods.length,0);if(s&&d>0&&h.length>1)return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-900 text-white",children:[e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Student ID"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Subject"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Faculty"}),h.map(a=>e.jsx("th",{className:"text-center p-2 border-r border-gray-600",colSpan:a.periods.length,children:a.name},a.semesterNumber)),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"AVERAGE"}),e.jsx("th",{className:"p-2",rowSpan:2,children:"Grade Status"})]}),e.jsx("tr",{className:"bg-gray-800 text-white",children:h.flatMap(a=>a.periods.map(r=>e.jsx("th",{className:"text-center p-2 border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)))})]});{const a=h.flatMap(r=>r.periods);return e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Student ID"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Subject"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Faculty"}),a.map(r=>e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)),e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:"AVERAGE"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Grade Status"})]})}})()}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b bg-white hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-r border-gray-200 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-400"}),m.student_number||m.id]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:f.name}),e.jsx("div",{className:"text-sm text-gray-500",children:f.code})]})]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("div",{className:"text-sm text-gray-600",children:A.name})]})}),h.flatMap(d=>d.periods).map(d=>{const t=p.find(a=>a.grading_period_id===d.gradingPeriodId);return e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:t?e.jsx(C,{className:$(t.grade,j),children:t.grade}):e.jsx("span",{className:"text-gray-400",children:"-"})},d.id)}),e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:v?e.jsx(C,{className:`text-lg px-3 py-1 ${$(v,j)}`,children:v.toFixed(2)}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-3 text-center",children:v?(()=>{const s=E(v,j);return e.jsx(C,{className:`${["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(s)?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:s})})():e.jsx("span",{className:"text-gray-400",children:"No Grade"})})]})})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"📊"}),e.jsx("p",{className:"text-gray-500",children:"No grade history available"})]})})]}),e.jsx(w,{children:e.jsx(S,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(G,{href:route("instructor.grades.create")+`?student_id=${m.id}&subject_id=${f.id}&academic_level_id=${N.id}&academic_level_key=${N.key}&school_year=${(x==null?void 0:x.school_year)||"2024-2025"}`,className:"flex-1",onClick:()=>{console.log("Navigating to grade creation with params:",{student_id:m.id,subject_id:f.id,academic_level_id:N.id,academic_level_key:N.key,school_year:(x==null?void 0:x.school_year)||"2024-2025"})},children:e.jsxs(F,{className:"w-full",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Input New Grade"]})}),x&&e.jsx(G,{href:route("instructor.grades.edit",x.id),className:"flex-1",children:e.jsxs(F,{variant:"outline",className:"w-full",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Edit Current Grade"]})})]})})})]})})]})]})}export{ge as default};
