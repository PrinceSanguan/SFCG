import{K as De,m as Ge,R as r,j as e}from"./app-IzT8XqcP.js";import{S as Ee,H as we}from"./sidebar-dpapp8iI.js";import{C as xe,b as he,c as _e,a as ue}from"./card-B_KpF9rd.js";import{B as P}from"./button-BolBt3NW.js";import{I as $}from"./input-DNDW_zg7.js";import{L as c}from"./label-BGWxRD4u.js";import{S as b,a as F,b as L,c as k,d as S}from"./select-C7bJ-y5g.js";import{A as n,a as d}from"./alert-C4XRYy4K.js";import{P as Me}from"./plus-CsoyMDbH.js";import{S as Te}from"./save-DHeK5NZ8.js";import{T as Ve}from"./trash-2-Cv9eQEjY.js";/* empty css            */import"./dropdown-menu-B96B4plC.js";import"./Combination-hrqfovut.js";import"./index-B-Hsb1dd.js";import"./separator-CYJ8aj9L.js";import"./users-WyBGWrtb.js";import"./chevron-right-DjGd-y92.js";import"./crown-I6PAat6t.js";import"./building-2-DAYVO4Ag.js";import"./user-cog-Bcx5YXJl.js";import"./book-open-D7V2EXy7.js";import"./user-check-CimPLCRR.js";import"./graduation-cap-CBtcGgWF.js";import"./notebook-CXmb_V5o.js";import"./chart-no-axes-column-increasing-raHvIaib.js";import"./index-DD66Uow-.js";import"./index-hv8ZXqYs.js";import"./check-C6Fz9ArY.js";function xi(){var X,Z,ee,ie,se,ae,te,le,re,ce,ne,de;const{props:ve}=De(),{user:z,sections:N,academicLevels:M,tracks:je,strands:B,departments:pe,courses:H,specificYearLevels:l,errors:s,activeLevelKey:ge}=ve,{data:m,setData:t,post:fe,processing:ye,reset:J,put:Se,delete:Ne}=Ge({id:void 0,name:"",academic_level_id:"",specific_year_level:"",track_id:"",strand_id:"",department_id:"",course_id:"",max_students:"",is_active:!0}),[T,I]=r.useState(null),[D]=r.useState(()=>{var i;return ge||((i=M[0])==null?void 0:i.key)||""}),[o,V]=r.useState(""),[v,q]=r.useState(""),[j,G]=r.useState(""),[y,A]=r.useState(""),[C,E]=r.useState(""),[U,p]=r.useState([]),x=r.useMemo(()=>{const i=M.find(a=>a.key===D);return i==null?void 0:i.id},[M,D]),w=D==="elementary",Q=D==="junior_highschool",Ce=D==="senior_highschool",be=D==="college",g=w||Q,h=Ce,_=be;r.useEffect(()=>{x&&(t("academic_level_id",x.toString()),t("specific_year_level",""),t("track_id",""),t("strand_id",""),t("department_id",""),t("course_id",""),V(""),q(""),G(""),A(""),E(""),p([]))},[x,t]),r.useEffect(()=>{if(g&&o&&x){const i=N.filter(a=>a.academic_level_id===x&&a.specific_year_level===o);p(i)}else p([])},[o,N,x,g]),r.useEffect(()=>{if(h&&v&&j&&x){const i=N.filter(a=>{var u,f;return a.academic_level_id===x&&((u=a.track_id)==null?void 0:u.toString())===v&&((f=a.strand_id)==null?void 0:f.toString())===j});p(i)}else h&&p([])},[v,j,N,x,h]),r.useEffect(()=>{if(_&&y&&C&&x){const i=N.filter(a=>{var u,f;return a.academic_level_id===x&&((u=a.department_id)==null?void 0:u.toString())===y&&((f=a.course_id)==null?void 0:f.toString())===C});p(i)}else _&&p([])},[y,C,N,x,_]);const Fe=i=>{var a,u,f,Y;I(i),t({id:i.id,name:i.name,academic_level_id:i.academic_level_id,specific_year_level:i.specific_year_level||"",track_id:((a=i.track_id)==null?void 0:a.toString())||"",strand_id:((u=i.strand_id)==null?void 0:u.toString())||"",department_id:((f=i.department_id)==null?void 0:f.toString())||"",course_id:((Y=i.course_id)==null?void 0:Y.toString())||"",max_students:i.max_students??"",is_active:!0}),g&&i.specific_year_level&&V(i.specific_year_level),h&&(i.track_id&&q(i.track_id.toString()),i.strand_id&&G(i.strand_id.toString())),_&&(i.department_id&&A(i.department_id.toString()),i.course_id&&E(i.course_id.toString()))},Le=()=>{I(null),J(),V(""),q(""),G(""),A(""),E(""),p([])},ke=i=>{i.preventDefault(),T?Se(route("registrar.academic.sections.update",T.id)):fe(route("registrar.academic.sections.store"))},$e=i=>{confirm(`Delete section "${i.name}"?`)&&Ne(route("registrar.academic.sections.destroy",i.id))},O=r.useMemo(()=>h&&v?B.filter(i=>{var a;return((a=i.track_id)==null?void 0:a.toString())===v}):B,[B,v,h]),K=r.useMemo(()=>_&&y?H.filter(i=>{var a;return((a=i.department_id)==null?void 0:a.toString())===y}):H,[H,y,_]),W=r.useMemo(()=>x?N.filter(i=>i.academic_level_id===x):N,[N,x]);return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(Ee,{user:z}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(we,{user:z}),e.jsxs("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Sections"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage sections across academic levels and programs"})]}),e.jsxs(P,{onClick:()=>{I(null),J(),g&&(V(""),p([])),h&&(q(""),G(""),p([])),_&&(A(""),E(""),p([]))},className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"})," New Section"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs(xe,{className:"lg:col-span-1",children:[e.jsx(he,{children:e.jsx(_e,{children:T?"Edit Section":"Create Section"})}),e.jsx(ue,{children:e.jsxs("form",{onSubmit:ke,className:"space-y-4",children:[g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"specific_year_level",children:"Grade Level *"}),e.jsxs(b,{value:o,onValueChange:i=>{V(i),t("specific_year_level",i)},children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Grade Level"})}),e.jsxs(k,{children:[w&&l.elementary&&Object.entries(l.elementary).map(([i,a])=>e.jsx(S,{value:i,children:a},i)),Q&&l.junior_highschool&&Object.entries(l.junior_highschool).map(([i,a])=>e.jsx(S,{value:i,children:a},i))]})]}),(s==null?void 0:s.specific_year_level)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.specific_year_level})})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Section Name *"}),e.jsx($,{id:"name",value:m.name,onChange:i=>t("name",i.target.value),placeholder:`e.g., ${w?(X=l.elementary)==null?void 0:X[o]:(Z=l.junior_highschool)==null?void 0:Z[o]} - Section A`,required:!0}),(s==null?void 0:s.name)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"max_students",children:"Maximum Students *"}),e.jsx($,{id:"max_students",type:"number",min:1,max:50,value:String(m.max_students),onChange:i=>t("max_students",i.target.value),placeholder:"e.g., 30",required:!0}),(s==null?void 0:s.max_students)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.max_students})})]})]})]}):h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"track_id",children:"Track *"}),e.jsxs(b,{value:v,onValueChange:i=>{q(i),t("track_id",i),G(""),t("strand_id","")},children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Track"})}),e.jsx(k,{children:je.map(i=>e.jsx(S,{value:i.id.toString(),children:i.name},i.id))})]}),(s==null?void 0:s.track_id)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.track_id})})]}),v&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"strand_id",children:"Strand *"}),e.jsxs(b,{value:j,onValueChange:i=>{G(i),t("strand_id",i)},children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Strand"})}),e.jsx(k,{children:O.map(i=>e.jsx(S,{value:i.id.toString(),children:i.name},i.id))})]}),(s==null?void 0:s.strand_id)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.strand_id})})]}),v&&j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"specific_year_level",children:"Grade Level *"}),e.jsxs(b,{value:m.specific_year_level,onValueChange:i=>t("specific_year_level",i),children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Grade Level"})}),e.jsx(k,{children:l.senior_highschool&&Object.entries(l.senior_highschool).map(([i,a])=>e.jsx(S,{value:i,children:a},i))})]}),(s==null?void 0:s.specific_year_level)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.specific_year_level})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Section Name *"}),e.jsx($,{id:"name",value:m.name,onChange:i=>t("name",i.target.value),placeholder:`e.g., ${((ee=l.senior_highschool)==null?void 0:ee[m.specific_year_level])||"Grade"} - Section A`,required:!0}),(s==null?void 0:s.name)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"max_students",children:"Maximum Students *"}),e.jsx($,{id:"max_students",type:"number",min:1,max:50,value:String(m.max_students),onChange:i=>t("max_students",i.target.value),placeholder:"e.g., 30",required:!0}),(s==null?void 0:s.max_students)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.max_students})})]})]})]}):_?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Name *"}),e.jsx($,{id:"name",value:m.name,onChange:i=>t("name",i.target.value),required:!0}),(s==null?void 0:s.name)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"academic_level_id",children:"Academic Level *"}),e.jsxs(b,{value:String(m.academic_level_id),onValueChange:i=>t("academic_level_id",i),children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select level"})}),e.jsx(k,{children:M.map(i=>e.jsx(S,{value:i.id.toString(),children:i.name},i.id))})]}),(s==null?void 0:s.academic_level_id)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.academic_level_id})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"specific_year_level",children:"Year/Grade"}),e.jsxs(b,{value:m.specific_year_level,onValueChange:i=>t("specific_year_level",i),children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select year/grade (if applicable)"})}),e.jsx(k,{children:M.map(i=>e.jsx(r.Fragment,{children:l[i.key]&&Object.entries(l[i.key]).map(([a,u])=>e.jsx(S,{value:a,children:u},`${i.id}-${a}`))},i.id))})]}),(s==null?void 0:s.specific_year_level)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.specific_year_level})})]})]}),_?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"department_id",children:"Department *"}),e.jsxs(b,{value:y,onValueChange:i=>{A(i),t("department_id",i),E(""),t("course_id","")},children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Department"})}),e.jsx(k,{children:pe.map(i=>e.jsx(S,{value:i.id.toString(),children:i.name},i.id))})]}),(s==null?void 0:s.department_id)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.department_id})})]}),y&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"course_id",children:"Course *"}),e.jsxs(b,{value:C,onValueChange:i=>{E(i),t("course_id",i)},children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Course"})}),e.jsx(k,{children:K.map(i=>e.jsx(S,{value:i.id.toString(),children:i.name},i.id))})]}),(s==null?void 0:s.course_id)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.course_id})})]}),y&&C&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"specific_year_level",children:"Year Level *"}),e.jsxs(b,{value:m.specific_year_level,onValueChange:i=>t("specific_year_level",i),children:[e.jsx(F,{children:e.jsx(L,{placeholder:"Select Year Level"})}),e.jsx(k,{children:l.college&&Object.entries(l.college).map(([i,a])=>e.jsx(S,{value:i,children:a},i))})]}),(s==null?void 0:s.specific_year_level)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.specific_year_level})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Section *"}),e.jsx($,{id:"name",value:m.name,onChange:i=>t("name",i.target.value),placeholder:`e.g., ${m.specific_year_level?((ie=l.college)==null?void 0:ie[m.specific_year_level])||m.specific_year_level:"Year"} - ${((se=K.find(i=>i.id.toString()===C))==null?void 0:se.name)||"Course"} - Section A`,required:!0}),(s==null?void 0:s.name)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"max_students",children:"Number of Students *"}),e.jsx($,{id:"max_students",type:"number",min:1,max:50,value:String(m.max_students),onChange:i=>t("max_students",i.target.value),placeholder:"e.g., 30",required:!0}),(s==null?void 0:s.max_students)&&e.jsx(n,{variant:"destructive",children:e.jsx(d,{children:s.max_students})})]})]})]}):null,e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs(P,{type:"submit",disabled:ye,className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4"})," ",T?"Update":"Create"]}),T&&e.jsx(P,{type:"button",variant:"outline",onClick:Le,children:"Cancel"})]})]})})]}),e.jsxs(xe,{className:"lg:col-span-2",children:[e.jsx(he,{children:e.jsx(_e,{children:g&&o?`Sections for ${w?(ae=l.elementary)==null?void 0:ae[o]:((te=l.junior_highschool)==null?void 0:te[o])||o}`:h&&v&&j?`Sections for ${((le=O.find(i=>i.id.toString()===j))==null?void 0:le.name)||j}`:"Existing Sections"})}),e.jsx(ue,{children:g&&!o?e.jsx("div",{className:"text-sm text-gray-500 py-6",children:"Please select a Grade Level to view and manage sections."}):h&&(!v||!j)?e.jsx("div",{className:"text-sm text-gray-500 py-6",children:"Please select a Track and Strand to view and manage sections."}):_&&(!y||!C)?e.jsx("div",{className:"text-sm text-gray-500 py-6",children:"Please select a Department and Course to view and manage sections."}):e.jsxs("div",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:[(g||h||_?U:W).length===0&&e.jsx("div",{className:"text-sm text-gray-500 py-6",children:g?`No sections yet for ${w?(re=l.elementary)==null?void 0:re[o]:((ce=l.junior_highschool)==null?void 0:ce[o])||o}. Create your first section.`:h?`No sections yet for ${((ne=O.find(i=>i.id.toString()===j))==null?void 0:ne.name)||j}. Create your first section.`:_?`No sections yet for ${((de=K.find(i=>i.id.toString()===C))==null?void 0:de.name)||C}. Create your first section.`:"No sections yet. Create your first section."}),(g||h||_?U:W).map(i=>{var a,u,f,Y,me,oe;return e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:i.name}),e.jsx("div",{className:"text-xs text-gray-500",children:g?e.jsxs(e.Fragment,{children:["Grade: ",w?(a=l.elementary)==null?void 0:a[i.specific_year_level||""]:((u=l.junior_highschool)==null?void 0:u[i.specific_year_level||""])||i.specific_year_level,typeof i.max_students=="number"?` • Max: ${i.max_students}`:""]}):h?e.jsxs(e.Fragment,{children:["Strand: ",((f=B.find(R=>R.id===i.strand_id))==null?void 0:f.name)||i.strand_id,i.specific_year_level?` • Grade: ${((Y=l.senior_highschool)==null?void 0:Y[i.specific_year_level])||i.specific_year_level}`:"",typeof i.max_students=="number"?` • Max: ${i.max_students}`:""]}):_?e.jsxs(e.Fragment,{children:["Course: ",((me=H.find(R=>R.id===i.course_id))==null?void 0:me.name)||i.course_id,i.specific_year_level?` • Year: ${((oe=l.college)==null?void 0:oe[i.specific_year_level])||i.specific_year_level}`:"",typeof i.max_students=="number"?` • Max: ${i.max_students}`:""]}):e.jsxs(e.Fragment,{children:["Level ID: ",i.academic_level_id,i.specific_year_level?` • Year: ${i.specific_year_level}`:"",typeof i.max_students=="number"?` • Max: ${i.max_students}`:""]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{size:"sm",variant:"outline",onClick:()=>Fe(i),children:"Edit"}),e.jsxs(P,{size:"sm",variant:"destructive",onClick:()=>$e(i),className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"})," Delete"]})]})]},i.id)})]})})]})]})]})]})]})}export{xi as default};
