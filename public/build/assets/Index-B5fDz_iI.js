import{c as U,r as x,j as e,C as G,d as D,S as w}from"./app-CqO9IoZC.js";import{H as ne}from"./header-C_cTmUS9.js";import{S as te,B as f}from"./sidebar-cpEMcJBe.js";import{C as l,b as c,c as o,a as d}from"./card-BU9MFb8M.js";import{B as j}from"./button-BY2kDOsa.js";import{I as S}from"./input-qwzKFTpQ.js";import{L as h}from"./label-lfemGogy.js";import{S as H,a as M,b as I,c as O,d as _}from"./select-CV8nS7Av.js";import{T as ie,a as re,b as C,c as A}from"./tabs-CHMK3ndi.js";import{B as z}from"./badge-CYKzTeeK.js";import{A as B,a as q}from"./alert-CTDF-njS.js";import{M as le}from"./mail-yWPzJOLo.js";import{E as V}from"./eye-DcdkFNNG.js";import{U as ce}from"./users-BsmoIXZZ.js";import{C as oe}from"./chart-no-axes-column-increasing-DoihZmMX.js";/* empty css            */import"./dropdown-menu-BnJzYsy6.js";import"./Combination-SE7o47nM.js";import"./index-BGxOuu2L.js";import"./separator-CPL_G9Zc.js";import"./chevron-right-B94EmAJZ.js";import"./crown-DckLxQDy.js";import"./user-check-BF-gyK0y.js";import"./user-cog-gcV8rbLC.js";import"./book-open-CV6bAvlA.js";import"./graduation-cap-O0lrJ9c3.js";import"./shield-ekeqj9BQ.js";import"./index-CliGvH_u.js";import"./index-BmoMXrNZ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],u=U("RefreshCw",de);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],F=U("Send",me);function Oe({user:P,notifications:E,stats:v,academicLevels:R}){const[J,K]=x.useState("overview"),[p,t]=x.useState(!1),[N,y]=x.useState(!1),[a,g]=x.useState(null),[n,b]=x.useState({title:"",message:"",recipients:[],email_subject:"",email_body:""}),[i,T]=x.useState({school_year:"2024-2025",academic_level_id:"all"}),[r,k]=x.useState({school_year:"2024-2025",academic_level_id:"all"}),Q=s=>{switch(s){case"sent":return e.jsx(z,{variant:"default",className:"bg-green-100 text-green-800",children:"Sent"});case"pending":return e.jsx(z,{variant:"secondary",children:"Pending"});case"failed":return e.jsx(z,{variant:"destructive",children:"Failed"});default:return e.jsx(z,{variant:"outline",children:s})}},X=s=>{switch(s){case"grade_update":return e.jsx(oe,{size:16});case"honor_qualification":return e.jsx(ce,{size:16});case"general_announcement":return e.jsx(f,{size:16});default:return e.jsx(f,{size:16})}},Y=s=>{switch(s){case"grade_update":return"Grade Update";case"honor_qualification":return"Honor Qualification";case"general_announcement":return"General Announcement";default:return s}},$=async()=>{var s;if(i.school_year){y(!0);try{const L=await(await fetch(route("admin.notifications.preview-grade"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify(i)})).json();g(L)}catch(m){console.error("Error previewing grade notifications:",m),g({success:!1,message:"Failed to preview notifications",students:[],count:0})}finally{y(!1)}}},W=async()=>{var s;if(r.school_year){y(!0);try{const L=await(await fetch(route("admin.notifications.preview-honor"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify(r)})).json();g(L)}catch(m){console.error("Error previewing honor notifications:",m),g({success:!1,message:"Failed to preview notifications",students:[],count:0})}finally{y(!1)}}},Z=()=>{!a||!a.success||a.count===0||(t(!0),w.post(route("admin.notifications.send-grade"),i,{onSuccess:()=>{T({school_year:"2024-2025",academic_level_id:"all"}),g(null),t(!1)},onError:()=>{t(!1)}}))},ee=()=>{!a||!a.success||a.count===0||(t(!0),w.post(route("admin.notifications.send-honor"),r,{onSuccess:()=>{k({school_year:"2024-2025",academic_level_id:"all"}),g(null),t(!1)},onError:()=>{t(!1)}}))},se=()=>{if(console.log("Form data:",n),!n.title||!n.message||n.recipients.length===0){console.log("Validation failed:",{hasTitle:!!n.title,hasMessage:!!n.message,recipientsCount:n.recipients.length});return}t(!0),console.log("Sending announcement to:",n.recipients),w.post(route("admin.notifications.send-announcement"),n,{onSuccess:s=>{console.log("Success response:",s),b({title:"",message:"",recipients:[],email_subject:"",email_body:""}),t(!1)},onError:s=>{console.log("Error response:",s),t(!1)}})},ae=s=>{w.post(route("admin.notifications.resend",s))};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(te,{user:P}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(ne,{user:P}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Notifications & Transparency"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manually send notifications for grades, honors, and general announcements"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Notifications"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.total})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Sent"}),e.jsx(le,{className:"h-4 w-4 text-green-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:v.sent})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Pending"}),e.jsx(u,{className:"h-4 w-4 text-yellow-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:v.pending})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Failed"}),e.jsx(f,{className:"h-4 w-4 text-red-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:v.failed})})]})]}),e.jsxs(ie,{value:J,onValueChange:K,className:"w-full",children:[e.jsxs(re,{className:"grid w-full grid-cols-4",children:[e.jsx(C,{value:"overview",children:"Overview"}),e.jsx(C,{value:"grade-notifications",children:"Grade Notifications"}),e.jsx(C,{value:"honor-notifications",children:"Honor Notifications"}),e.jsx(C,{value:"general-announcements",children:"General Announcements"})]}),e.jsx(A,{value:"overview",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Recent Notifications"})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:E.data.length>0?E.data.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[X(s.type),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500",children:s.message}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-400",children:Y(s.type)}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleDateString()}),s.recipients&&s.recipients.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:["â€¢ ",s.recipients.length," recipient",s.recipients.length!==1?"s":""]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Q(s.status),s.status==="failed"&&e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>ae(s.id),children:[e.jsx(u,{size:14,className:"mr-1"}),"Resend"]})]})]},s.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(f,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No notifications yet"}),e.jsx("p",{className:"text-sm",children:"Notifications will appear here after you send them"})]})})})]})}),e.jsx(A,{value:"grade-notifications",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Send Grade Update Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Preview and manually send grade notifications to students"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grade-school-year",children:"School Year"}),e.jsx(S,{id:"grade-school-year",value:i.school_year,onChange:s=>T({...i,school_year:s.target.value}),placeholder:"2024-2025"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"grade-academic-level",children:"Academic Level (Optional)"}),e.jsxs(H,{value:i.academic_level_id,onValueChange:s=>T({...i,academic_level_id:s}),children:[e.jsx(M,{children:e.jsx(I,{placeholder:"All Levels"})}),e.jsxs(O,{children:[e.jsx(_,{value:"all",children:"All Levels"}),R.map(s=>e.jsx(_,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{onClick:$,disabled:N||!i.school_year,variant:"outline",className:"flex-1",children:[N?e.jsx(u,{size:16,className:"mr-2 animate-spin"}):e.jsx(V,{size:16,className:"mr-2"}),"Preview Recipients"]})}),a&&e.jsx(B,{className:a.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.success?e.jsx(G,{size:16,className:"text-green-600"}):e.jsx(D,{size:16,className:"text-red-600"}),e.jsx(q,{className:a.success?"text-green-800":"text-red-800",children:a.message})]})}),a&&a.success&&a.students.length>0&&e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("h4",{className:"font-medium mb-3",children:["Recipients (",a.count," students)"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.students.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-white rounded border",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",s.student_number,")"]})]}),e.jsxs("div",{className:"text-gray-500",children:[s.academic_level," â€¢ ",s.grade_count," grades"]})]},s.id))})]}),e.jsxs(j,{onClick:Z,disabled:p||!a||!a.success||a.count===0,className:"w-full",children:[p?e.jsx(u,{size:16,className:"mr-2 animate-spin"}):e.jsx(F,{size:16,className:"mr-2"}),"Send Grade Notifications"]})]})]})}),e.jsx(A,{value:"honor-notifications",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Send Honor Qualification Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Preview and manually send honor notifications to students"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"honor-school-year",children:"School Year"}),e.jsx(S,{id:"honor-school-year",value:r.school_year,onChange:s=>k({...r,school_year:s.target.value}),placeholder:"2024-2025"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"honor-academic-level",children:"Academic Level (Optional)"}),e.jsxs(H,{value:r.academic_level_id,onValueChange:s=>k({...r,academic_level_id:s}),children:[e.jsx(M,{children:e.jsx(I,{placeholder:"All Levels"})}),e.jsxs(O,{children:[e.jsx(_,{value:"all",children:"All Levels"}),R.map(s=>e.jsx(_,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{onClick:W,disabled:N||!r.school_year,variant:"outline",className:"flex-1",children:[N?e.jsx(u,{size:16,className:"mr-2 animate-spin"}):e.jsx(V,{size:16,className:"mr-2"}),"Preview Recipients"]})}),a&&e.jsx(B,{className:a.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.success?e.jsx(G,{size:16,className:"text-green-600"}):e.jsx(D,{size:16,className:"text-red-600"}),e.jsx(q,{className:a.success?"text-green-800":"text-red-800",children:a.message})]})}),a&&a.success&&a.students.length>0&&e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("h4",{className:"font-medium mb-3",children:["Recipients (",a.count," students)"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.students.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-white rounded border",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",s.student_number,")"]})]}),e.jsxs("div",{className:"text-gray-500",children:[s.academic_level," â€¢ ",s.honor_type," â€¢ GPA: ",s.gpa]})]},s.id))})]}),e.jsxs(j,{onClick:ee,disabled:p||!a||!a.success||a.count===0,className:"w-full",children:[p?e.jsx(u,{size:16,className:"mr-2 animate-spin"}):e.jsx(F,{size:16,className:"mr-2"}),"Send Honor Notifications"]})]})]})}),e.jsx(A,{value:"general-announcements",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(o,{children:"Send General Announcement"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Send announcements to specific users or groups"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"announcement-title",children:"Title"}),e.jsx(S,{id:"announcement-title",value:n.title,onChange:s=>b({...n,title:s.target.value}),placeholder:"Announcement title"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"announcement-message",children:"Message"}),e.jsx(S,{id:"announcement-message",value:n.message,onChange:s=>b({...n,message:s.target.value}),placeholder:"Announcement message"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"announcement-recipients",children:"Recipients (Email addresses, one per line)"}),e.jsx("textarea",{id:"announcement-recipients",value:n.recipients.join(`
`),onChange:s=>b({...n,recipients:s.target.value.split(`
`).filter(m=>m.trim())}),placeholder:`student1@example.com
student2@example.com`,className:"min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:4})]}),e.jsxs(j,{onClick:se,disabled:p||!n.title||!n.message||n.recipients.length===0,className:"w-full",children:[p?e.jsx(u,{size:16,className:"mr-2 animate-spin"}):e.jsx(F,{size:16,className:"mr-2"}),"Send Announcement"]})]})]})})]})]})})]})]})}export{Oe as default};
