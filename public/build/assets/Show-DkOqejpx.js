import{j as e,L as M,$ as O}from"./app-DV6pQfte.js";import{S as k}from"./layout-C2ZF3aCp.js";import{B as b}from"./badge-DU0rNQbn.js";import{C as S,b as A,c as w,a as _}from"./card-Cfgbc4YJ.js";import{A as V}from"./arrow-left-B3zYIVCk.js";import{A as R}from"./award-De4PSKbP.js";import{C as E}from"./calendar-4YhggAHK.js";import{U as P}from"./user-B13b5oL4.js";import{B}from"./book-open-vuHNhnUp.js";import{G as D}from"./graduation-cap-l7vHyC9O.js";/* empty css            */import"./app-shell-CPdL0zJr.js";import"./button-vZZaD-Ov.js";import"./Combination-DXwulNrV.js";import"./index-DI3PmIre.js";import"./dropdown-menu-07BmKsff.js";import"./index-DjczLSwL.js";import"./app-sidebar-Bg2HkMGp.js";import"./separator-Bd8ogLlG.js";import"./chevron-right-BCpJ0uGb.js";import"./crown-CjvZ_FOv.js";import"./file-text-COaHkmHf.js";function oe({user:N,subject:m,grades:x,gradingPeriods:g,teacher:f}){var I;m.academic_level_id||((I=x[0])==null||I.academic_level_id);const h=g.some(r=>r.type==="semester");console.log("🔍 Student Grades Show - Data:",{subject:m,gradesCount:x.length,grades:x.map(r=>({id:r.id,grade:r.grade,period_id:r.grading_period_id,period:r.gradingPeriod})),gradingPeriods:g.map(r=>({id:r.id,name:r.name,parent_id:r.parent_id,type:r.type,period_type:r.period_type})),isSemesterBased:h});const j=(()=>{if(!h)return[{semesterNumber:1,name:"All Periods",periods:g.filter(t=>t.period_type!=="final").map(t=>({id:t.id,name:t.name,code:t.code,gradingPeriodId:t.id}))}];const r={},l=g.filter(s=>s.parent_id===null&&s.type==="semester");return console.log("🔍 Parent semesters for student view:",l.map(s=>({id:s.id,name:s.name}))),g.forEach(s=>{if(s.parent_id===null&&s.type==="semester"||s.period_type==="final"||s.name.toLowerCase().includes("average"))return;const n=s.parent_id;if(!n){console.log(`⚠️ Period "${s.name}" has no parent_id, skipping`);return}const d=l.find(c=>c.id===n);if(!d){console.log(`⚠️ No parent semester found for period "${s.name}" (parent_id: ${n})`);return}const a=l.findIndex(c=>c.id===n)+1;console.log(`🔍 Period "${s.name}" (${s.code}) assigned to Semester ${a} (parent: ${d.name})`),r[a]||(r[a]={name:d.name,periods:[]}),r[a].periods.push({id:s.id,name:s.name,code:s.code,gradingPeriodId:s.id})}),Object.keys(r).map(s=>({semesterNumber:parseInt(s),...r[s]})).sort((s,t)=>s.semesterNumber-t.semesterNumber)})();console.log("🔍 Semester structure:",j);const L=()=>{if(!h){const a=x.filter(o=>o.grade!==null&&o.grade!==void 0);return{semester1Average:null,semester2Average:null,overallAverage:a.length>0?a.reduce((o,u)=>o+u.grade,0)/a.length:null}}const r=g.filter(a=>a.parent_id===null&&a.type==="semester"),l={};r.forEach(a=>{const c=x.filter(o=>{const u=g.find(v=>v.id===o.grading_period_id);return u&&u.parent_id===a.id&&u.period_type!=="final"&&o.grade!==null&&o.grade!==void 0});if(c.length>0){const o=c.reduce((u,v)=>u+parseFloat(v.grade.toString()),0)/c.length;l[a.id]=o,console.log(`🔍 Semester "${a.name}" (ID: ${a.id}) average:`,o,"from",c.length,"grades")}else l[a.id]=null});const s=r[0]?l[r[0].id]:null,t=r[1]?l[r[1].id]:null,n=Object.values(l).filter(a=>a!==null),d=n.length>0?n.reduce((a,c)=>a+c,0)/n.length:null;return console.log("🔍 Student averages:",{semester1Average:s,semester2Average:t,overallAverage:d}),{semester1Average:s,semester2Average:t,overallAverage:d}},{semester1Average:C,semester2Average:$,overallAverage:i}=L(),y=r=>h?r>=1&&r<=1.24?"Superior":r>=1.25&&r<=1.49?"Excellent":r>=1.5&&r<=1.74?"Very Good":r>=1.75&&r<=1.99?"Good":r>=2&&r<=2.24?"Satisfactory":r>=2.25&&r<=2.49?"Fair":r>=2.5&&r<=2.74?"Passing":r>=2.75&&r<=3?"Conditional":"Failed":r>=90?"Outstanding":r>=85?"Very Satisfactory":r>=80?"Satisfactory":r>=75?"Fairly Satisfactory":"Did Not Meet Expectations",p=r=>h?r>=1&&r<=1.49?"bg-green-100 text-green-800 border-green-200":r>=1.5&&r<=1.99?"bg-blue-100 text-blue-800 border-blue-200":r>=2&&r<=2.49?"bg-purple-100 text-purple-800 border-purple-200":r>=2.5&&r<=2.99?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200":r>=90?"bg-green-100 text-green-800 border-green-200":r>=85?"bg-blue-100 text-blue-800 border-blue-200":r>=80?"bg-purple-100 text-purple-800 border-purple-200":r>=75?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200",F=[{bg:"bg-blue-500",label:"bg-blue-100 text-blue-800"},{bg:"bg-green-500",label:"bg-green-100 text-green-800"},{bg:"bg-orange-500",label:"bg-orange-100 text-orange-800"},{bg:"bg-purple-500",label:"bg-purple-100 text-purple-800"}];return e.jsxs(k,{children:[e.jsx(M,{title:`${m.name} • Grades`}),e.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(O,{href:route("student.grades.index"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Back to Grades"})]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:m.name}),e.jsxs("p",{className:"text-gray-600",children:["Subject Code: ",m.code]})]})]}),e.jsxs(S,{children:[e.jsx(A,{children:e.jsxs(w,{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Grade Summary"})]})}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:j.flatMap(r=>r.periods.map((l,s)=>{const t=x.find(d=>d.grading_period_id===l.gradingPeriodId),n=F[s%F.length];return e.jsxs("div",{className:`text-center p-6 ${n.bg} text-white rounded-lg`,children:[e.jsx("div",{className:"text-4xl font-bold mb-2",children:t?t.grade:"—"}),e.jsx("div",{className:"text-sm opacity-90",children:l.name})]},l.id)}))}),h&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:C!==null?C.toFixed(2):"—"}),e.jsx("div",{className:"text-sm text-blue-600",children:"First Semester"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:$!==null?$.toFixed(2):"—"}),e.jsx("div",{className:"text-sm text-green-600",children:"Second Sem"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 text-center min-w-48",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:i!==null?i.toFixed(2):"—"}),e.jsx("div",{className:"text-gray-600 mb-2",children:"Overall Average"}),i!==null&&e.jsx(b,{className:p(i),children:y(i)})]})})]})]}),h&&j.length>1?j.map(r=>{if(r.periods.length===0)return null;const l=r.periods.map(t=>{const n=x.find(d=>d.grading_period_id===t.gradingPeriodId);return n==null?void 0:n.grade}).filter(t=>t!=null),s=l.length>0?l.reduce((t,n)=>t+n,0)/l.length:null;return e.jsxs(S,{children:[e.jsx(A,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-gray-600"}),r.name]})}),e.jsx(_,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900 text-white",children:[e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Student ID"}),e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Subject"}),e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Faculty"}),r.periods.map(t=>e.jsx("th",{className:"text-center p-2 border-r border-gray-600",children:t.name},t.id)),e.jsxs("th",{className:"p-2 border-r border-gray-600",children:["SEM",r.semesterNumber," Average"]}),e.jsx("th",{className:"p-2",children:"Grade Status"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b bg-white hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-r border-gray-200 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-4 w-4 mr-2 text-gray-400"}),N.student_number||N.id]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:m.name}),e.jsx("div",{className:"text-sm text-gray-500",children:m.code})]})]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("div",{className:"text-sm text-gray-600",children:f?f.name:"N/A"})]})}),r.periods.map(t=>{const n=x.find(d=>d.grading_period_id===t.gradingPeriodId);return e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:n?e.jsx(b,{className:p(n.grade),children:n.grade}):e.jsx("span",{className:"text-gray-400",children:"—"})},t.id)}),e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:s?e.jsx(b,{className:`text-lg px-3 py-1 ${p(s)}`,children:s.toFixed(2)}):e.jsx("span",{className:"text-gray-400",children:"—"})}),e.jsx("td",{className:"p-3 text-center",children:s?e.jsx(b,{className:p(s),children:y(s)}):e.jsx("span",{className:"text-gray-400",children:"No Grade"})})]})})]})})})]},r.semesterNumber)}):e.jsxs(S,{children:[e.jsx(A,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-gray-600"}),"Detailed Grades"]})}),e.jsx(_,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900 text-white",children:[e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Student ID"}),e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Subject"}),e.jsx("th",{className:"p-2 border-r border-gray-600",children:"Faculty"}),j.flatMap(r=>r.periods).map(r=>e.jsx("th",{className:"text-center p-2 border-r border-gray-600",children:r.name},r.id)),e.jsx("th",{className:"p-2 border-r border-gray-600",children:"AVERAGE"}),e.jsx("th",{className:"p-2",children:"Grade Status"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b bg-white hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-r border-gray-200 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-4 w-4 mr-2 text-gray-400"}),N.student_number||N.id]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:m.name}),e.jsx("div",{className:"text-sm text-gray-500",children:m.code})]})]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("div",{className:"text-sm text-gray-600",children:f?f.name:"N/A"})]})}),j.flatMap(r=>r.periods).map(r=>{const l=x.find(s=>s.grading_period_id===r.gradingPeriodId);return e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:l?e.jsx(b,{className:p(l.grade),children:l.grade}):e.jsx("span",{className:"text-gray-400",children:"—"})},r.id)}),e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:i?e.jsx(b,{className:`text-lg px-3 py-1 ${p(i)}`,children:i.toFixed(2)}):e.jsx("span",{className:"text-gray-400",children:"—"})}),e.jsx("td",{className:"p-3 text-center",children:i?e.jsx(b,{className:p(i),children:y(i)}):e.jsx("span",{className:"text-gray-400",children:"No Grade"})})]})})]})})})]})]})]})}export{oe as default};
