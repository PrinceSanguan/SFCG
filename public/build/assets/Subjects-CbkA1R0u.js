import{r as N,u as Ee,j as e,$ as Pe,S as $}from"./app-BkVPVcnZ.js";import{H as He}from"./header-fn5p6F9M.js";import{S as Me}from"./sidebar-DOjktVe9.js";import{C as z,a as U,b as pe,c as _e}from"./card-Bo8tIcRE.js";import{B as g}from"./button-B_JxxeNr.js";import{I as b}from"./input-Cx4wUWfW.js";import{L as t}from"./label-BcrgAkRa.js";import{S as h,a as m,b as x,c as j,d as n}from"./select-CoS2EWLi.js";import{B as v}from"./badge-BiJ8FLd_.js";import{D as ve,a as Ye,b as fe,c as be,d as Ne,f as ye,e as Se}from"./dialog-hhQHWZf3.js";import{T as Ie,a as Oe,b as F,c as ke}from"./tabs-C-lZtQA6.js";import{A as $e}from"./arrow-left-BjziAwyY.js";import{P as q}from"./plus-CVpO6aAK.js";import{B as E}from"./book-open-B99evfDU.js";import{S as J}from"./square-pen-CZ3u0jhr.js";import{T as W}from"./trash-2-DJEta8fN.js";import{H as ze}from"./hash-abWBVaNn.js";import{C as Ue}from"./clock-CylN9N65.js";/* empty css            */import"./dropdown-menu-B8lfSesE.js";import"./Combination-CDi_H7xM.js";import"./index-b6WblCkr.js";import"./separator-DdFB6N9C.js";import"./users-Cm1p8o7h.js";import"./chevron-right-cTjjTJdC.js";import"./crown-C8vRD1_G.js";import"./building-2-_kHq1BmW.js";import"./user-cog-DRHyIjqX.js";import"./user-check-kFvdi0jA.js";import"./graduation-cap-pCb_JQkn.js";import"./notebook-C53r2JQT.js";import"./chart-no-axes-column-increasing-BmFcAawg.js";import"./shield-BLAhEjWy.js";import"./index-DJyaaNh7.js";import"./index-CMduMO1j.js";import"./check-DzU7p3Bo.js";function ws({user:R,subjects:P=[],academicLevels:p=[],gradingPeriods:k=[],courses:K=[],departments:Q=[],yearLevels:X={},shsYearLevels:Z={},tracks:L=[],strands:ee=[]}){var te,ce,ne,oe,he,me,xe,je;const[Ce,we]=N.useState("all"),[C,se]=N.useState(null),{addToast:f}=Ee(),[i,c]=N.useState({name:"",code:"",description:"",academic_level_id:"",grade_levels:[],grading_period_id:"",department_id:"",course_id:"",semester_id:"",units:0,hours_per_week:0,is_core:!1,is_active:!0,track_id:"",strand_id:"",shs_year_level:"",jhs_year_level:""}),[Fe,y]=N.useState(!1),[a,u]=N.useState(null),[Ge,G]=N.useState(!1),[A,V]=N.useState(1),[S,T]=N.useState(null),Ae=()=>{V(1),T(null),c({name:"",code:"",description:"",academic_level_id:"",grade_levels:[],grading_period_id:"",department_id:"",course_id:"",semester_id:"",units:0,hours_per_week:0,is_core:!1,is_active:!0,track_id:"",strand_id:"",shs_year_level:"",jhs_year_level:""}),y(!0)},Ve=s=>{T(s),c(l=>({...l,academic_level_id:s.id.toString()})),V(2)},Te=()=>{V(1),T(null),c(s=>({...s,academic_level_id:""}))},le=()=>{y(!1),V(1),T(null),c({name:"",code:"",description:"",academic_level_id:"",grade_levels:[],grading_period_id:"",department_id:"",course_id:"",semester_id:"",units:0,hours_per_week:0,is_core:!1,is_active:!0,track_id:"",strand_id:"",shs_year_level:"",jhs_year_level:""})},B=s=>P.filter(l=>l.academic_level.key===s),H=s=>{const l=B("elementary");return s?l.filter(d=>!d.grade_levels||d.grade_levels.length===0||d.grade_levels.includes(s)):l},ie=s=>k.filter(l=>l.academic_level_id===s),ae=s=>k.filter(l=>l.academic_level_id===s&&l.parent_id==null&&(l.type==="semester"||/semester/i.test(l.name))),re=s=>k.filter(l=>{var d;return s&&((d=l.parent_id)==null?void 0:d.toString())===s}),D=[{value:"grade_1",label:"Grade 1"},{value:"grade_2",label:"Grade 2"},{value:"grade_3",label:"Grade 3"},{value:"grade_4",label:"Grade 4"},{value:"grade_5",label:"Grade 5"},{value:"grade_6",label:"Grade 6"}],de=()=>{if(!i.academic_level_id)return!1;const s=p.find(l=>l.id.toString()===i.academic_level_id);return(s==null?void 0:s.key)==="elementary"},Be=()=>{if(console.log("Form submission started:",i),!i.name||!i.code||!i.academic_level_id){console.log("Validation failed: Missing required fields"),f("Please fill in all required fields (Name, Code, and Academic Level).","error");return}if(de()&&i.grade_levels.length===0){console.log("Validation failed: No grade levels selected for elementary"),f("Please select at least one grade level for elementary subjects.","error");return}console.log("Form validation passed, submitting..."),console.log("Form data being sent:",JSON.stringify(i,null,2));const s={...i,description:i.description||null,grading_period_id:i.grading_period_id||null,course_id:i.course_id||null};$.post(route("admin.academic.subjects.store"),s,{preserveScroll:!0,onSuccess:l=>{console.log("Subject created successfully:",l),f("Subject created successfully!","success"),c({name:"",code:"",description:"",academic_level_id:"",grade_levels:[],grading_period_id:"",department_id:"",course_id:"",semester_id:"",units:0,hours_per_week:0,is_core:!1,is_active:!0,track_id:"",strand_id:"",shs_year_level:"",jhs_year_level:""}),y(!1)},onError:l=>{if(console.log("Subject creation failed:",l),console.log("Error details:",JSON.stringify(l,null,2)),l.code){const d=`${i.code}_${Date.now().toString().slice(-4)}`;f(`Subject code "${i.code}" already exists. Try "${d}" instead.`,"error"),c(r=>({...r,code:d}))}else l.name?f(`Subject name error: ${l.name}`,"error"):f("Failed to create subject. Please check the form and try again.","error")}})},De=s=>{const l={name:s.name,code:s.code,description:s.description||"",academic_level_id:s.academic_level_id,grade_levels:s.grade_levels||[],grading_period_id:s.grading_period_id||"",course_id:s.course_id||"",units:s.units,hours_per_week:s.hours_per_week,is_core:s.is_core,is_active:s.is_active};$.put(route("admin.academic.subjects.update",s.id),l,{preserveScroll:!0,onSuccess:()=>{f("Subject updated successfully!","success"),G(!1)},onError:()=>{f("Failed to update subject. Please check the form and try again.","error")}})},M=s=>{confirm(`Delete subject ${s.name}?`)&&$.delete(route("admin.academic.subjects.destroy",s.id),{preserveScroll:!0,onSuccess:()=>{f("Subject deleted successfully!","success")},onError:()=>{f("Failed to delete subject. Please try again.","error")}})},Y=s=>{u(s),G(!0)},I=s=>s?e.jsx(v,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"}):e.jsx(v,{variant:"secondary",children:"Inactive"}),O=s=>s?e.jsx(v,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Core"}):e.jsx(v,{variant:"outline",children:"Elective"}),w=s=>{switch(s){case"elementary":return"🎓";case"junior_highschool":return"📚";case"senior_highschool":return"🎯";case"college":return"🏛️";default:return"📖"}};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(Me,{user:R}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(He,{user:R}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"mb-4",children:e.jsx(Pe,{href:route("admin.academic.index"),children:e.jsxs(g,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Back to Academic & Curriculum"]})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Manage Subjects per Level"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create and manage subjects for each academic level with appropriate grading periods."})]}),e.jsx(z,{children:e.jsx(U,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold",children:"Subjects"}),e.jsxs(ve,{open:Fe,onOpenChange:y,children:[e.jsx(Ye,{asChild:!0,children:e.jsxs(g,{onClick:Ae,className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Subject"]})}),e.jsxs(fe,{className:"w-[95vw] max-w-[900px] max-h-[85vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsx(Ne,{children:A===1?"Select Academic Level":`Add New Subject - ${S==null?void 0:S.name}`}),e.jsx(ye,{children:A===1?"Choose the academic level for your new subject":`Create a new subject for ${S==null?void 0:S.name}`})]}),A===1?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(s=>e.jsx("div",{onClick:()=>Ve(s),className:"p-6 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:w(s.key)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.key==="elementary"&&"Grades 1-6 with grade level selection",s.key==="junior_highschool"&&"Grades 7-10 with year level selection",s.key==="senior_highschool"&&"Grades 11-12 with track and strand selection",s.key==="college"&&"College courses with department and course selection"]})]})]})},s.id))})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-name",children:"Name"}),e.jsx(b,{id:"subject-name",placeholder:"e.g., Mathematics, English, Science",value:i.name,onChange:s=>c({...i,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-code",children:"Code"}),e.jsx(b,{id:"subject-code",placeholder:"e.g., MATH101, ENG101",value:i.code,onChange:s=>c({...i,code:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-description",children:"Description"}),e.jsx(b,{id:"subject-description",placeholder:"Brief description of the subject",value:i.description,onChange:s=>c({...i,description:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Academic Classification"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-level",children:"Academic Level"}),e.jsxs("div",{className:"relative",children:[e.jsxs(h,{value:i.academic_level_id,onValueChange:s=>c({...i,academic_level_id:s,grading_period_id:"",course_id:""}),disabled:!0,children:[e.jsx(m,{className:"bg-gray-50 cursor-not-allowed",children:e.jsx(x,{placeholder:"Select academic level"})}),e.jsx(j,{children:p.map(s=>e.jsx(n,{value:s.id.toString(),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:w(s.key)}),s.name]})},s.id))})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("span",{className:"text-xs text-gray-500 bg-blue-100 px-2 py-1 rounded",children:"Selected"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Academic level was selected in the previous step"})]}),(()=>{const s=p.find(d=>d.id.toString()===i.academic_level_id),l=(s==null?void 0:s.key)==="elementary"||(s==null?void 0:s.key)==="junior_highschool";return console.log("Debug - Generic Period - Selected Level:",s),console.log("Debug - Generic Period - Should Show:",l),l?e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-grading",children:"Grading Period"}),e.jsxs(h,{value:i.grading_period_id,onValueChange:d=>c({...i,grading_period_id:d}),disabled:!i.academic_level_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select grading period"})}),e.jsx(j,{children:i.academic_level_id&&ie(parseInt(i.academic_level_id)).filter(d=>d.parent_id==null).map(d=>e.jsxs(n,{value:d.id.toString(),children:[d.name," (",d.code,")"]},d.id))})]})]}):null})()]}),(()=>{const s=p.find(r=>r.id.toString()===i.academic_level_id),l=(s==null?void 0:s.key)==="senior_highschool",d=(s==null?void 0:s.key)==="college";return(l||d)&&e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-year-level",children:"Year Level"}),e.jsxs(h,{value:l?i.shs_year_level:i.year_level||"",onValueChange:r=>{c(l?_=>({..._,shs_year_level:r}):{...i,year_level:r})},children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select year level"})}),e.jsx(j,{children:l?Object.entries(Z).map(([r,_])=>e.jsx(n,{value:r,children:_},r)):Object.entries(X).map(([r,_])=>e.jsx(n,{value:r,children:_},r))})]})]})})(),i.academic_level_id&&((te=p.find(s=>s.id.toString()===i.academic_level_id))==null?void 0:te.key)==="senior_highschool"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-track",children:"Track"}),e.jsxs(h,{value:i.track_id,onValueChange:s=>c(l=>({...l,track_id:s,strand_id:""})),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select track"})}),e.jsx(j,{children:(L||[]).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.name," (",s.code,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-strand",children:"Strand"}),e.jsxs(h,{value:i.strand_id,onValueChange:s=>c(l=>({...l,strand_id:s})),disabled:!i.track_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select strand"})}),e.jsx(j,{children:ee.filter(s=>i.track_id&&s.track_id.toString()===String(i.track_id)).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.name," (",s.code,")"]},s.id))})]})]})]}),i.academic_level_id&&((ce=p.find(s=>s.id.toString()===i.academic_level_id))==null?void 0:ce.key)==="college"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-dept",children:"Department"}),e.jsxs(h,{value:i.department_id,onValueChange:s=>c({...i,department_id:s,course_id:"",semester_id:"",grading_period_id:""}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select department"})}),e.jsx(j,{children:Q.map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-course",children:"Course"}),e.jsxs(h,{value:i.course_id,onValueChange:s=>c({...i,course_id:s}),disabled:!i.department_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select course (required for college subjects)"})}),e.jsx(j,{children:K.filter(s=>{var l;return!i.department_id||((l=s.department_id)==null?void 0:l.toString())===i.department_id}).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.code," - ",s.name]},s.id))})]})]})]})]}),de()&&e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-grade-levels",children:"Grade Levels"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2",children:D.map(s=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:i.grade_levels.includes(s.value),onChange:l=>{l.target.checked?c({...i,grade_levels:[...i.grade_levels,s.value]}):c({...i,grade_levels:i.grade_levels.filter(d=>d!==s.value)})},className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:s.label})]},s.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select which grade levels this subject applies to"})]}),(()=>{const s=p.find(d=>d.id.toString()===i.academic_level_id);if((s==null?void 0:s.key)!=="junior_highschool")return null;const l=[{value:"first_year",label:"1st Year"},{value:"second_year",label:"2nd Year"},{value:"third_year",label:"3rd Year"},{value:"fourth_year",label:"4th Year"}];return e.jsxs("div",{children:[e.jsx(t,{htmlFor:"jhs-year",children:"Year Level"}),e.jsxs(h,{value:i.jhs_year_level,onValueChange:d=>c(r=>({...r,jhs_year_level:d})),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select year level"})}),e.jsx(j,{children:l.map(d=>e.jsx(n,{value:d.value,children:d.label},d.value))})]})]})})(),(()=>{const s=p.find(r=>r.id.toString()===i.academic_level_id),l=(s==null?void 0:s.key)==="senior_highschool",d=(s==null?void 0:s.key)==="college";return l?e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-period",children:"Grading Period"}),e.jsxs(h,{value:i.grading_period_id,onValueChange:r=>c({...i,grading_period_id:r}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select period (optional)"})}),e.jsx(j,{children:i.academic_level_id&&k.filter(r=>r.academic_level_id===parseInt(i.academic_level_id)).filter(r=>r.parent_id!=null).map(r=>e.jsx(n,{value:r.id.toString(),children:r.name},r.id))})]})]}):d?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-semester",children:"Semester"}),e.jsxs(h,{value:i.semester_id,onValueChange:r=>c({...i,semester_id:r,grading_period_id:""}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select semester (optional)"})}),e.jsx(j,{children:i.academic_level_id&&ae(parseInt(i.academic_level_id)).map(r=>e.jsx(n,{value:r.id.toString(),children:r.name},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-period",children:"Period"}),e.jsxs(h,{value:i.grading_period_id,onValueChange:r=>c({...i,grading_period_id:r}),disabled:!i.semester_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select period (optional)"})}),e.jsx(j,{children:re(i.semester_id).map(r=>e.jsx(n,{value:r.id.toString(),children:r.name},r.id))})]})]})]}):null})(),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Subject Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-units",children:"Units"}),e.jsx(b,{id:"subject-units",type:"number",min:"0",step:"0.5",value:i.units,onChange:s=>c({...i,units:parseFloat(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subject-hours",children:"Hours per Week"}),e.jsx(b,{id:"subject-hours",type:"number",min:"0",value:i.hours_per_week,onChange:s=>c({...i,hours_per_week:parseInt(s.target.value)||0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"subject-core",type:"checkbox",checked:i.is_core,onChange:s=>c({...i,is_core:s.target.checked}),className:"rounded border-gray-300"}),e.jsx(t,{htmlFor:"subject-core",children:"Core Subject"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"subject-active",type:"checkbox",checked:i.is_active,onChange:s=>c({...i,is_active:s.target.checked}),className:"rounded border-gray-300"}),e.jsx(t,{htmlFor:"subject-active",children:"Active"})]})]})]})]}),e.jsx(Se,{children:A===1?e.jsx(e.Fragment,{children:e.jsx(g,{variant:"outline",onClick:le,children:"Cancel"})}):e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"outline",onClick:Te,children:"Back"}),e.jsx(g,{variant:"outline",onClick:le,children:"Cancel"}),e.jsx(g,{onClick:Be,children:"Create Subject"})]})})]})]})]})})}),e.jsxs(Ie,{value:Ce,onValueChange:we,className:"w-full",children:[e.jsxs(Oe,{className:"grid w-full grid-cols-5",children:[e.jsx(F,{value:"all",children:"All Subjects"}),e.jsx(F,{value:"elementary",children:"Elementary"}),e.jsx(F,{value:"junior_highschool",children:"Junior High"}),e.jsx(F,{value:"senior_highschool",children:"Senior High"}),e.jsx(F,{value:"college",children:"College"})]}),e.jsx(ke,{value:"all",className:"space-y-4",children:e.jsxs(z,{children:[e.jsx(pe,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"All Subjects (",P.length,")"]})}),e.jsx(U,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Code"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Level"}),e.jsx("th",{className:"text-left p-3",children:"Grade Levels"}),e.jsx("th",{className:"text-left p-3",children:"Period"}),e.jsx("th",{className:"text-left p-3",children:"Course"}),e.jsx("th",{className:"text-left p-3",children:"Units"}),e.jsx("th",{className:"text-left p-3",children:"Hours"}),e.jsx("th",{className:"text-left p-3",children:"Type"}),e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Actions"})]})}),e.jsx("tbody",{children:P.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:e.jsx(v,{variant:"outline",className:"font-mono",children:s.code})}),e.jsx("td",{className:"p-3 font-medium",children:s.name}),e.jsx("td",{className:"p-3",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:w(s.academic_level.key)}),s.academic_level.name]})}),e.jsx("td",{className:"p-3",children:s.academic_level.key==="elementary"&&s.grade_levels&&s.grade_levels.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:s.grade_levels.map(l=>{var d;return e.jsx(v,{variant:"secondary",className:"text-xs",children:((d=D.find(r=>r.value===l))==null?void 0:d.label)||l},l)})}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-3",children:s.grading_period?e.jsx(v,{variant:"outline",children:s.grading_period.name}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-3",children:s.course?e.jsx(v,{variant:"outline",className:"bg-blue-100 text-blue-800",children:s.course.code}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-3",children:s.units}),e.jsx("td",{className:"p-3",children:s.hours_per_week}),e.jsx("td",{className:"p-3",children:O(s.is_core)}),e.jsx("td",{className:"p-3",children:I(s.is_active)}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>Y(s),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>M(s),className:"text-red-600 hover:text-red-700",children:e.jsx(W,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]})}),p.map(s=>e.jsx(ke,{value:s.key,className:"space-y-4",children:e.jsxs(z,{children:[e.jsx(pe,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx("span",{children:w(s.key)}),s.name," Subjects (",s.key==="elementary"?H(C||void 0).length:B(s.key).length,")"]})}),e.jsx(U,{children:s.key==="elementary"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(t,{className:"text-sm font-medium",children:"Filter by Grade Level:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(g,{variant:C===null?"default":"outline",size:"sm",onClick:()=>se(null),children:"All Grades"}),D.map(l=>e.jsx(g,{variant:C===l.value?"default":"outline",size:"sm",onClick:()=>se(l.value),children:l.label},l.value))]})]}),H(C||void 0).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(E,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No subjects defined"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["Get started by creating the first subject for ",s.name,"."]}),e.jsxs(g,{variant:"outline",onClick:()=>{c({...i,academic_level_id:s.id.toString()}),y(!0)},className:"border-blue-300 text-blue-600 hover:bg-blue-50",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add First Subject"]})]}):e.jsx("div",{className:"overflow-x-auto rounded border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Code"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Grade Levels"}),e.jsx("th",{className:"text-left p-3",children:"Units"}),e.jsx("th",{className:"text-left p-3",children:"Hours/Week"}),e.jsx("th",{className:"text-left p-3",children:"Type"}),e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Actions"})]})}),e.jsx("tbody",{children:H(C||void 0).map(l=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 font-mono",children:l.code}),e.jsx("td",{className:"p-3",children:l.name}),e.jsx("td",{className:"p-3",children:l.grade_levels&&l.grade_levels.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.grade_levels.map(d=>{var r;return e.jsx(v,{variant:"secondary",className:"text-xs",children:((r=D.find(_=>_.value===d))==null?void 0:r.label)||d},d)})}):e.jsx(v,{variant:"outline",className:"text-xs text-gray-500",children:"All Grades"})}),e.jsx("td",{className:"p-3",children:l.units}),e.jsx("td",{className:"p-3",children:l.hours_per_week}),e.jsx("td",{className:"p-3",children:O(l.is_core)}),e.jsx("td",{className:"p-3",children:I(l.is_active)}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>Y(l),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>M(l),className:"text-red-600 hover:text-red-700",children:e.jsx(W,{className:"h-4 w-4"})})]})})]},l.id))})]})})]}):e.jsx(e.Fragment,{children:B(s.key).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(E,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No subjects defined"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["Get started by creating the first subject for ",s.name,"."]}),e.jsxs(g,{variant:"outline",onClick:()=>{c({...i,academic_level_id:s.id.toString()}),y(!0)},className:"border-blue-300 text-blue-600 hover:bg-blue-50",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add First Subject"]})]}):e.jsx("div",{className:"grid gap-4",children:B(s.key).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:l.name}),e.jsxs(v,{variant:"outline",className:"text-xs font-mono bg-gray-100 dark:bg-gray-600",children:[e.jsx(ze,{className:"h-3 w-3 mr-1"}),l.code]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[l.grading_period&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),l.grading_period.name]}),e.jsxs("span",{children:[l.units," units"]}),e.jsxs("span",{children:[l.hours_per_week," hrs/week"]})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[O(l.is_core),I(l.is_active),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>Y(l),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>M(l),className:"text-red-600 hover:text-red-700",children:e.jsx(W,{className:"h-4 w-4"})})]})]})]},l.id))})})})]})},s.key))]})]})})]}),e.jsx(ve,{open:Ge,onOpenChange:G,children:e.jsxs(fe,{className:"w-[95vw] max-w-[900px] max-h-[85vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsxs(Ne,{children:["Edit Subject - ",(ne=a==null?void 0:a.academic_level)==null?void 0:ne.name]}),e.jsxs(ye,{children:["Update the subject details for ",(oe=a==null?void 0:a.academic_level)==null?void 0:oe.name]})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-name",children:"Name"}),e.jsx(b,{id:"edit-subject-name",placeholder:"e.g., Mathematics, English, Science",value:a.name,onChange:s=>u({...a,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-code",children:"Code"}),e.jsx(b,{id:"edit-subject-code",placeholder:"e.g., MATH101, ENG101",value:a.code,onChange:s=>u({...a,code:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-description",children:"Description"}),e.jsx(b,{id:"edit-subject-description",placeholder:"Brief description of the subject",value:a.description||"",onChange:s=>u({...a,description:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Academic Classification"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-level",children:"Academic Level"}),e.jsxs("div",{className:"relative",children:[e.jsxs(h,{value:a.academic_level_id.toString(),onValueChange:s=>u({...a,academic_level_id:Number(s),grading_period_id:void 0,course_id:void 0}),disabled:!0,children:[e.jsx(m,{className:"bg-gray-50 cursor-not-allowed",children:e.jsx(x,{placeholder:"Select academic level"})}),e.jsx(j,{children:p.map(s=>e.jsx(n,{value:s.id.toString(),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:w(s.key)}),s.name]})},s.id))})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("span",{className:"text-xs text-gray-500 bg-blue-100 px-2 py-1 rounded",children:"Selected"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Academic level cannot be changed when editing"})]}),(()=>{var d;const s=p.find(r=>r.id===a.academic_level_id);return(s==null?void 0:s.key)==="elementary"||(s==null?void 0:s.key)==="junior_highschool"?e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-grading",children:"Grading Period"}),e.jsxs(h,{value:((d=a.grading_period_id)==null?void 0:d.toString())||"",onValueChange:r=>u({...a,grading_period_id:Number(r)}),disabled:!a.academic_level_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select grading period"})}),e.jsx(j,{children:a.academic_level_id&&ie(a.academic_level_id).filter(r=>r.parent_id==null).map(r=>e.jsxs(n,{value:r.id.toString(),children:[r.name," (",r.code,")"]},r.id))})]})]}):null})(),(()=>{const s=p.find(d=>d.id===a.academic_level_id);if((s==null?void 0:s.key)!=="junior_highschool")return null;const l=[{value:"first_year",label:"1st Year"},{value:"second_year",label:"2nd Year"},{value:"third_year",label:"3rd Year"},{value:"fourth_year",label:"4th Year"}];return e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-jhs-year",children:"Year Level"}),e.jsxs(h,{value:a.jhs_year_level||"",onValueChange:d=>u({...a,jhs_year_level:d}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select year level"})}),e.jsx(j,{children:l.map(d=>e.jsx(n,{value:d.value,children:d.label},d.value))})]})]})})()]}),(()=>{const s=p.find(r=>r.id===a.academic_level_id),l=(s==null?void 0:s.key)==="senior_highschool",d=(s==null?void 0:s.key)==="college";return(l||d)&&e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-year-level",children:"Year Level"}),e.jsxs(h,{value:l?a.shs_year_level||"":a.year_level||"",onValueChange:r=>{u(l?{...a,shs_year_level:r}:{...a,year_level:r})},children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select year level"})}),e.jsx(j,{children:l?Object.entries(Z).map(([r,_])=>e.jsx(n,{value:r,children:_},r)):Object.entries(X).map(([r,_])=>e.jsx(n,{value:r,children:_},r))})]})]})})(),a.academic_level_id&&((he=p.find(s=>s.id===a.academic_level_id))==null?void 0:he.key)==="senior_highschool"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-track",children:"Track"}),e.jsxs(h,{value:a.track_id||"",onValueChange:s=>u({...a,track_id:s,strand_id:""}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select track"})}),e.jsx(j,{children:(L||[]).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.name," (",s.code,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-strand",children:"Strand"}),e.jsxs(h,{value:a.strand_id||"",onValueChange:s=>u({...a,strand_id:s}),disabled:!a.track_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select strand"})}),e.jsx(j,{children:ee.filter(s=>a.track_id&&s.track_id.toString()===String(a.track_id)).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.name," (",s.code,")"]},s.id))})]})]})]}),a.academic_level_id&&((me=p.find(s=>s.id===a.academic_level_id))==null?void 0:me.key)==="college"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-dept",children:"Department"}),e.jsxs(h,{value:((xe=a.department_id)==null?void 0:xe.toString())||"",onValueChange:s=>u({...a,department_id:Number(s),course_id:void 0,semester_id:void 0,grading_period_id:void 0}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select department"})}),e.jsx(j,{children:Q.map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-course",children:"Course"}),e.jsxs(h,{value:((je=a.course_id)==null?void 0:je.toString())||"",onValueChange:s=>u({...a,course_id:Number(s)}),disabled:!a.department_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select course (required for college subjects)"})}),e.jsx(j,{children:K.filter(s=>!a.department_id||s.department_id===a.department_id).map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.code," - ",s.name]},s.id))})]})]})]})]}),(()=>{var r,_,ue,ge;const s=p.find(o=>o.id===a.academic_level_id),l=(s==null?void 0:s.key)==="senior_highschool",d=(s==null?void 0:s.key)==="college";return l?e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-period",children:"Grading Period"}),e.jsxs(h,{value:((r=a.grading_period_id)==null?void 0:r.toString())||"",onValueChange:o=>u({...a,grading_period_id:Number(o)}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select period (optional)"})}),e.jsx(j,{children:a.academic_level_id&&k.filter(o=>o.academic_level_id===a.academic_level_id).filter(o=>o.parent_id!=null).map(o=>e.jsx(n,{value:o.id.toString(),children:o.name},o.id))})]})]}):d?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-semester",children:"Semester"}),e.jsxs(h,{value:((_=a.semester_id)==null?void 0:_.toString())||"",onValueChange:o=>u({...a,semester_id:Number(o),grading_period_id:void 0}),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select semester (optional)"})}),e.jsx(j,{children:a.academic_level_id&&ae(a.academic_level_id).map(o=>e.jsx(n,{value:o.id.toString(),children:o.name},o.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-period",children:"Period"}),e.jsxs(h,{value:((ue=a.grading_period_id)==null?void 0:ue.toString())||"",onValueChange:o=>u({...a,grading_period_id:Number(o)}),disabled:!a.semester_id,children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Select period (optional)"})}),e.jsx(j,{children:re((ge=a.semester_id)==null?void 0:ge.toString()).map(o=>e.jsx(n,{value:o.id.toString(),children:o.name},o.id))})]})]})]}):null})(),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 border-b pb-2",children:"Subject Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-units",children:"Units"}),e.jsx(b,{id:"edit-subject-units",type:"number",min:"0",step:"0.5",value:a.units,onChange:s=>u({...a,units:parseFloat(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-subject-hours",children:"Hours per Week"}),e.jsx(b,{id:"edit-subject-hours",type:"number",min:"0",value:a.hours_per_week,onChange:s=>u({...a,hours_per_week:parseInt(s.target.value)||0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"edit-subject-core",type:"checkbox",checked:a.is_core,onChange:s=>u({...a,is_core:s.target.checked}),className:"rounded border-gray-300"}),e.jsx(t,{htmlFor:"edit-subject-core",children:"Core Subject"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"edit-subject-active",type:"checkbox",checked:a.is_active,onChange:s=>u({...a,is_active:s.target.checked}),className:"rounded border-gray-300"}),e.jsx(t,{htmlFor:"edit-subject-active",children:"Active"})]})]})]})]}),e.jsxs(Se,{children:[e.jsx(g,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),e.jsx(g,{onClick:()=>a&&De(a),children:"Update Subject"})]})]})})]})}export{ws as default};
