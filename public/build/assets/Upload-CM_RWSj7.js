import{c as k,K as w,m as C,j as e}from"./app-CEl-APsC.js";import{S as V,H as D}from"./sidebar-CiHO-y2I.js";import{C as U,b as T,c as P,a as F}from"./card-B4q6Ame0.js";import{B as b}from"./button-CKIhprG8.js";import{I as f}from"./input-DKtQm51Y.js";import{L as i}from"./label-B8Lt35n1.js";import{S as m,a as x,b as h,c as j,d as n}from"./select-D0yo45hq.js";import{T as G}from"./triangle-alert-B8GiRxDq.js";import{C as A}from"./circle-x-CdHSmDmw.js";import{U as H}from"./upload-C1a3VLbX.js";import{D as I}from"./download-CANAVn9y.js";/* empty css            */import"./dropdown-menu-CAqDati1.js";import"./Combination-DliHkq0c.js";import"./index-DW57C5Ri.js";import"./user-CDiIq-up.js";import"./log-out-8dJQvB83.js";import"./book-open-DKUAlxJf.js";import"./graduation-cap-DAO1Kdzj.js";import"./crown-DClj_1Oe.js";import"./index-Bz9Cl0ZU.js";import"./index-DvXVcg-Y.js";import"./check-X2sMxzrC.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],B=k("CircleCheck",O);function ne({user:p,assignedSubjects:v,academicLevels:g,gradingPeriods:_,schoolYear:N}){const{flash:r}=w().props,{data:l,setData:t,post:y,processing:u,errors:d}=C({csv_file:null,subject_id:"",academic_level_id:"",grading_period_id:"0",school_year:N||"2024-2025",year_of_study:""}),S=s=>{s.preventDefault();const a=new FormData;Object.entries(l).forEach(([c,o])=>a.append(c,o)),y(route("adviser.grades.upload.process"),{forceFormData:!0})};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(V,{user:p}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(D,{user:p}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-4",children:[(r==null?void 0:r.success)&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:r.success})})]}),(r==null?void 0:r.warning)&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(G,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 whitespace-pre-line",children:r.warning})})]}),Object.keys(d).length>0&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(A,{className:"h-5 w-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:Object.values(d).map((s,a)=>e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:s},a))})]}),e.jsxs(U,{children:[e.jsxs(T,{children:[e.jsx(P,{children:"Upload Grades CSV"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Upload multiple student grades at once using a CSV file. Select the subject and academic level, then download the template pre-filled with your students."})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:S,className:"space-y-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsxs(i,{children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:l.subject_id,onValueChange:s=>t("subject_id",s),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select subject"})}),e.jsx(j,{children:v.map(s=>e.jsx(n,{value:s.subject.id.toString(),children:s.subject.name},s.subject.id))})]}),d.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs(i,{children:["Academic Level ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(m,{value:l.academic_level_id,onValueChange:s=>t({...l,academic_level_id:s,grading_period_id:"0"}),children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select academic level"})}),e.jsx(j,{children:g.map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))})]}),d.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Grading Period"}),e.jsxs(m,{value:l.grading_period_id,onValueChange:s=>t("grading_period_id",s),disabled:!l.academic_level_id,children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Select grading period (optional)"})}),e.jsxs(j,{children:[e.jsx(n,{value:"0",children:"No Period"}),l.academic_level_id&&_.filter(s=>{var c;if(((c=s.academic_level_id)==null?void 0:c.toString())!==l.academic_level_id)return!1;const a=g.find(o=>o.id.toString()===l.academic_level_id);return(a==null?void 0:a.key)==="senior_highschool"||(a==null?void 0:a.key)==="college"?!s.parent_id:!0}).map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{children:"School Year"}),e.jsx(f,{value:l.school_year,onChange:s=>t("school_year",s.target.value)})]}),e.jsxs("div",{children:[e.jsxs(i,{children:["CSV File ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(f,{type:"file",accept:".csv,text/csv",onChange:s=>t("csv_file",s.target.files?s.target.files[0]:null)}),d.csv_file&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.csv_file}),l.csv_file&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["‚úì File selected: ",l.csv_file.name]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:"üìã How to Upload Grades"}),e.jsxs("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Select the ",e.jsx("strong",{children:"Subject"})," and ",e.jsx("strong",{children:"Academic Level"})]}),e.jsxs("li",{children:["Click ",e.jsx("strong",{children:'"Download Template"'})," to get a CSV with enrolled students"]}),e.jsxs("li",{children:["Fill in the ",e.jsx("strong",{children:"Grade"})," column (values: 75-100)"]}),e.jsx("li",{children:"Save the file and upload it using the form above"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(b,{type:"submit",disabled:u||!l.subject_id||!l.academic_level_id||!l.csv_file,className:"flex items-center gap-2",title:l.subject_id?l.academic_level_id?l.csv_file?"Upload grades from CSV":"Please select a CSV file":"Please select an academic level":"Please select a subject",children:[e.jsx(H,{className:"h-4 w-4"}),u?"Uploading...":"Upload CSV"]}),e.jsx("a",{href:route("adviser.grades.template",{subject_id:l.subject_id||void 0,school_year:l.school_year}),download:!0,children:e.jsxs(b,{type:"button",variant:"outline",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),l.subject_id?"Download Template (with students)":"Download Template"]})})]}),(!l.subject_id||!l.academic_level_id||!l.csv_file)&&e.jsx("p",{className:"text-sm text-amber-600 dark:text-amber-400",children:"‚ö†Ô∏è Please fill in all required fields (*) to enable upload"})]})]})})]})]})})]})]})}export{ne as default};
