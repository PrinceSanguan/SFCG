import{r as j,m as _,j as e,S as N}from"./app-DaKwj-XB.js";import{H as me}from"./header-D3vC1nhn.js";import{S as xe}from"./sidebar-DGhPrn6Y.js";import{C as b,a as k,b as he,c as ue}from"./card-CRQsJM40.js";import{B as x}from"./button-bBmw8mf6.js";import{S as I,a as R,b as V,c as z,d as C}from"./select-B3xabIYV.js";import{T as pe,a as je,b as U,c as r,d as ge,e as d}from"./table-024BJ5eS.js";import{D as fe,a as ve,b as ye,c as D,d as _e}from"./dropdown-menu-dU4gEQJi.js";import{B as S}from"./badge-CUE2u-W2.js";import{A as O}from"./arrow-left-mZtsu7KO.js";import{S as Ne}from"./school-DIy8366B.js";import{B as be}from"./book-open-DZ7X9b4K.js";import{G as ke}from"./graduation-cap-2_cFB5Cg.js";import{U as Se}from"./users-BvkQ5MGx.js";import{F as B}from"./file-text-eHc1lIns.js";import{E as we,P as Ce,a as De}from"./printer-CS-dFt5L.js";import{D as J}from"./download-B7Fkj0LH.js";/* empty css            */import"./separator-BzYv7_mA.js";import"./index-DSVYsQvB.js";import"./Combination-C9qf0SB_.js";import"./chevron-right-DudE0_Sv.js";import"./crown-CEcPYr_C.js";import"./building-2-Qml43D7a.js";import"./user-cog-BrKmeD14.js";import"./user-check-DtPrhQSt.js";import"./notebook-KTyucx7q.js";import"./chart-no-axes-column-increasing-_wBqf6D0.js";import"./shield-nwUbA19F.js";import"./index-DR81kQUd.js";import"./index-C2zuZjuP.js";import"./check-ClQfsk5k.js";const G=[{key:"elementary",name:"Elementary",icon:Ne,color:"bg-blue-500 hover:bg-blue-600",iconColor:"text-blue-600"},{key:"junior_highschool",name:"Junior High School",icon:be,color:"bg-green-500 hover:bg-green-600",iconColor:"text-green-600"},{key:"senior_highschool",name:"Senior High School",icon:ke,color:"bg-orange-500 hover:bg-orange-600",iconColor:"text-orange-600"},{key:"college",name:"College",icon:Se,color:"bg-purple-500 hover:bg-purple-600",iconColor:"text-purple-600"}];function gs({user:T,academicLevels:f,honorTypes:Be=[],templates:q,allHonors:w=[],generatedCertificates:o=[],schoolYears:v,currentSchoolYear:K,stats:Ge}){var L,F;const[l,A]=j.useState(null),[i,Q]=j.useState(K||(v==null?void 0:v[0])||"2024-2025"),[p,P]=j.useState(""),[n,y]=j.useState([]),[Te,Ae]=j.useState([]),[Pe,He]=j.useState(!1),{data:Me,setData:W,post:X,processing:Z}=_({student_id:"",template_id:"",academic_level_id:"",school_year:i}),{data:$e,setData:Y,post:ee,processing:H}=_({student_ids:[],template_id:"",academic_level_id:"",school_year:i}),{data:Ee,setData:se,post:ae,processing:M}=_({certificate_ids:[]}),{data:Le,setData:te,post:le,processing:$}=_({academic_level_id:"",school_year:i,honor_type_id:""}),E=s=>w.length?w.filter(a=>a&&a.academic_level&&a.academic_level.key===s&&a.school_year===i).sort((a,t)=>a.year_level!==t.year_level?(a.year_level||"").localeCompare(t.year_level||""):a.section_id!==t.section_id?(a.section_id||0)-(t.section_id||0):(t.gpa||0)-(a.gpa||0)):[],ie=s=>{const a=f.find(t=>t.key===s);return a?q.filter(t=>t.academic_level_id===a.id&&t.is_active):[]},ne=s=>{W({student_id:s.student.id.toString(),template_id:p,academic_level_id:s.academic_level.id.toString(),school_year:i}),X(route("admin.academic.certificates.generate"),{onSuccess:()=>{N.reload()}})},ce=()=>{if(n.length===0||!p)return;const s=f.find(a=>a.key===l);s&&(Y({student_ids:n,template_id:p,academic_level_id:s.id.toString(),school_year:i}),ee(route("admin.academic.certificates.generate-bulk"),{onSuccess:()=>{y([]),N.reload()}}))},re=s=>{y(a=>a.includes(s)?a.filter(t=>t!==s):[...a,s])},de=()=>{const a=E(l).map(t=>t.student.id);y(n.length===a.length?[]:a)},oe=()=>{const s=f.find(a=>a.key===l);s&&(te({academic_level_id:s.id.toString(),school_year:i,honor_type_id:""}),le(route("admin.academic.certificates.bulk-generate-by-level"),{onSuccess:()=>{N.reload()}}))},h=l?E(l):[],g=l?ie(l):[];return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(xe,{user:T}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(me,{user:T}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>N.get("/admin/academic"),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Back to Academic"]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Certificate Management"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Generate and manage honor certificates by academic level."})]}),e.jsx(b,{children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"School Year:"}),e.jsxs(I,{value:i,onValueChange:Q,children:[e.jsx(R,{className:"w-40",children:e.jsx(V,{})}),e.jsx(z,{children:v.map(s=>e.jsx(C,{value:s,children:s},s))})]})]})})}),l?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(x,{variant:"outline",onClick:()=>{A(null),y([]),P("")},children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Back to Categories"]}),e.jsxs("h2",{className:"text-2xl font-bold",children:[(L=G.find(s=>s.key===l))==null?void 0:L.name," Honor Students"]}),e.jsxs(S,{variant:"outline",children:[h.length," students"]})]})}),e.jsxs(b,{children:[e.jsx(he,{children:e.jsx(ue,{children:"Certificate Generation"})}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Select Certificate Template",g.length===0&&e.jsx("span",{className:"ml-2 text-xs text-red-600 font-normal",children:"(No templates - Run: php artisan db:seed --class=CertificateTemplateSeeder)"})]}),e.jsxs(I,{value:p,onValueChange:P,children:[e.jsx(R,{className:g.length===0?"border-red-300":"",children:e.jsx(V,{placeholder:g.length>0?"Choose a template...":"⚠️ No templates available - seed database first"})}),e.jsx(z,{children:g.length>0?g.map(s=>e.jsx(C,{value:s.id.toString(),children:s.name},s.id)):e.jsx(C,{value:"none",disabled:!0,children:"No templates available - run CertificateTemplateSeeder"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{onClick:oe,disabled:h.length===0||$,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),$?"Generating All...":"Generate All Missing Certificates"]}),e.jsxs(fe,{children:[e.jsx(ve,{asChild:!0,children:e.jsxs(x,{variant:"outline",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"More Actions"]})}),e.jsxs(ye,{align:"end",className:"w-56",children:[e.jsxs(D,{onClick:ce,disabled:n.length===0||!p||H,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),H?"Generating...":`Generate ${n.length} Selected`]}),e.jsxs(D,{onClick:()=>{const s=h.filter(a=>n.includes(a.student.id)).map(a=>{const t=o==null?void 0:o.find(c=>c.student.id===a.student.id&&c.academicLevel.id===a.academic_level.id);return t==null?void 0:t.id}).filter(Boolean);s.length>0&&(se({certificate_ids:s}),ae(route("admin.academic.certificates.bulk-print-pdf")))},disabled:n.length===0||M,children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),M?"Preparing...":`Download ${n.length} Selected`]}),e.jsx(_e,{}),e.jsxs(D,{onClick:()=>{var s;return window.open(`/admin/academic/certificates/honor-roll/pdf?academic_level_id=${(s=f.find(a=>a.key===l))==null?void 0:s.id}&school_year=${i}`,"_blank")},children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Honor Roll PDF"]})]})]})]})]})})]}),e.jsx(b,{children:e.jsx(k,{children:h.length>0?e.jsxs(pe,{children:[e.jsx(je,{children:e.jsxs(U,{children:[e.jsx(r,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:n.length===h.length&&h.length>0,onChange:de})}),e.jsx(r,{children:"Rank"}),e.jsx(r,{children:"Student Name"}),e.jsx(r,{children:"Student Number"}),e.jsx(r,{children:"Year Level"}),e.jsx(r,{children:"Section"}),e.jsx(r,{children:"Honor Type"}),e.jsx(r,{children:"GPA"}),e.jsx(r,{children:"Certificate"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(ge,{children:h.map((s,a)=>{var t,c;return!s||!s.student?null:e.jsxs(U,{children:[e.jsx(d,{children:e.jsx("input",{type:"checkbox",checked:n.includes(s.student.id),onChange:()=>re(s.student.id)})}),e.jsxs(d,{className:"font-medium",children:["#",a+1]}),e.jsx(d,{className:"font-medium",children:s.student.name}),e.jsx(d,{children:s.student.student_number||"N/A"}),e.jsx(d,{children:s.year_level||s.student.year_level||"N/A"}),e.jsx(d,{children:((t=s.student.section)==null?void 0:t.name)||"N/A"}),e.jsx(d,{children:e.jsx(S,{variant:"secondary",children:((c=s.honor_type)==null?void 0:c.name)||"Unknown Honor"})}),e.jsx(d,{className:"font-mono",children:s.gpa?s.gpa.toFixed(2):"N/A"}),e.jsx(d,{children:(()=>{const m=o==null?void 0:o.find(u=>u.student.id===s.student.id&&u.academic_level.id===s.academic_level.id&&u.school_year===s.school_year);return m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"default",className:"text-xs",children:"Generated"}),e.jsx("span",{className:"text-xs text-gray-500",children:m.serial_number})]}):e.jsx(S,{variant:"outline",className:"text-xs",children:"Pending"})})()}),e.jsx(d,{children:e.jsx("div",{className:"flex gap-1",children:(()=>{const m=o==null?void 0:o.find(u=>u.student.id===s.student.id&&u.academic_level.id===s.academic_level.id&&u.school_year===s.school_year);return m?e.jsxs(e.Fragment,{children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>window.open(`/admin/academic/certificates/${m.id}/download`,"_blank"),className:"h-8 px-2",children:e.jsx(J,{className:"h-3 w-3"})}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>window.open(`/admin/academic/certificates/${m.id}/print`,"_blank"),className:"h-8 px-2",children:e.jsx(De,{className:"h-3 w-3"})})]}):e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>ne(s),disabled:!p||Z,className:"h-8 px-2",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Generate"]})})()})})]},s.id||a)})})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Honor Students Found"}),e.jsxs("p",{className:"text-sm",children:["No approved honor students for ",(F=G.find(s=>s.key===l))==null?void 0:F.name," in ",i,"."]})]})})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:G.map(s=>{const a=s.icon,t=w.filter(c=>{var m;return((m=c==null?void 0:c.academic_level)==null?void 0:m.key)===s.key&&c.school_year===i}).length;return e.jsx(b,{className:"cursor-pointer transition-all hover:shadow-lg",onClick:()=>A(s.key),children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-gray-100",children:e.jsx(a,{className:`h-8 w-8 ${s.iconColor}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t," honor students"]})]}),e.jsx(x,{className:`w-full ${s.color} text-white`,children:"View Students"})]})})},s.key)})})]})})]})]})}export{gs as default};
