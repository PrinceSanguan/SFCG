import{m as W,r as z,j as e,$ as w}from"./app-CQ5AN36T.js";import{S as M,H as J}from"./sidebar-DQhWrPMk.js";import{C as Q,b as H,c as P,a as V}from"./card-BcNwggYn.js";import{B as g}from"./button-BoV6fehk.js";import{I as b}from"./input-DHEITPOL.js";import{L as l}from"./label-BvWAHqS9.js";import{S as u,a as j,b as _,c as p,d as c,e as Y,f as $}from"./select-DFWmA3qt.js";import{A as X}from"./arrow-left-KvSKvqHM.js";import{P as Z}from"./plus-DkNdchfA.js";import{S as U}from"./save-Dx9x3_5p.js";/* empty css            */import"./dropdown-menu-B9ID4uZa.js";import"./Combination-Bv5JKoUl.js";import"./index-BJGmqfEw.js";import"./user-BgpLF8MR.js";import"./log-out-Cj9k4iic.js";import"./book-open-BQ9M9GEn.js";import"./graduation-cap-BI_umQGg.js";import"./upload-4FFhS2PY.js";import"./crown-D4u4mVSD.js";import"./index-Dmza9R4_.js";import"./index-B0gH_oYL.js";import"./check-De3kUHn_.js";function Ne({user:C,academicLevels:f,gradingPeriods:m,assignedSubjects:o,selectedStudent:h}){var L,F,I,E;const G=o.map(s=>s.academicLevel),S=m.filter(s=>G.some(a=>a.id===s.academic_level_id)),N=(()=>{const s=new Set;return S.forEach(a=>{a.code.includes("Q1")&&s.add(1),a.code.includes("Q2")&&s.add(2),a.code.includes("Q3")&&s.add(3),a.code.includes("Q4")&&s.add(4)}),Array.from(s).sort().map(a=>({id:a,name:`${a}${a===1?"st":a===2?"nd":a===3?"rd":"th"} Quarter`,value:a.toString()}))})();console.log("Teacher Create component data:",{teacherAcademicLevels:G.map(s=>({id:s.id,name:s.name,key:s.key})),teacherGradingPeriods:S.map(s=>({id:s.id,name:s.name,code:s.code,academic_level_id:s.academic_level_id})),availableQuarters:N.map(s=>s.name)});const{data:t,setData:d,post:B,processing:v,errors:r}=W({student_id:"",subject_id:"",academic_level_id:"",grading_period_id:"0",school_year:"2024-2025",year_of_study:"",grade:""});z.useEffect(()=>{var A;const s=new URLSearchParams(window.location.search),a=s.get("student_id"),n=s.get("subject_id"),i=s.get("academic_level_id"),y=s.get("academic_level_key"),O=s.get("school_year");if(a&&n&&i){d("student_id",a),d("subject_id",n),d("academic_level_id",i),d("school_year",O||"2024-2025"),d("year_of_study",""),d("grade",""),y&&f.find(T=>T.id.toString()===i)&&d("academic_level_id",i);const R=window.location.pathname;window.history.replaceState({},"",R)}else h&&(d("student_id",h.id.toString()),d("subject_id",((A=h.subjectId)==null?void 0:A.toString())||""),d("academic_level_id",h.academicLevelKey||""),d("school_year","2024-2025"),d("year_of_study",""),d("grade",""))},[h,d]);const D=s=>{if(!s)return null;for(const a of o)if(a.enrolled_students.find(i=>i.student.id.toString()===s))return{subjectId:a.subject.id,academicLevelId:a.academicLevel.id,academicLevelKey:a.academicLevel.key,schoolYear:a.school_year};return null},K=s=>{if(d("student_id",s),s){const a=D(s);a&&(d("subject_id",a.subjectId.toString()),d("academic_level_id",a.academicLevelId.toString()),d("school_year",a.schoolYear))}else d("subject_id",""),d("academic_level_id",""),d("grade","")},k=s=>{s.preventDefault();const a={...t};if(t.grading_period_id&&t.grading_period_id!=="0"){const n=f.find(i=>i.id.toString()===t.academic_level_id);if(n){const i=S.find(y=>y.academic_level_id===n.id&&y.code.includes(`Q${t.grading_period_id}`));i&&(a.grading_period_id=i.id.toString())}}console.log("Form submitted with data:",a),console.log("Has pre-selected student:",x),B(route("teacher.grades.store"),{onSuccess:()=>{console.log("Grade created successfully")},onError:n=>{console.log("Grade creation failed:",n)}})},x=t.student_id&&t.subject_id&&t.academic_level_id;return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(M,{user:C}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(J,{user:C}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{href:route("teacher.grades.index"),children:e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:x?"Input Grade":"Input New Grade"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:x?"Enter a grade for the selected student.":"Enter a new grade for a student in your assigned course."})]})]})}),e.jsxs(Q,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Grade Information"]})}),e.jsx(V,{children:x?e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Student:"}),e.jsx("p",{className:"font-medium",children:((F=(L=o.find(s=>s.enrolled_students.some(a=>a.student.id.toString()===t.student_id)))==null?void 0:L.enrolled_students.find(s=>s.student.id.toString()===t.student_id))==null?void 0:F.student.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Subject:"}),e.jsx("p",{className:"font-medium",children:((I=o.find(s=>s.subject.id.toString()===t.subject_id))==null?void 0:I.subject.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Academic Level:"}),e.jsx("p",{className:"font-medium",children:((E=f.find(s=>s.id.toString()===t.academic_level_id))==null?void 0:E.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"School Year:"}),e.jsx("p",{className:"font-medium",children:t.school_year})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"grade",children:"Grade"}),e.jsx(b,{id:"grade",type:"number",step:"0.1",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:t.grade,onChange:s=>d("grade",s.target.value),className:r.grade?"border-red-500":"",autoFocus:!0}),r.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Senior High School: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(u,{value:t.grading_period_id,onValueChange:s=>d("grading_period_id",s),children:[e.jsx(j,{className:r.grading_period_id?"border-red-500":"",children:e.jsx(_,{placeholder:"Select grading period"})}),e.jsxs(p,{children:[e.jsx(c,{value:"0",children:"No Period"}),m&&m.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx($,{children:"First Semester"}),m.filter(s=>s.code.startsWith("SHS_S1_")&&!s.code.includes("_FA")).sort((s,a)=>s.sort_order-a.sort_order).map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))]}),e.jsxs(Y,{children:[e.jsx($,{children:"Second Semester"}),m.filter(s=>s.code.startsWith("SHS_S2_")&&!s.code.includes("_FA")).sort((s,a)=>s.sort_order-a.sort_order).map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))]})]}):e.jsx(c,{value:"none",disabled:!0,children:"No grading periods available"})]})]}),r.grading_period_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.grading_period_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:N.length>0?"Select which grading period this grade belongs to":"No grading periods are configured for your assigned subjects"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(g,{type:"submit",disabled:v,className:"flex-1",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),v?"Saving...":"Save Grade"]}),e.jsx(w,{href:route("teacher.grades.index"),className:"flex-1",children:e.jsx(g,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]}):e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"student_id",children:"Student"}),e.jsxs(u,{value:t.student_id,onValueChange:K,children:[e.jsx(j,{className:r.student_id?"border-red-500":"",children:e.jsx(_,{placeholder:"Select a student"})}),e.jsx(p,{children:o.flatMap(s=>s.enrolled_students.map(a=>e.jsxs(c,{value:a.student.id.toString(),children:[a.student.name," - ",s.subject.name]},a.student.id)))})]}),r.student_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.student_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select a student from your assigned subjects"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(u,{value:t.subject_id,onValueChange:s=>d("subject_id",s),children:[e.jsx(j,{className:r.subject_id?"border-red-500":"",children:e.jsx(_,{placeholder:"Select a subject"})}),e.jsx(p,{children:o.map(s=>e.jsxs(c,{value:s.subject.id.toString(),children:[s.subject.name," (",s.subject.code,")",s.subject.course&&` - ${s.subject.course.name}`]},s.subject.id))})]}),r.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(u,{value:t.academic_level_id,onValueChange:s=>d("academic_level_id",s),children:[e.jsx(j,{className:r.academic_level_id?"border-red-500":"",children:e.jsx(_,{placeholder:"Select academic level"})}),e.jsx(p,{children:f.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]}),r.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(u,{value:t.grading_period_id,onValueChange:s=>d("grading_period_id",s),children:[e.jsx(j,{children:e.jsx(_,{placeholder:"Select grading period (optional)"})}),e.jsxs(p,{children:[e.jsx(c,{value:"0",children:"No Period"}),N.map(s=>e.jsx(c,{value:s.value,children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"school_year",children:"School Year"}),e.jsx(b,{id:"school_year",type:"text",placeholder:"e.g., 2024-2025",value:t.school_year,onChange:s=>d("school_year",s.target.value),className:r.school_year?"border-red-500":""}),r.school_year&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.school_year})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"year_of_study",children:"Year of Study"}),e.jsx(b,{id:"year_of_study",type:"number",min:"1",max:"10",placeholder:"e.g., 1, 2, 3, 4",value:t.year_of_study,onChange:s=>d("year_of_study",s.target.value),className:r.year_of_study?"border-red-500":""}),r.year_of_study&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.year_of_study}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required for college level"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"grade",children:"Grade"}),e.jsx(b,{id:"grade",type:"number",step:"0.01",min:"1.0",max:"5.0",placeholder:"Enter grade (1.0-5.0)",value:t.grade,onChange:s=>d("grade",s.target.value),className:r.grade?"border-red-500":""}),r.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75)."})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(g,{type:"submit",disabled:v,className:"flex-1",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),v?"Saving...":"Save Grade"]}),e.jsx(w,{href:route("teacher.grades.index"),className:"flex-1",children:e.jsx(g,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]})})]}),e.jsxs(Q,{children:[e.jsx(H,{children:e.jsx(P,{children:"Help & Guidelines"})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Student:"})," Select a student from your assigned subjects"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Subject:"})," Automatically populated when student is selected"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Grade Scale:"})," College uses 1.0-5.0 scale (1.0 highest, 3.0 passing), Elementary/Senior High uses 75-100 scale (75 passing)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Validation:"})," Grades are automatically submitted for validation after saving"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Editing:"})," You can edit grades before they are validated by the registrar"]})]})})]})]})})]})]})}export{Ne as default};
