import{r as p,m as z,u as $,j as e,$ as g,S as N}from"./app-DR6sD-DK.js";import{S as E,H as V}from"./sidebar-BCNRlD0P.js";import{C as w,b as v,c as y,a as b}from"./card-BoVaFnGa.js";import{B as r}from"./button-C_BExgkC.js";import{I as M}from"./input-Dg-TQgX1.js";import{B as A}from"./badge-EWLyCRlR.js";import{P as B}from"./PasswordResetModal-ClYzK7kX.js";import{S as F}from"./search-DXuI6e7q.js";import{U as H}from"./upload-C5I0SZCe.js";import{D as K}from"./download-Bp7xRCkX.js";import{U as q}from"./users-CZBD5C2D.js";import{E as O}from"./eye-DV2ahdyX.js";import{S as R}from"./square-pen-DH-AqQCs.js";import{K as G}from"./key-B6PRDCKv.js";import{T as J}from"./trash-2-B1RXD1bY.js";/* empty css            */import"./dropdown-menu-C0sgcMD1.js";import"./Combination-Dh8HBPKT.js";import"./index--iwrJTQ8.js";import"./separator-M_NtJdk9.js";import"./chevron-right-ek-HQxIb.js";import"./crown-Dt5PBMzH.js";import"./building-2-CQKbFqfY.js";import"./user-cog-CWk5Gp5U.js";import"./book-open-BkjZQZkJ.js";import"./user-check-CmK-2DgG.js";import"./graduation-cap-B0o3NCaS.js";import"./notebook-T1nQ83-E.js";import"./chart-no-axes-column-increasing-CJD30E7J.js";import"./label-BFJlIZ2q.js";import"./alert-aqhR50Ii.js";import"./dialog-sdIkTjSD.js";import"./rotate-ccw-DPYJnb_6.js";function Ue({user:h,users:l,filters:c,roles:Q,currentRole:t,yearLevel:a}){const[i,d]=p.useState(null),[m,f]=p.useState(null),{delete:C}=z(),n=p.useRef(null),{addToast:u}=$(),S=s=>{d(s)},k=s=>{f(s)},U=()=>{const s=a?{academic_level:a}:{};window.location.href=route("registrar.students.template",s)},D=()=>{var s;(s=n.current)==null||s.click()},_=s=>{var j;const o=(j=s.target.files)==null?void 0:j[0];if(!o)return;const x=new FormData;x.append("file",o),a&&x.append("academic_level",a),N.post(route("registrar.students.upload"),x,{forceFormData:!0,onSuccess:()=>{u("Students CSV uploaded successfully.","success"),N.reload()},onError:P=>{console.error("CSV upload failed:",P),u("CSV upload failed. Please check the file format.","error")}}),n.current&&(n.current.value="")},T=()=>{if(i){let s;t&&t!=="student"?s=route(`registrar.${t}s.destroy`,i.id):a?s=route("registrar.students.destroy",i.id):s=route("registrar.users.destroy",i.id),C(s,{onSuccess:()=>{d(null)}})}};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(E,{user:h}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(V,{user:h}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a?`${a.charAt(0).toUpperCase()+a.slice(1).replace("_"," ")} Students`:t?`${t.charAt(0).toUpperCase()+t.slice(1)} Management`:"User Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a?`Manage ${a.replace("_"," ")} student accounts.`:"Manage user accounts and permissions."})]}),e.jsxs(w,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Search & Filters"]})}),e.jsx(b,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex gap-4 flex-1",children:[e.jsx("div",{className:"flex-1",children:e.jsx(M,{placeholder:"Search users by name or email...",defaultValue:(c==null?void 0:c.search)||""})}),e.jsx(r,{children:"Search"})]}),a&&e.jsxs("div",{className:"flex flex-wrap gap-2 justify-end w-full lg:w-auto",children:[e.jsx("input",{type:"file",accept:".csv,text/csv",ref:n,className:"hidden",onChange:_}),e.jsxs(r,{variant:"outline",className:"flex items-center gap-2",onClick:D,children:[e.jsx(H,{className:"h-4 w-4"}),"Upload CSV"]}),e.jsxs(r,{variant:"outline",className:"flex items-center gap-2",onClick:U,children:[e.jsx(K,{className:"h-4 w-4"}),"Download Template"]})]})]})})]}),e.jsxs(w,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Users (",l.total,")"]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"space-y-4",children:[l.data.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),s.year_level&&e.jsx("p",{className:"text-xs text-gray-400 capitalize",children:s.year_level.replace("_"," ")})]}),e.jsx(A,{variant:"secondary",children:s.user_role})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{href:route("registrar.users.show",s.id),children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"View"]})}),e.jsx(g,{href:route("registrar.users.edit",s.id),children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Edit"]})}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>k(s),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Reset Password"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>S(s),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]},s.id)),l.data.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No users found."})})]}),l.last_page>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:l.last_page},(s,o)=>o+1).map(s=>e.jsx(r,{variant:s===l.current_page?"default":"outline",size:"sm",children:s},s))})})]})]})]})})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Confirm Delete"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",e.jsx("strong",{children:i.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(r,{variant:"outline",onClick:()=>d(null),children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:T,children:"Delete User"})]})]})}),m&&e.jsx(B,{user:m,isOpen:!!m,onClose:()=>f(null),routeName:t?`registrar.${t}s.reset-password`:"registrar.users.reset-password"})]})}export{Ue as default};
