import{j as e,$ as G}from"./app-Dq3kg1i3.js";import{C as v,b as _,c as A,a as y}from"./card-Dg2rTFw_.js";import{B as F}from"./button-Bvyrb0dp.js";import{B as w}from"./badge-e5AYl97X.js";import{S as V,H as R}from"./sidebar-g2l-i6Pk.js";import{A as H}from"./arrow-left-CqhiSWwn.js";import{U as C}from"./user-CpFsaDxd.js";import{M as q}from"./mail-DyeVQ6i3.js";import{B as L}from"./book-open-D5vTuGBE.js";import{G as E}from"./graduation-cap-BI5SZTDo.js";import{C as P}from"./calendar-DB42-73P.js";import{A as Y}from"./award-ClF2xrTD.js";import{P as z}from"./plus-C5NalBs8.js";import{S as M}from"./square-pen-DFbEbyA1.js";/* empty css            */import"./dropdown-menu-CsaVybiu.js";import"./Combination-hsI5cUxR.js";import"./index-HY8l_A1V.js";import"./log-out-mzCB-xKz.js";import"./upload-C5xuZmXF.js";import"./crown-CyKvMFRF.js";function fe({user:k,student:f,subject:j,academicLevel:S,grades:g,gradingPeriods:p}){console.log("ShowStudent props:",{user:k,student:f,subject:j,academicLevel:S,grades:g,gradingPeriods:p});const I=(s,n)=>n==="college"||n==="senior_highschool"?s<=1.5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s<=2.5?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s<=3?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":s>=95?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s>=90?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s>=85?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":s>=75?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",B=(s,n)=>n==="college"||n==="senior_highschool"?s<=1.5?"Superior":s<=2?"Very Good":s<=2.5?"Good":s<=3?"Satisfactory":"Failing":s>=95?"Outstanding":s>=90?"Very Good":s>=85?"Good":s>=80?"Satisfactory":s>=75?"Fair":"Failing",N=g.length>0?g[0]:null,h=S.key,$=S.name,u=(()=>{console.log("ðŸ” DEBUG - getSemesterStructure called with:",{academicLevelKey:h,allGradingPeriods:p.map(a=>({id:a.id,name:a.name,code:a.code}))});let s=p.filter(a=>{const t=h,r=a.name.toLowerCase(),l=a.code.toLowerCase(),d=[t.toLowerCase(),t.toLowerCase().replace("_",""),t.toLowerCase().replace("_"," ")];t==="college"&&d.push("tertiary","university","higher"),t==="senior_highschool"&&d.push("senior high","shs","senior_high","seniorhigh");const o=d.some(c=>l.includes(c)||r.includes(c));return console.log(`ðŸ” Period "${a.name}" (${a.code}) relevant for ${t}:`,o),o});if(s.length===0&&(console.log("ðŸ” No level-specific periods found, using all active periods as fallback"),s=p.filter(a=>a.is_active)),console.log("ðŸ” DEBUG - Relevant periods after filtering:",s.map(a=>({id:a.id,name:a.name,code:a.code}))),["senior_highschool","college"].includes(h)){const a={};s.forEach(r=>{let l=1;const d=r.name.toLowerCase(),o=r.code.toLowerCase();["s2","2nd","second","_s2","semester_2","sem_2","sem2","2nd semester","second semester","semester 2","sem 2","2nd sem","second sem","ii"," 2 ","_2_","-2-","spring","winter"].some(x=>o.includes(x)||d.includes(x))&&(l=2),console.log(`ðŸ” Period "${r.name}" (${r.code}) assigned to Semester ${l}`),a[l]||(a[l]={name:`${l===1?"First":"Second"} Semester`,periods:[]});const i=d==="first semester"||d==="second semester",m=r.name.toLowerCase().includes("final average")||r.code.includes("FA")||r.code.toLowerCase().includes("_fa");!i&&!m&&a[l].periods.push({id:r.id,name:r.name,code:r.code,gradingPeriodId:r.id})});let t=Object.keys(a).map(r=>({semesterNumber:parseInt(r),...a[r]}));if(t.length===0||t.every(r=>r.periods.length===0)){console.log("ðŸ” No periods grouped by semester, creating fallback structure");const r=s.filter(l=>{const d=l.name.toLowerCase(),o=d==="first semester"||d==="second semester",c=l.name.toLowerCase().includes("final average")||l.code.includes("FA")||l.code.toLowerCase().includes("_fa");return!o&&!c});if(console.log("ðŸ” All input periods for fallback:",r.map(l=>({id:l.id,name:l.name,code:l.code}))),r.length>0)if(r.length>=2){const l=Math.ceil(r.length/2);t=[{semesterNumber:1,name:"First Semester",periods:r.slice(0,l).map(d=>({id:d.id,name:d.name,code:d.code,gradingPeriodId:d.id}))},{semesterNumber:2,name:"Second Semester",periods:r.slice(l).map(d=>({id:d.id,name:d.name,code:d.code,gradingPeriodId:d.id}))}].filter(d=>d.periods.length>0)}else t=[{semesterNumber:1,name:"Semester",periods:r.map(l=>({id:l.id,name:l.name,code:l.code,gradingPeriodId:l.id}))}]}return console.log("ðŸ” Final semester structure (semester-based):",t),t}else{const a=[{semesterNumber:1,name:"Academic Year",periods:s.filter(t=>{const r=t.name.toLowerCase(),l=r==="first semester"||r==="second semester",d=t.name.toLowerCase().includes("final average")||t.code.includes("FA")||t.code.toLowerCase().includes("_fa");return!l&&!d}).sort((t,r)=>t.id-r.id).map(t=>({id:t.id,name:t.name,code:t.code,gradingPeriodId:t.id}))}];return console.log("ðŸ” Final quarter structure:",a),a}})();console.log("ðŸ” DEBUG - ShowStudent component data:",{academicLevelKey:h,academicLevel:S,gradingPeriods:p.map(s=>({id:s.id,name:s.name,code:s.code})),semesterStructure:u,totalGradingPeriods:p.length,semesterStructureLength:u.length,totalPeriodsInStructure:u.reduce((s,n)=>s+n.periods.length,0)});const U=()=>{if(!["college","senior_highschool"].includes(h)){const c=g.filter(i=>i.grade!==null&&i.grade!==void 0).map(i=>i.grade);return c.length>0?{semester1Average:null,semester2Average:null,overallAverage:c.reduce((i,m)=>i+m,0)/c.length}:{semester1Average:null,semester2Average:null,overallAverage:null}}const n=g.find(c=>{var m,x;const i=((x=(m=c.gradingPeriod)==null?void 0:m.code)==null?void 0:x.toUpperCase())||"";return i.includes("S1_MT")||i.includes("_S1_MT")}),a=g.find(c=>{var m,x;const i=((x=(m=c.gradingPeriod)==null?void 0:m.code)==null?void 0:x.toUpperCase())||"";return i.includes("S1_PF")||i.includes("_S1_PF")});let t=null;(n==null?void 0:n.grade)!==null&&(n==null?void 0:n.grade)!==void 0&&(a==null?void 0:a.grade)!==null&&(a==null?void 0:a.grade)!==void 0&&(t=(parseFloat(n.grade)+parseFloat(a.grade))/2);const r=g.find(c=>{var m,x;const i=((x=(m=c.gradingPeriod)==null?void 0:m.code)==null?void 0:x.toUpperCase())||"";return i.includes("S2_MT")||i.includes("_S2_MT")}),l=g.find(c=>{var m,x;const i=((x=(m=c.gradingPeriod)==null?void 0:m.code)==null?void 0:x.toUpperCase())||"";return i.includes("S2_PF")||i.includes("_S2_PF")});let d=null;(r==null?void 0:r.grade)!==null&&(r==null?void 0:r.grade)!==void 0&&(l==null?void 0:l.grade)!==null&&(l==null?void 0:l.grade)!==void 0&&(d=(parseFloat(r.grade)+parseFloat(l.grade))/2);let o=null;return t!==null&&d!==null?o=(t+d)/2:t!==null?o=t:d!==null&&(o=d),console.log("ðŸ” Semester averages:",{semester1:{midterm:n==null?void 0:n.grade,preFinal:a==null?void 0:a.grade,average:t},semester2:{midterm:r==null?void 0:r.grade,preFinal:l==null?void 0:l.grade,average:d},overall:o}),{semester1Average:t,semester2Average:d,overallAverage:o}},{semester1Average:T,semester2Average:O,overallAverage:D}=U(),b=D;return console.log("ðŸ” FINAL CALCULATION RESULT:",{grades:g.map(s=>{var n,a;return{id:s.id,grade:s.grade,period_id:s.grading_period_id,period_code:(n=s.gradingPeriod)==null?void 0:n.code,period_name:(a=s.gradingPeriod)==null?void 0:a.name}}),semester1Average:T,semester2Average:O,overallAverage:D,finalGrade:b}),u.reduce((s,n)=>s+n.periods.length,0),e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(V,{user:k}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(R,{user:k}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(G,{href:route("teacher.grades.index"),children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Student Details"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["View and manage grades for ",f.name]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{className:"bg-white shadow-sm",children:[e.jsx(_,{children:e.jsxs(A,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(C,{className:"h-5 w-5 text-gray-600"}),"Personal Information"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(C,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:f.name})]})]}),f.student_number&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-purple-100",children:e.jsx(C,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Student ID"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:f.student_number})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100",children:e.jsx(q,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:f.email})]})]})]})]}),e.jsxs(v,{className:"bg-white shadow-sm",children:[e.jsx(_,{children:e.jsxs(A,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(L,{className:"h-5 w-5 text-gray-600"}),"Subject & Course Information"]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-purple-100",children:e.jsx(L,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Subject"}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:[j.name," (",j.code,")"]})]})]}),j.course&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(E,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Course"}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:[j.course.name," (",j.course.code,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-orange-100",children:e.jsx(E,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Academic Level"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:$})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-yellow-100",children:e.jsx(P,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"School Year"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:(N==null?void 0:N.school_year)||"N/A"})]})]})]})})]}),p.length>0&&e.jsxs(v,{className:"bg-white shadow-sm",children:[e.jsxs(_,{children:[e.jsxs(A,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(P,{className:"h-5 w-5 text-gray-600"}),"Grading Periods"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Available grading periods for ",$]})]}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:p.filter(s=>{const n=h;return s.code.toLowerCase().includes(n.toLowerCase())}).map(s=>e.jsxs("div",{className:"relative border rounded-lg p-4 bg-gray-50",children:[e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(w,{variant:"outline",className:"text-xs bg-gray-100 text-gray-600",children:s.code})}),e.jsx("h4",{className:"font-medium mb-2 text-gray-900",children:s.name}),s.start_date&&s.end_date&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}),e.jsx(w,{variant:s.is_active?"default":"secondary",className:"text-xs",children:s.is_active?"Active":"Inactive"})]},s.id))})})]}),e.jsxs(v,{className:"bg-white shadow-sm",children:[e.jsx(_,{children:e.jsxs(A,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-600"}),"Grade Summary"]})}),e.jsx(y,{children:(()=>{if(g.filter(n=>n.grade!==null&&n.grade!==void 0).length>0||u.length>0){const n=b||0,a=n>0?B(n,h):"No Grade",t=u.flatMap(l=>l.periods.map(d=>({...d,semesterName:l.name}))),r=["bg-blue-500 text-white","bg-green-500 text-white","bg-orange-500 text-white","bg-purple-500 text-white","bg-pink-500 text-white","bg-indigo-500 text-white"];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map((l,d)=>{const o=g.find(i=>i.grading_period_id===l.gradingPeriodId),c=r[d%r.length];return e.jsxs("div",{className:`${c} rounded-lg p-4 text-center`,children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:o?o.grade:"-"}),e.jsx("div",{className:"text-sm opacity-90",children:l.name})]},l.id)})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 text-center min-w-48",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:n>0?n.toFixed(2):"-"}),e.jsx("div",{className:"text-gray-600 mb-2",children:"Overall Average"}),n>0&&e.jsx(w,{className:`${["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(a)?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:a})]})})]})}else return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-gray-500",children:"No grades recorded yet"})]})})()})]}),e.jsxs(v,{className:"bg-white shadow-sm",children:[e.jsx(_,{children:e.jsxs(A,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(P,{className:"h-5 w-5 text-gray-600"}),"Detailed Grades"]})}),e.jsx(y,{children:g.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:(()=>{const s=["senior_highschool","college"].includes(h),n=u.reduce((t,r)=>t+r.periods.length,0);if(s&&n>0&&u.length>1)return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-900 text-white",children:[e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Student ID"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Subject"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Faculty"}),u.map(t=>e.jsx("th",{className:"text-center p-2 border-r border-gray-600",colSpan:t.periods.length,children:t.name},t.semesterNumber)),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"AVERAGE"}),e.jsx("th",{className:"p-2",rowSpan:2,children:"Grade Status"})]}),e.jsx("tr",{className:"bg-gray-800 text-white",children:u.flatMap(t=>t.periods.map(r=>e.jsx("th",{className:"text-center p-2 border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)))})]});{const t=u.flatMap(r=>r.periods);return e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Student ID"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Subject"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Faculty"}),t.map(r=>e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)),e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:"AVERAGE"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Grade Status"})]})}})()}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b bg-white hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-r border-gray-200 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-gray-400"}),f.student_number||f.id]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:j.name}),e.jsx("div",{className:"text-sm text-gray-500",children:j.code})]})]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("div",{className:"text-sm text-gray-600",children:k.name})]})}),u.flatMap(n=>n.periods).map(n=>{const a=g.find(t=>t.grading_period_id===n.gradingPeriodId);return e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:a?e.jsx(w,{className:I(a.grade,h),children:a.grade}):e.jsx("span",{className:"text-gray-400",children:"-"})},n.id)}),e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:b?e.jsx(w,{className:`text-lg px-3 py-1 ${I(b,h)}`,children:b.toFixed(2)}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-3 text-center",children:b?(()=>{const s=B(b,h);return e.jsx(w,{className:`${["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(s)?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:s})})():e.jsx("span",{className:"text-gray-400",children:"No Grade"})})]})})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-gray-500",children:"No grade history available"})]})})]})]}),e.jsx(v,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(G,{href:route("teacher.grades.create",{student_id:f.id,subject_id:j.id,academic_level_id:S.id,academic_level_key:h,school_year:(N==null?void 0:N.school_year)||"2024-2025"}),className:"flex-1",children:e.jsxs(F,{className:"w-full",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Input New Grade"]})}),N&&e.jsx(G,{href:route("teacher.grades.edit",N.id),className:"flex-1",children:e.jsxs(F,{variant:"outline",className:"w-full",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Edit Current Grade"]})})]})})})]})})]})]})}export{fe as default};
