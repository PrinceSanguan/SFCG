import{j as e,r as v,m as H,$ as b,C as V,S as $}from"./app-m3UQBMcP.js";import{H as I}from"./header-DW8njRQZ.js";import{S as O}from"./sidebar-DEsw5ksw.js";import{C as w,b as y,c as C,a as S}from"./card-Cb3vhp8k.js";import{B as r}from"./button-DufCHHPz.js";import{S as U,a as X,b as Y,c as q,d as _}from"./select-D08EJ6rm.js";import{T as G}from"./textarea-wOaWI9lX.js";import{L as J}from"./label-Dbl2zI4H.js";import{A as K}from"./arrow-left-Bixw1jjw.js";import{F as M}from"./filter--3TVBQYG.js";import{C as F}from"./clock-Zffm0h4t.js";import{E as Q}from"./eye-Bvk7wluj.js";import{C as W}from"./circle-x-NWPeymbG.js";/* empty css            */import"./dropdown-menu-BKqTm_Lw.js";import"./Combination-1fZyme7-.js";import"./index-BWILvfpH.js";import"./separator-BItFfQZ1.js";import"./user-check-Bsn27bL7.js";import"./graduation-cap-CDEpafuX.js";import"./chevron-right-BZxMwjV4.js";import"./book-open-C3JW_-nm.js";import"./award-ClxfNlGh.js";import"./chart-no-axes-column-increasing-CczMTEXd.js";import"./trending-up-DJz-ds9H.js";import"./building-2-j31ddYn5.js";import"./log-out-D3daJ2dm.js";import"./index-B2WO6HMh.js";import"./index-DzDddJKI.js";import"./check-iTPGTtBJ.js";function Re({user:n,finalAverages:k,academicLevels:R,selectedAcademicLevel:L}){var j,p;if(!n)return e.jsx("div",{children:"Loading..."});const i=k||{data:[],total:0},A=R||[],z=s=>{const a=new URLSearchParams(window.location.search);s==="all"?a.delete("academic_level_id"):a.set("academic_level_id",s),$.get(window.location.pathname,Object.fromEntries(a),{preserveState:!0,preserveScroll:!0})},[t,c]=v.useState(null),[E,d]=v.useState(!1),{data:m,setData:o,post:x,processing:l,errors:h}=H({return_reason:""}),P=s=>{x(route("chairperson.final-averages.approve",s))},B=s=>{m.return_reason.trim()&&(x(route("chairperson.final-averages.return",s)),d(!1),c(null),o("return_reason",""))},T=s=>{c(s),d(!0)},D=()=>{d(!1),c(null),o("return_reason","")};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(O,{user:n}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(I,{user:n}),e.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-6",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(b,{href:route("chairperson.final-averages.index"),children:[e.jsx(K,{className:"h-4 w-4"}),"Back to Final Averages"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Pending Final Averages"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Review and approve final average grades submitted for validation"})]})]}),e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Filter by Academic Level"]})}),e.jsx(S,{children:e.jsxs(U,{value:L||"all",onValueChange:z,children:[e.jsx(X,{className:"w-full md:w-64",children:e.jsx(Y,{placeholder:"Select academic level"})}),e.jsxs(q,{children:[e.jsx(_,{value:"all",children:"All Academic Levels"}),A.map(s=>e.jsx(_,{value:s.id.toString(),children:s.name},s.id))]})]})})]}),e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Pending Final Averages (",i.total," total)"]})}),e.jsx(S,{children:i.data.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No pending final averages found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2 font-medium",children:"Student"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Subject"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Academic Level"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Final Average"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"School Year"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Submitted"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:i.data.map(s=>{var a,u,g,f,N;return e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(a=s.student)==null?void 0:a.name}),((u=s.student)==null?void 0:u.student_number)&&e.jsx("div",{className:"text-sm text-gray-500",children:s.student.student_number})]})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(g=s.subject)==null?void 0:g.name}),((f=s.subject)==null?void 0:f.code)&&e.jsx("div",{className:"text-sm text-gray-500",children:s.subject.code})]})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:"text-sm",children:(N=s.academic_level)==null?void 0:N.name})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:"font-medium text-lg",children:s.grade})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:"text-sm",children:s.school_year})}),e.jsx("td",{className:"p-2",children:s.submitted_at?e.jsx("span",{className:"text-sm text-gray-600",children:new Date(s.submitted_at).toLocaleDateString()}):e.jsx("span",{className:"text-sm text-gray-400",children:"Not specified"})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{asChild:!0,size:"sm",variant:"outline",children:e.jsx(b,{href:route("chairperson.final-averages.review",s.id),children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsx(r,{size:"sm",onClick:()=>P(s.id),disabled:l,className:"bg-green-600 hover:bg-green-700",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(r,{size:"sm",variant:"destructive",onClick:()=>T(s),disabled:l,children:e.jsx(W,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]})]})})]}),E&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Return Final Average for Correction"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Returning final average for ",e.jsx("strong",{children:(j=t.student)==null?void 0:j.name})," in ",e.jsx("strong",{children:(p=t.subject)==null?void 0:p.name})]}),e.jsx(J,{htmlFor:"return_reason",children:"Reason for Return"}),e.jsx(G,{id:"return_reason",value:m.return_reason,onChange:s=>o("return_reason",s.target.value),placeholder:"Please provide a reason for returning this final average...",className:"mt-2",rows:4}),h.return_reason&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:h.return_reason})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(r,{variant:"outline",onClick:D,children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:()=>B(t.id),disabled:l||!m.return_reason.trim(),children:l?"Returning...":"Return Final Average"})]})]})})]})}export{Re as default};
