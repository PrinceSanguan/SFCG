import{m as W,R as b,r as X,K as Z,j as e,$ as C,S as I}from"./app-w6UKKIRw.js";import{H as Y}from"./header-kzit2aA-.js";import{S as U}from"./sidebar-DLrd8e74.js";import{C as v,b as y,c as f,a as g}from"./card-C4aU-ovT.js";import{B as ee}from"./badge-Bf-9xS07.js";import{B as j}from"./button-BdecfLT_.js";import{I as m}from"./input-D7FUcfGy.js";import{L as d}from"./label-CncRWiNf.js";import{S as h,a as x,b as p,c as u,d as o}from"./select-BbGK6kqL.js";import{A as t,a as s}from"./alert-EV5Xr8PV.js";import{P as ie}from"./PasswordResetModal-CLDybLyR.js";import{A as ne}from"./arrow-left-DirdOxoK.js";import{S as ae}from"./save-BSs3koH9.js";import{R as ce}from"./rotate-ccw-Dl88HxOP.js";/* empty css            */import"./dropdown-menu-DT3F9uip.js";import"./Combination-BIIrEM-y.js";import"./index-BZPT5iMQ.js";import"./separator-ChfTvI0w.js";import"./users-Bo0h2dkE.js";import"./chevron-right-BmudDo6n.js";import"./crown-BuuUsIew.js";import"./building-2-CepzG4r7.js";import"./user-cog-BQsEH12E.js";import"./book-open-C0H8VTux.js";import"./user-check-Dq2k0Ola.js";import"./graduation-cap-DmonlEIL.js";import"./notebook-BwzsZdEY.js";import"./chart-no-axes-column-increasing-DTSDQYn6.js";import"./shield-BJh9AMdb.js";import"./index-DlA5K4UQ.js";import"./index-DNI0Umjv.js";import"./check-Bcss7Xul.js";import"./dialog-DVGlh09J.js";import"./eye-C7GyexgV.js";function Ie({user:r,targetUser:n,roles:O,errors:a,yearLevels:w,specificYearLevels:S,strands:E,courses:F,departments:k}){var V,B,H,M;const{data:c,setData:l,put:q,processing:R}=W({name:(n==null?void 0:n.name)||"",email:(n==null?void 0:n.email)||"",user_role:(n==null?void 0:n.user_role)||"",academic_level:(n==null?void 0:n.year_level)||"",specific_year_level:(n==null?void 0:n.specific_year_level)||"",strand_id:((V=n==null?void 0:n.strand_id)==null?void 0:V.toString())||"",course_id:((B=n==null?void 0:n.course_id)==null?void 0:B.toString())||"",department_id:((H=n==null?void 0:n.department_id)==null?void 0:H.toString())||"",section_id:((M=n==null?void 0:n.section_id)==null?void 0:M.toString())||"",student_number:(n==null?void 0:n.student_number)||"",birth_date:(n==null?void 0:n.birth_date)||"",gender:(n==null?void 0:n.gender)||"",phone_number:(n==null?void 0:n.phone_number)||"",address:(n==null?void 0:n.address)||"",emergency_contact_name:(n==null?void 0:n.emergency_contact_name)||"",emergency_contact_phone:(n==null?void 0:n.emergency_contact_phone)||"",emergency_contact_relationship:(n==null?void 0:n.emergency_contact_relationship)||""}),[A,N]=b.useState([]),[P,L]=b.useState(!1),[T,D]=X.useState(!1),{errors:G}=Z().props;if(!r||!n)return e.jsx("div",{children:"Loading..."});b.useEffect(()=>{const i={};if(!c.academic_level){N([]);return}c.academic_level&&(i.academic_level_key=c.academic_level),c.specific_year_level&&(i.specific_year_level=c.specific_year_level),c.strand_id&&(i.strand_id=c.strand_id.toString()),c.department_id&&(i.department_id=c.department_id.toString()),c.course_id&&(i.course_id=c.course_id.toString());const _=new URLSearchParams(i).toString();L(!0),fetch(route("admin.academic.api.sections")+(_?`?${_}`:"")).then(async $=>{if(!$.ok)throw new Error("Failed to load sections");const Q=await $.json();N(Q||[])}).catch(()=>N([])).finally(()=>L(!1))},[c.academic_level,c.specific_year_level,c.strand_id,c.department_id,c.course_id]);const J=i=>{i.preventDefault(),q(route("admin.students.update",n.id))},z=()=>{D(!0)},K=i=>{switch(i){case"admin":return"default";case"registrar":case"teacher":case"instructor":case"adviser":case"chairperson":case"principal":return"secondary";case"student":case"parent":return"outline";default:return"outline"}};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(U,{user:r}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Y,{user:r}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{href:route("admin.students.index"),children:e.jsxs(j,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Back to Students"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Edit Student"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Update student information and role assignments."})]})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(f,{children:"Current Student Information"})}),e.jsx(g,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx("p",{className:"text-lg",children:n.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"text-lg",children:n.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Current Role"}),e.jsx(ee,{variant:K(n.user_role),className:"mt-1",children:O[n.user_role]||n.user_role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Member Since"}),e.jsx("p",{className:"text-lg",children:new Date(n.created_at).toLocaleDateString()})]})]})})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(f,{children:"Update Student Information"})}),e.jsx(g,{children:e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Full Name *"}),e.jsx(m,{id:"name",type:"text",value:c.name,onChange:i=>l("name",i.target.value),placeholder:"Enter full name",required:!0}),(a==null?void 0:a.name)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email Address *"}),e.jsx(m,{id:"email",type:"email",value:c.email,onChange:i=>l("email",i.target.value),placeholder:"Enter email address",required:!0}),(a==null?void 0:a.email)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.email})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"academic_level",children:"Academic Level *"}),e.jsxs(h,{value:c.academic_level,onValueChange:i=>{l("academic_level",i),l("specific_year_level",""),l("strand_id",""),l("course_id",""),l("department_id",""),l("section_id","")},children:[e.jsx(x,{children:e.jsx(p,{placeholder:"Select academic level"})}),e.jsx(u,{children:(w||{elementary:"Elementary",junior_highschool:"Junior High School",senior_highschool:"Senior High School",college:"College"})&&Object.entries(w||{elementary:"Elementary",junior_highschool:"Junior High School",senior_highschool:"Senior High School",college:"College"}).map(([i,_])=>e.jsx(o,{value:i,children:_},i))})]}),(a==null?void 0:a.academic_level)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.academic_level})})]}),c.academic_level&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"specific_year_level",children:"Year Level *"}),e.jsxs(h,{value:c.specific_year_level,onValueChange:i=>{l("specific_year_level",i),l("section_id","")},children:[e.jsx(x,{children:e.jsx(p,{placeholder:"Select year level"})}),e.jsx(u,{children:S&&S[c.academic_level]&&Object.entries(S[c.academic_level]).map(([i,_])=>e.jsx(o,{value:i,children:_},i))})]}),(a==null?void 0:a.specific_year_level)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.specific_year_level})})]}),c.academic_level==="senior_highschool"&&c.specific_year_level&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"strand_id",children:"Strand *"}),e.jsxs(h,{value:c.strand_id,onValueChange:i=>{l("strand_id",i),l("section_id","")},children:[e.jsx(x,{children:e.jsx(p,{placeholder:"Select a strand"})}),e.jsx(u,{children:E&&E.map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")",i.track?` - ${i.track.name}`:""]},i.id))})]}),(a==null?void 0:a.strand_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.strand_id})})]}),c.academic_level==="college"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"department_id",children:"Department *"}),e.jsxs(h,{value:c.department_id,onValueChange:i=>{l("department_id",i),l("course_id",""),l("section_id","")},children:[e.jsx(x,{children:e.jsx(p,{placeholder:"Select a department"})}),e.jsx(u,{children:k&&k.filter(i=>i.academic_level_id===4).map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")"]},i.id))})]}),(a==null?void 0:a.department_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.department_id})})]}),c.academic_level==="college"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"course_id",children:"Course *"}),e.jsxs(h,{value:c.course_id,onValueChange:i=>{l("course_id",i),l("section_id","")},disabled:!c.department_id,children:[e.jsx(x,{children:e.jsx(p,{placeholder:c.department_id?"Select a course":"Select department first"})}),e.jsx(u,{children:F&&F.filter(i=>!c.department_id||i.department_id.toString()===c.department_id).map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")"]},i.id))})]}),(a==null?void 0:a.course_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.course_id})})]}),c.academic_level&&e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"section_id",children:"Section *"}),e.jsxs(h,{value:c.section_id,onValueChange:i=>l("section_id",i),disabled:P||!c.specific_year_level&&c.academic_level!=="college",children:[e.jsx(x,{children:e.jsx(p,{placeholder:P?"Loading sections...":A.length?"Select a section":"No sections available"})}),e.jsx(u,{children:A.map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name,i.code?` (${i.code})`:"",typeof i.max_students=="number"&&typeof i.current_students=="number"?` • ${i.current_students}/${i.max_students}`:""]},i.id))})]}),(a==null?void 0:a.section_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.section_id})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"student_number",children:"Student Number"}),e.jsx(m,{id:"student_number",type:"text",value:c.student_number,onChange:i=>l("student_number",i.target.value),placeholder:"e.g. EL-2025-000123"}),(a==null?void 0:a.student_number)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.student_number})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Last Login"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded border dark:bg-gray-800",children:n.last_login_at?new Date(n.last_login_at).toLocaleString():"Never logged in"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"birth_date",children:"Birth Date"}),e.jsx(m,{id:"birth_date",type:"date",value:c.birth_date,onChange:i=>l("birth_date",i.target.value)}),(a==null?void 0:a.birth_date)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.birth_date})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"gender",children:"Gender"}),e.jsxs(h,{value:c.gender,onValueChange:i=>l("gender",i),children:[e.jsx(x,{children:e.jsx(p,{placeholder:"Select gender"})}),e.jsxs(u,{children:[e.jsx(o,{value:"male",children:"Male"}),e.jsx(o,{value:"female",children:"Female"}),e.jsx(o,{value:"other",children:"Other"})]})]}),(a==null?void 0:a.gender)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.gender})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(m,{id:"phone_number",type:"tel",value:c.phone_number,onChange:i=>l("phone_number",i.target.value),placeholder:"Enter phone number"}),(a==null?void 0:a.phone_number)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.phone_number})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"address",children:"Address"}),e.jsx(m,{id:"address",type:"text",value:c.address,onChange:i=>l("address",i.target.value),placeholder:"Enter complete address"}),(a==null?void 0:a.address)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.address})})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"emergency_contact_name",children:"Emergency Contact Name"}),e.jsx(m,{id:"emergency_contact_name",type:"text",value:c.emergency_contact_name,onChange:i=>l("emergency_contact_name",i.target.value),placeholder:"Enter emergency contact name"}),(a==null?void 0:a.emergency_contact_name)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"emergency_contact_phone",children:"Emergency Contact Phone"}),e.jsx(m,{id:"emergency_contact_phone",type:"tel",value:c.emergency_contact_phone,onChange:i=>l("emergency_contact_phone",i.target.value),placeholder:"Enter emergency contact phone"}),(a==null?void 0:a.emergency_contact_phone)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_phone})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"emergency_contact_relationship",children:"Relationship"}),e.jsx(m,{id:"emergency_contact_relationship",type:"text",value:c.emergency_contact_relationship,onChange:i=>l("emergency_contact_relationship",i.target.value),placeholder:"e.g., Father, Mother, Guardian, etc."}),(a==null?void 0:a.emergency_contact_relationship)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_relationship})})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-6",children:[e.jsxs(j,{type:"submit",disabled:R,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),R?"Updating...":"Update Student"]}),e.jsx(C,{href:route("admin.students.index"),children:e.jsx(j,{type:"button",variant:"outline",children:"Cancel"})})]})]})})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(f,{children:"Password Management"})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Reset the student's password to allow them to regain access to their account. A new temporary password will be generated."}),e.jsxs(j,{onClick:z,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Reset Password"]})]})})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(f,{children:"Additional Actions"})}),e.jsx(g,{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(C,{href:route("admin.students.show",n.id),children:e.jsx(j,{variant:"outline",children:"View Full Profile"})}),n.id!==r.id&&e.jsx(j,{variant:"destructive",onClick:()=>{confirm("Are you sure you want to delete this student? This action cannot be undone.")&&I.delete(route("admin.students.destroy",n.id),{onSuccess:()=>{I.visit(route("admin.students.index"))},onError:i=>{console.error("Delete failed:",i)}})},children:"Delete Student"})]})})]})]})})]}),e.jsx(ie,{user:n,isOpen:T,onClose:()=>D(!1),errors:G})]})}export{Ie as default};
