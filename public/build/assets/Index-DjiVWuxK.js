import{c as B,r as E,j as e,L as F,$ as j,C as w}from"./app-CTaF9v4Y.js";import{S as M,H as R}from"./sidebar-CGwNHzPC.js";import{C as r,b as l,c as i,a as c,d as x}from"./card-BcMAGN6f.js";import{B as d}from"./button-pPGc82xo.js";import{B as n}from"./badge-BHiMlp7H.js";import{T as O,a as q,b as u,c as p}from"./tabs-BeVpoKzn.js";import{A as _}from"./activity-C0LQTvY4.js";import{U as g}from"./users-CoZ_zKD8.js";import{S as k}from"./shield-DDAgXI2E.js";import{C as U}from"./clock-CLU9Egzc.js";import{D as V}from"./download-DrWIhP1E.js";import{T as X}from"./trash-2-g40T8Dlv.js";import{T as C}from"./triangle-alert-5uwme7m7.js";import{E as $}from"./eye-Dcx80SH2.js";/* empty css            */import"./dropdown-menu-BxH7pFUv.js";import"./index-BGgeSyzs.js";import"./separator-Bnbnu273.js";import"./user-cog-DEnbeZTB.js";import"./graduation-cap-BJKFe2Uu.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],A=B("CircleX",H);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],f=B("Database",K);function me({user:N,recentActivities:y,sessionStats:o,securityStats:a,backupInfo:m}){const[h,v]=E.useState(!1),b=async()=>{var s;v(!0);try{await fetch(route("admin.security.create-backup"),{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),window.location.reload()}catch(t){console.error("Failed to create backup:",t)}finally{v(!1)}},T=s=>{window.open(route("admin.security.download-backup",{filename:s}),"_blank")},z=async s=>{var t;if(confirm(`Are you sure you want to delete backup: ${s}?`))try{await fetch(route("admin.security.delete-backup",{filename:s}),{method:"DELETE",headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}}),window.location.reload()}catch(S){console.error("Failed to delete backup:",S)}},D=s=>({login:"bg-green-100 text-green-800",logout:"bg-gray-100 text-gray-800",failed_login:"bg-red-100 text-red-800",unauthorized_admin_access:"bg-red-100 text-red-800",reset_password:"bg-blue-100 text-blue-800",create_backup:"bg-purple-100 text-purple-800",download_backup:"bg-blue-100 text-blue-800",delete_backup:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",L=s=>new Date(s).toLocaleString();return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(M,{user:N}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(R,{user:N}),e.jsxs("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:[e.jsx(F,{title:"System Audit & Security"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"System Audit & Security"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Monitor system activity, manage login sessions, and perform data backups"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{href:route("admin.security.activity-logs"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"View All Logs"]})}),e.jsx(j,{href:route("admin.security.login-sessions"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Manage Sessions"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.active_sessions}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.total_sessions," total sessions"]})]})]}),e.jsxs(r,{children:[e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Today's Logins"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.today_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_logins," total logins"]})]})]}),e.jsxs(r,{children:[e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.total_failed_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_unauthorized_access," unauthorized attempts"]})]})]}),e.jsxs(r,{children:[e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Database Backups"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.total_backups}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.total_size_formatted," total size"]})]})]})]}),e.jsxs(O,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(q,{className:"grid w-full grid-cols-4",children:[e.jsx(u,{value:"overview",children:"Overview"}),e.jsx(u,{value:"recent-activity",children:"Recent Activity"}),e.jsx(u,{value:"backups",children:"Backup Management"}),e.jsx(u,{value:"security",children:"Security Status"})]}),e.jsx(p,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"Session Overview"]}),e.jsx(x,{children:"Current login session statistics"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Sessions"}),e.jsx(n,{variant:"secondary",children:o.total_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Sessions"}),e.jsx(n,{variant:"default",children:o.active_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unique Users"}),e.jsx(n,{variant:"outline",children:o.unique_users})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Inactive Sessions"}),e.jsx(n,{variant:"destructive",children:o.inactive_sessions})]})]})]}),e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Security Overview"]}),e.jsx(x,{children:"System security statistics"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Logins"}),e.jsx(n,{variant:"default",children:a.total_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Failed Logins"}),e.jsx(n,{variant:"destructive",children:a.total_failed_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unauthorized Access"}),e.jsx(n,{variant:"destructive",children:a.total_unauthorized_access})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Password Resets"}),e.jsx(n,{variant:"outline",children:a.total_password_resets})]})]})]})]})}),e.jsx(p,{value:"recent-activity",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Recent System Activity"]}),e.jsx(x,{children:"Latest system events and user actions"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:y.length>0?y.map(s=>{var t;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:D(s.action),children:s.action.replace("_"," ")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((t=s.user)==null?void 0:t.name)||"System"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.entity_type," â€¢ ",s.ip_address]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm text-gray-500",children:L(s.created_at)})})]},s.id)}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent activity found"})})})]})}),e.jsx(p,{value:"backups",className:"space-y-6",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5"}),"Database Backup Management"]}),e.jsx(x,{children:"Create, download, and manage database backups"})]}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Create New Backup"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Generate a new database backup"})]}),e.jsx(d,{onClick:b,disabled:h,className:"bg-blue-600 hover:bg-blue-700",children:h?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Create Backup"]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4",children:"Available Backups"}),m.backups.length>0?e.jsx("div",{className:"space-y-3",children:m.backups.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.filename}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.size_formatted," â€¢ ",s.created_at]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>T(s.filename),children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Download"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>z(s.filename),className:"text-red-600 hover:text-red-700",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]},t))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No backups available"})]})]})]})}),e.jsx(p,{value:"security",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-yellow-600"}),"Security Alerts"]}),e.jsx(x,{children:"Recent security events and warnings"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[a.total_failed_logins>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx(C,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_failed_logins," failed login attempts detected"]})]}),a.total_unauthorized_access>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx(A,{className:"w-4 h-4 text-red-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_unauthorized_access," unauthorized access attempts"]})]}),a.total_failed_logins===0&&a.total_unauthorized_access===0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[e.jsx(w,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:"No security alerts - system is secure"})]})]})})]}),e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Quick Actions"]}),e.jsx(x,{children:"Common security management tasks"})]}),e.jsxs(c,{className:"space-y-3",children:[e.jsx(j,{href:route("admin.security.activity-logs"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"View Activity Logs"]})}),e.jsx(j,{href:route("admin.security.login-sessions"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Manage Login Sessions"]})}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:b,disabled:h,children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),h?"Creating Backup...":"Create Database Backup"]})]})]})]})})]})]})]})]})]})}export{me as default};
