import{m as $,r as D,j as e,$ as b}from"./app-CRB7Vkow.js";import{S as T,H as z}from"./sidebar-C8Apuk57.js";import{C as E,b as F,c as H,a as A}from"./card-B3X3XlfX.js";import{B as u}from"./button-Cg4mH40A.js";import{I as v}from"./input-v05ZLmeZ.js";import{L as i}from"./label-DkvBXY46.js";import{S as j,a as _,b as p,c as f,d as o}from"./select-DDBDqe2r.js";import{A as M}from"./arrow-left-DcYoUJKG.js";import{P as J}from"./plus-S1cpMdsE.js";import{S as P}from"./save-C1g-Khxk.js";/* empty css            */import"./dropdown-menu-C-HXr_Hi.js";import"./Combination-CAawp2Lb.js";import"./index-9EEPBnTe.js";import"./user-CTqdoXY9.js";import"./log-out-lSBE1jwT.js";import"./book-open-DnXSirf0.js";import"./graduation-cap-BGaNdPc5.js";import"./upload-CFyRHiah.js";import"./crown-BDavmclC.js";import"./index-SyVjcTXi.js";import"./index-XV-t6QwA.js";function pe({user:N,academicLevels:m,gradingPeriods:S,assignedSubjects:g,selectedStudent:x}){var C,k,L,G;const{data:t,setData:r,post:V,processing:y,errors:d}=$({student_id:"",subject_id:"",academic_level_id:"",grading_period_id:"0",school_year:"2024-2025",year_of_study:"",grade:""});D.useEffect(()=>{var I;const s=new URLSearchParams(window.location.search),a=s.get("student_id"),c=s.get("subject_id"),n=s.get("academic_level_id"),U=s.get("academic_level_key"),q=s.get("school_year");if(a&&c&&n){r("student_id",a),r("subject_id",c),r("academic_level_id",n),r("school_year",q||"2024-2025"),r("year_of_study",""),r("grade",""),U&&m.find(R=>R.id.toString()===n)&&r("academic_level_id",n);const B=window.location.pathname;window.history.replaceState({},"",B)}else x&&(r("student_id",x.id.toString()),r("subject_id",((I=x.subjectId)==null?void 0:I.toString())||""),r("academic_level_id",x.academicLevelKey||""),r("school_year","2024-2025"),r("year_of_study",""),r("grade",""))},[x,r]);const Y=s=>{if(!s)return null;for(const a of g)if(a.enrolled_students.find(n=>n.student.id.toString()===s))return{subjectId:a.subject.id,academicLevelId:a.academicLevel.id,academicLevelKey:a.academicLevel.key,schoolYear:a.school_year};return null},K=s=>{if(r("student_id",s),s){const a=Y(s);a&&(r("subject_id",a.subjectId.toString()),r("academic_level_id",a.academicLevelId.toString()),r("school_year",a.schoolYear))}else r("subject_id",""),r("academic_level_id",""),r("grade","")},l=()=>{var s;if(t.academic_level_id){const a=m.find(n=>n.id.toString()===t.academic_level_id);console.log("Selected Academic Level:",a),console.log("Level Key:",a==null?void 0:a.key),console.log("Level Name:",a==null?void 0:a.name);const c=(a==null?void 0:a.key)==="college"||((s=a==null?void 0:a.name)==null?void 0:s.toLowerCase().includes("college"));return console.log("Is College Level:",c),c?"college":(a==null?void 0:a.key)||"elementary"}return"elementary"},w=s=>{s.preventDefault(),console.log("Form submitted with data:",t),console.log("Has pre-selected student:",h),V(route("instructor.grades.store"),{onSuccess:()=>{console.log("Grade created successfully")},onError:a=>{console.log("Grade creation failed:",a)}})},h=t.student_id&&t.subject_id&&t.academic_level_id;return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(T,{user:N}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(z,{user:N}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{href:route("instructor.grades.index"),children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:h?"Input Grade":"Input New Grade"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:h?"Enter a grade for the selected student.":"Enter a new grade for a student in your assigned course."})]})]})}),e.jsxs(E,{className:"max-w-2xl",children:[e.jsx(F,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Grade Information"]})}),e.jsx(A,{children:h?e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Student:"}),e.jsx("p",{className:"font-medium",children:((k=(C=g.find(s=>s.enrolled_students.some(a=>a.student.id.toString()===t.student_id)))==null?void 0:C.enrolled_students.find(s=>s.student.id.toString()===t.student_id))==null?void 0:k.student.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Subject:"}),e.jsx("p",{className:"font-medium",children:((L=g.find(s=>s.subject.id.toString()===t.subject_id))==null?void 0:L.subject.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Academic Level:"}),e.jsx("p",{className:"font-medium",children:((G=m.find(s=>s.id.toString()===t.academic_level_id))==null?void 0:G.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"School Year:"}),e.jsx("p",{className:"font-medium",children:t.school_year})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(v,{id:"grade",type:"number",step:l()==="college"?"0.1":"0.01",min:l()==="college"?"1.0":"75",max:l()==="college"?"5.0":"100",placeholder:l()==="college"?"Enter grade (1.0-5.0)":"Enter grade (75-100)",value:t.grade,onChange:s=>r("grade",s.target.value),className:d.grade?"border-red-500":"",autoFocus:!0}),d.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l()==="college"?"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75).":"Elementary to Senior High: 75 (passing) to 100 (highest)."})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(j,{value:t.grading_period_id,onValueChange:s=>r("grading_period_id",s),children:[e.jsx(_,{className:d.grading_period_id?"border-red-500":"",children:e.jsx(p,{placeholder:"Select grading period"})}),e.jsx(f,{children:S.filter(s=>{const a=m.find(c=>c.id.toString()===t.academic_level_id);return a?s.academic_level_id===a.id:!0}).map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))})]}),d.grading_period_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.grading_period_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select which grading period this grade belongs to"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(u,{type:"submit",disabled:y,className:"flex-1",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Save Grade"]}),e.jsx(b,{href:route("instructor.grades.index"),className:"flex-1",children:e.jsx(u,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]}):e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"student_id",children:"Student"}),e.jsxs(j,{value:t.student_id,onValueChange:K,children:[e.jsx(_,{className:d.student_id?"border-red-500":"",children:e.jsx(p,{placeholder:"Select a student"})}),e.jsx(f,{children:g.flatMap(s=>s.enrolled_students.map(a=>e.jsxs(o,{value:a.student.id.toString(),children:[a.student.name," - ",s.subject.name]},a.student.id)))})]}),d.student_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.student_id}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select a student from your assigned subjects"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(j,{value:t.subject_id,onValueChange:s=>r("subject_id",s),children:[e.jsx(_,{className:d.subject_id?"border-red-500":"",children:e.jsx(p,{placeholder:"Select a subject"})}),e.jsx(f,{children:g.map(s=>e.jsxs(o,{value:s.subject.id.toString(),children:[s.subject.name," (",s.subject.code,")",s.subject.course&&` - ${s.subject.course.name}`]},s.subject.id))})]}),d.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(j,{value:t.academic_level_id,onValueChange:s=>r("academic_level_id",s),children:[e.jsx(_,{className:d.academic_level_id?"border-red-500":"",children:e.jsx(p,{placeholder:"Select academic level"})}),e.jsx(f,{children:m.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))})]}),d.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(j,{value:t.grading_period_id,onValueChange:s=>r("grading_period_id",s),children:[e.jsx(_,{children:e.jsx(p,{placeholder:"Select grading period (optional)"})}),e.jsxs(f,{children:[e.jsx(o,{value:"0",children:"No Period"}),S.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"school_year",children:"School Year"}),e.jsx(v,{id:"school_year",type:"text",placeholder:"e.g., 2024-2025",value:t.school_year,onChange:s=>r("school_year",s.target.value),className:d.school_year?"border-red-500":""}),d.school_year&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.school_year})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"year_of_study",children:"Year of Study"}),e.jsx(v,{id:"year_of_study",type:"number",min:"1",max:"10",placeholder:"e.g., 1, 2, 3, 4",value:t.year_of_study,onChange:s=>r("year_of_study",s.target.value),className:d.year_of_study?"border-red-500":""}),d.year_of_study&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.year_of_study}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required for college level"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(v,{id:"grade",type:"number",step:l()==="college"?"0.1":"0.01",min:l()==="college"?"1.0":"75",max:l()==="college"?"5.0":"100",placeholder:l()==="college"?"Enter grade (1.0-5.0)":"Enter grade (75-100)",value:t.grade,onChange:s=>r("grade",s.target.value),className:d.grade?"border-red-500":""}),d.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.grade}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l()==="college"?"College: 1.0 (highest) to 5.0 (lowest). 3.0 is passing (equivalent to 75).":"Elementary to Senior High: 75 (passing) to 100 (highest)."})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(u,{type:"submit",disabled:y,className:"flex-1",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Save Grade"]}),e.jsx(b,{href:route("instructor.grades.index"),className:"flex-1",children:e.jsx(u,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]})})]}),e.jsxs(E,{children:[e.jsx(F,{children:e.jsx(H,{children:"Help & Guidelines"})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Student:"})," Select a student from your assigned subjects"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Subject:"})," Automatically populated when student is selected"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Grade Scale:"})," College uses 1.0-5.0 scale (1.0 highest, 3.0 passing), Elementary/Senior High uses 75-100 scale (75 passing)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Validation:"})," Grades are automatically submitted for validation after saving"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Editing:"})," You can edit grades before they are validated by the registrar"]})]})})]})]})})]})]})}export{pe as default};
