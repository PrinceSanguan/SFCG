import{r as S,R as se,m as ae,j as e,S as G}from"./app-v9U1YPQ3.js";import{S as re,H as le}from"./sidebar-D15kuwcz.js";import{C as R,b as A,c as F,a as M}from"./card-B8UUiW7U.js";import{B as m}from"./button-DIMs9AgK.js";import{I as h}from"./input-Ck6nZuW_.js";import{L as l}from"./label-CCfchDt1.js";import{S as j,a as u,b as p,c as _,d as v}from"./select-CScH7fXN.js";import{C as ne}from"./checkbox-2deC_368.js";import{B as C}from"./badge-BdxuPfHU.js";import{T as ie,a as de,b as O,c as H,d as te,e as T}from"./table-ChdxZEep.js";import{T as ce,a as oe,b as k,c as me}from"./tabs-DdalyEqX.js";import{A as he,a as xe}from"./alert-5VBxshsM.js";import{A as ge}from"./arrow-left-CFr1yywk.js";import{T as E}from"./trophy-YHScFYc2.js";import{G as je}from"./graduation-cap-MYSQqGw0.js";/* empty css            */import"./dropdown-menu-DUPZeYGP.js";import"./Combination-BI_ajKc_.js";import"./index-DYzn5GD6.js";import"./separator-vjQLCvbw.js";import"./users-9k6aawrb.js";import"./user-cog-1LM8klWw.js";import"./book-open-BoOs-nZ8.js";import"./index-DI7HYQVr.js";function Ie({user:q,academicLevels:r,honorTypes:y,criteria:$,schoolYears:t,groupedHonorResults:J}){const[c,P]=S.useState(null),[x,Q]=S.useState(()=>"2024-2025"),[f,V]=S.useState(!1),[b,o]=S.useState(null);se.useEffect(()=>{if(r&&r.length>0){const s=r[0].id;P(s)}},[r]);const{data:n,setData:i,post:U,processing:K,errors:N,reset:W}=ae({academic_level_id:"",honor_type_id:"",school_year:x,min_gpa:"",max_gpa:"",min_grade:"",min_grade_all:"",min_year:"",max_year:"",require_consistent_honor:!1,additional_rules:""}),X=s=>{s.preventDefault(),U(route("admin.academic.honor-criteria.store"),{onSuccess:()=>{o({type:"success",text:"Honor criteria saved successfully!"}),W(),setTimeout(()=>o(null),3e3)},onError:()=>{o({type:"error",text:"Error saving honor criteria. Please try again."})}})},B=()=>{c&&(V(!0),G.post(route("admin.academic.generate-honor-roll"),{academic_level_id:c,school_year:x},{onSuccess:()=>{o({type:"success",text:"Honor roll generated successfully!"}),setTimeout(()=>o(null),3e3)},onError:()=>{o({type:"error",text:"Error generating honor roll. Please try again."})},onFinish:()=>V(!1)}))},Z=()=>{c&&G.get(route("admin.academic.export-honor-list"),{data:{academic_level_id:c,school_year:x}})},Y=s=>$.filter(a=>a.academic_level_id===s&&a.honorType&&a.academicLevel),ee=s=>{const a=s.toString();return J[a]||{}};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(re,{user:q}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(le,{user:q}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>G.get("/registrar/academic"),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Back to Academic Management"]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Honor Tracking & Ranking"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"View honor types and criteria for each academic level."})]}),b&&e.jsx(he,{className:b.type==="success"?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsx(xe,{className:b.type==="success"?"text-green-800":"text-red-800",children:b.text})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsx(A,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Set Honor Criteria"]})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"academic_level_id",children:"Academic Level"}),r&&r.length>0?e.jsxs(j,{value:n.academic_level_id,onValueChange:s=>i("academic_level_id",s),children:[e.jsx(u,{children:e.jsx(p,{placeholder:"Select level"})}),e.jsx(_,{children:r.map(s=>e.jsx(v,{value:s.id.toString(),children:s.name},s.id))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading academic levels..."}),N.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500",children:N.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"honor_type_id",children:"Honor Type"}),y&&y.length>0?e.jsxs(j,{value:n.honor_type_id,onValueChange:s=>i("honor_type_id",s),children:[e.jsx(u,{children:e.jsx(p,{placeholder:"Select honor"})}),e.jsx(_,{children:y.map(s=>e.jsx(v,{value:s.id.toString(),children:s.name},s.id))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading honor types..."}),N.honor_type_id&&e.jsx("p",{className:"text-sm text-red-500",children:N.honor_type_id})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"school_year",children:"School Year"}),e.jsxs(j,{value:n.school_year,onValueChange:s=>i("school_year",s),children:[e.jsx(u,{children:e.jsx(p,{placeholder:"Select school year"})}),e.jsx(_,{children:(t!=null&&t.length?t:["2024-2025"]).map(s=>e.jsx(v,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"min_gpa",children:"Min GPA"}),e.jsx(h,{id:"min_gpa",type:"number",step:"0.01",value:n.min_gpa,onChange:s=>i("min_gpa",s.target.value),placeholder:"e.g., 90.0"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"max_gpa",children:"Max GPA"}),e.jsx(h,{id:"max_gpa",type:"number",step:"0.01",value:n.max_gpa,onChange:s=>i("max_gpa",s.target.value),placeholder:"e.g., 97.0"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"min_grade",children:"Min Grade (any)"}),e.jsx(h,{id:"min_grade",type:"number",value:n.min_grade,onChange:s=>i("min_grade",s.target.value),placeholder:"e.g., 90"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"min_grade_all",children:"Min Grade (all)"}),e.jsx(h,{id:"min_grade_all",type:"number",value:n.min_grade_all,onChange:s=>i("min_grade_all",s.target.value),placeholder:"e.g., 93"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"min_year",children:"Min Year"}),e.jsx(h,{id:"min_year",type:"number",value:n.min_year,onChange:s=>i("min_year",s.target.value),placeholder:"e.g., 2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"max_year",children:"Max Year"}),e.jsx(h,{id:"max_year",type:"number",value:n.max_year,onChange:s=>i("max_year",s.target.value),placeholder:"e.g., 3"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{id:"require_consistent_honor",checked:!!n.require_consistent_honor,onCheckedChange:s=>i("require_consistent_honor",s)}),e.jsx(l,{htmlFor:"require_consistent_honor",children:"Require consistent honor standing"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{type:"submit",disabled:K,children:"Save Criteria"}),e.jsx(m,{type:"button",variant:"outline",onClick:B,disabled:f,children:f?"Generating...":"Generate Honor Roll"}),e.jsx(m,{type:"button",variant:"outline",onClick:Z,children:"Export Honor List"})]})]})})]}),e.jsxs(R,{children:[e.jsx(A,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Generate Honor Roll"]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),r&&r.length>0?e.jsxs(j,{value:c?c.toString():void 0,onValueChange:s=>P(Number(s)),children:[e.jsx(u,{children:e.jsx(p,{placeholder:"Select level to generate honor roll"})}),e.jsx(_,{children:r.map(s=>e.jsx(v,{value:s.id.toString(),children:s.name},s.id))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading academic levels..."})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),t&&t.length>0?e.jsxs(j,{value:x,onValueChange:Q,children:[e.jsx(u,{children:e.jsx(p,{placeholder:"Select school year"})}),e.jsx(_,{children:t.map(s=>e.jsx(v,{value:s,children:s},s))})]}):e.jsx("div",{className:"p-2 text-sm text-gray-500 bg-gray-100 rounded border",children:"Loading school years..."})]}),e.jsx(m,{onClick:B,disabled:!c||f,className:"w-full",children:f?"Generating...":"Generate Honor Roll"})]})]})]}),e.jsxs(R,{children:[e.jsx(A,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Existing Criteria"]})}),e.jsx(M,{children:e.jsxs(ce,{defaultValue:"elementary",className:"w-full",children:[e.jsxs(oe,{className:"grid w-full grid-cols-4",children:[e.jsx(k,{value:"elementary",children:"Elementary"}),e.jsx(k,{value:"junior_highschool",children:"Junior High"}),e.jsx(k,{value:"senior_highschool",children:"Senior High"}),e.jsx(k,{value:"college",children:"College"})]}),r&&r.length>0?r.map(s=>e.jsx(me,{value:s.key,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s.name," Honor Criteria"]}),e.jsx(m,{variant:"outline",size:"sm",children:"Refresh Results"})]}),e.jsx("div",{className:"grid gap-4",children:Y(s.id).map(a=>a.honorType?e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:a.honorType.name}),e.jsx(C,{variant:"secondary",children:a.honorType.scope})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[a.min_gpa&&e.jsxs("div",{children:["Min GPA: ",e.jsx("span",{className:"font-medium",children:a.min_gpa})]}),a.max_gpa&&e.jsxs("div",{children:["Max GPA: ",e.jsx("span",{className:"font-medium",children:a.max_gpa})]}),a.min_grade&&e.jsxs("div",{children:["Min Grade: ",e.jsx("span",{className:"font-medium",children:a.min_grade})]}),a.min_year&&a.max_year&&e.jsxs("div",{children:["Years: ",e.jsxs("span",{className:"font-medium",children:[a.min_year,"-",a.max_year]})]}),a.require_consistent_honor&&e.jsx("div",{className:"col-span-2",children:e.jsx(C,{variant:"outline",children:"Requires Consistent Honor"})})]})]},a.id):e.jsx("div",{className:"border rounded-lg p-4 bg-red-50",children:e.jsx("p",{className:"text-red-600 text-sm",children:"Invalid honor type data"})},a.id))}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-4",children:["Honor Roll Results - ",x]}),e.jsx("div",{className:"space-y-4",children:(()=>{const a=ee(s.id),I=Object.keys(a);return I.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No honor results found for this level and school year."}):I.map(w=>{const g=a[w],L=y.find(d=>d.id===Number(w));return!g||g.length===0||!L?null:e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(E,{className:"h-4 w-4 text-yellow-600"}),e.jsx("h5",{className:"font-medium",children:L.name}),e.jsxs(C,{variant:"secondary",children:[g.length," student",g.length!==1?"s":""]})]}),e.jsxs(ie,{children:[e.jsx(de,{children:e.jsxs(O,{children:[e.jsx(H,{children:"Student"}),e.jsx(H,{children:"Student ID"}),e.jsx(H,{children:"GPA"}),e.jsx(H,{children:"Status"})]})}),e.jsx(te,{children:g.map(d=>{var D,z;return e.jsxs(O,{children:[e.jsx(T,{children:((D=d.student)==null?void 0:D.name)||"Unknown Student"}),e.jsx(T,{children:((z=d.student)==null?void 0:z.student_number)||"N/A"}),e.jsx(T,{children:d.gpa||"-"}),e.jsx(T,{children:e.jsx(C,{variant:d.is_overridden?"destructive":"default",children:d.is_overridden?"Overridden":"Qualified"})})]},d.id)})})]})]},`${s.id}-${w}`)})})()})]})]})},s.key)):e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No academic levels found. Please check your database configuration."})]})})]})]})})]})]})}export{Ie as default};
