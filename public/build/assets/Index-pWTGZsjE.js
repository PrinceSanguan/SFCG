import{r as j,R as ue,m as Y,j as e,$ as Ee}from"./app-BkVPVcnZ.js";import{H as Ae}from"./header-fn5p6F9M.js";import{S as Ie}from"./sidebar-DOjktVe9.js";import{C as I,b as P,c as G,a as B}from"./card-Bo8tIcRE.js";import{B as g}from"./button-B_JxxeNr.js";import{I as u}from"./input-Cx4wUWfW.js";import{L as l}from"./label-BcrgAkRa.js";import{S as f,a as b,b as y,c as S,d as r}from"./select-CoS2EWLi.js";import{T as oe,a as he,b as q,c,d as xe,e as o}from"./table-CBhK0hIP.js";import{T as Pe}from"./textarea-GVAHCdH8.js";import{B as O}from"./badge-BiJ8FLd_.js";import{T as Ge,a as Be,b as M,c as Q}from"./tabs-C-lZtQA6.js";import{S as me}from"./search-DiP8F6T2.js";import{F as Fe}from"./filter-Dn5tegdF.js";import{D as Le}from"./download-D5ELlLZl.js";import{P as Ve}from"./printer-Dwaej0VG.js";/* empty css            */import"./dropdown-menu-B8lfSesE.js";import"./Combination-CDi_H7xM.js";import"./index-b6WblCkr.js";import"./separator-DdFB6N9C.js";import"./users-Cm1p8o7h.js";import"./chevron-right-cTjjTJdC.js";import"./crown-C8vRD1_G.js";import"./building-2-_kHq1BmW.js";import"./user-cog-DRHyIjqX.js";import"./book-open-B99evfDU.js";import"./user-check-kFvdi0jA.js";import"./graduation-cap-pCb_JQkn.js";import"./notebook-C53r2JQT.js";import"./chart-no-axes-column-increasing-BmFcAawg.js";import"./shield-BLAhEjWy.js";import"./index-DJyaaNh7.js";import"./index-CMduMO1j.js";import"./check-DzU7p3Bo.js";class Re extends ue.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,m){console.error("Certificate component error:",s,m)}render(){return this.state.hasError?e.jsx("div",{className:"flex min-h-screen bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error loading the certificates page."}),e.jsx(g,{onClick:()=>window.location.reload(),children:"Reload Page"})]})})}):this.props.children}}function Nt({user:E,academicLevels:s,templates:m,recentCertificates:K,qualifiedStudents:_=[],schoolYears:d}){var ce;const[h,He]=j.useState(((ce=s==null?void 0:s[0])==null?void 0:ce.id)??null),[N,ze]=j.useState((d==null?void 0:d[0])??"2024-2025"),[R,$]=j.useState("templates");ue.useEffect(()=>{console.log("Qualified Students Data:",_),console.log("Academic Levels Data:",s)},[_,s]);const[x,F]=j.useState({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),[H,ee]=j.useState([]),[J,te]=j.useState(!1),[L,V]=j.useState(1),[W,se]=j.useState(1),{data:p,setData:C,post:je,processing:ae}=Y({template_id:"",academic_level_id:h?h.toString():"",school_year:N,student_id:""}),[le,ge]=j.useState(""),[n,A]=j.useState({title:"Certificate",introText:"This is to certify that",studentIdLabel:"Student ID:",requirementText:"has fulfilled the requirements for",schoolYearLabel:"School Year:",issuedOnLabel:"Issued on",signatoryLabel:"Authorized Signatory"}),{data:X,setData:z,post:pe,processing:ve}=Y({academic_level_id:h?h.toString():"",key:"",name:"",content_html:""}),{data:T,setData:w,post:_e,processing:re,reset:fe}=Y({template_id:"",academic_level_id:h?h.toString():"",school_year:N,student_ids_text:"",student_ids:[]});j.useEffect(()=>{h&&w("academic_level_id",h.toString()),w("school_year",N)},[h,N,w]),j.useEffect(()=>{(s==null?void 0:s.length)>0&&x.academic_level_id==="all"&&F(t=>({...t,academic_level_id:s[0].id.toString()})),(d==null?void 0:d.length)>0&&x.school_year==="all"&&F(t=>({...t,school_year:d[0]}))},[s,d]),j.useEffect(()=>{R==="generate"&&h&&N&&C(t=>({...t,academic_level_id:h.toString(),school_year:N})),R==="bulk"&&h&&N&&w(t=>({...t,academic_level_id:h.toString(),school_year:N}))},[R,h,N]);const be=[{label:"Generate Today's Certificates",action:()=>$("bulk")},{label:"View Recent Downloads",action:()=>{F(t=>({...t,status:"downloaded"})),$("certificates")}},{label:"Pending Certificates",action:()=>{F(t=>({...t,status:"generated"})),$("certificates")}}],U=async(t=1)=>{te(!0);try{const i={};Object.entries(x).forEach(([De,Z])=>{Z&&Z!=="all"&&(i[De]=Z)});const a=new URLSearchParams({...i,page:t.toString()}),D=await(await fetch(`/admin/academic/certificates/search?${a}`)).json();ee(D.data||[]),V(D.current_page||1),se(D.last_page||1)}catch(i){console.error("Search failed:",i),ee([]),V(1),se(1)}finally{te(!1)}},k=(t,i)=>{F(a=>({...a,[t]:i}))},ye=t=>{t.preventDefault(),V(1),U(1)},ie=t=>{V(t),U(t)},Se=()=>{F({serial_number:"",student_name:"",student_number:"",template_id:"all",academic_level_id:"all",school_year:"all",status:"all",date_from:"",date_to:""}),V(1),U(1)},Ne=t=>{t.preventDefault(),je(route("admin.academic.certificates.generate"))},ne=(m==null?void 0:m.filter(t=>!p.academic_level_id||t.academic_level_id.toString()===p.academic_level_id))??[],Ce=(m==null?void 0:m.filter(t=>!T.academic_level_id||t.academic_level_id.toString()===T.academic_level_id))??[],de=()=>`
<div style="text-align:center; padding:24px; border:4px double #333;">
  <h1 style="margin:0; font-size:28px;">${n.title}</h1>
  <p style="margin:8px 0 0 0;">${n.introText}</p>
  <h2 style="margin:8px 0;">{{student_name}}</h2>
  <p style="margin:0;">${n.studentIdLabel} <strong>{{student_number}}</strong></p>
  <p style="margin:8px 0 0 0;">${n.requirementText}</p>
  <h3 style="margin:8px 0;">{{academic_level}}</h3>
  <p style="margin:0;">${n.schoolYearLabel} <strong>{{school_year}}</strong></p>
  <div style="margin-top:24px;">${n.issuedOnLabel} {{date_now}}</div>
  <div style="margin-top:32px;">_________________________<br/>${n.signatoryLabel}</div>
  <div style="margin-top:8px; font-size:10px;">Serial: will appear in PDF filename</div>
</div>`,we=j.useMemo(()=>{const t=s.find(v=>v.id.toString()===(p.academic_level_id||(h==null?void 0:h.toString())||"")),i=de(),a={"{{student_name}}":"Sample Student","{{student_number}}":"EL-2024-001","{{school_year}}":p.school_year||N,"{{academic_level}}":(t==null?void 0:t.name)||"Elementary","{{date_now}}":new Date().toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})};return Object.keys(a).reduce((v,D)=>v.replaceAll(D,a[D]),i)},[n,p.school_year,s,h,N,p.academic_level_id]),Te=t=>{t.preventDefault(),z("content_html",de()),pe(route("admin.academic.certificates.templates.store"))},ke=t=>{t.preventDefault();const i=(T.student_ids_text||"").split(`
`).map(a=>a.trim()).filter(Boolean);i.length!==0&&(w("student_ids",i),_e(route("admin.academic.certificates.generate-bulk"),{preserveScroll:!0,onSuccess:()=>{fe("student_ids_text"),U(L)}}))};return e.jsx(Re,{children:e.jsxs("div",{className:"flex min-h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(Ie,{user:E}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Ae,{user:E}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 min-h-0",children:e.jsxs("div",{className:"flex flex-col gap-6 pb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Certificates"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Templates, generation (individual/bulk), download and print tracking."})]}),e.jsx(Ee,{href:route("admin.academic.index"),children:e.jsx(g,{variant:"outline",children:"Back to Academic"})})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:be.map((t,i)=>e.jsx(g,{variant:"outline",size:"sm",onClick:t.action,className:"flex items-center gap-2",children:e.jsx("span",{children:t.label})},i))}),e.jsxs(Ge,{value:R,onValueChange:$,className:"w-full",children:[e.jsxs(Be,{className:"grid w-full grid-cols-4",children:[e.jsx(M,{value:"templates",children:"Templates"}),e.jsx(M,{value:"generate",children:"Generate"}),e.jsx(M,{value:"bulk",children:"Bulk Generate"}),e.jsx(M,{value:"certificates",children:"All Certificates"})]}),e.jsx(Q,{value:"templates",className:"space-y-6",children:e.jsxs(I,{children:[e.jsx(P,{children:e.jsx(G,{children:"Template Builder & Preview"})}),e.jsx(B,{children:e.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(f,{value:X.academic_level_id,onValueChange:t=>{z("academic_level_id",t),C("academic_level_id",t)},children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select level"})}),e.jsx(S,{children:s&&s.length>0?s.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year (Preview)"}),e.jsxs(f,{value:p.school_year,onValueChange:t=>C("school_year",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select year"})}),e.jsx(S,{children:d&&d.length>0?d.map(t=>e.jsx(r,{value:t,children:t},t)):e.jsx(r,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template Key"}),e.jsx(u,{value:X.key,onChange:t=>z("key",t.target.value),placeholder:"e.g., elementary_recognition_v2"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Template Name"}),e.jsx(u,{value:X.name,onChange:t=>z("name",t.target.value),placeholder:"Display name"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Title"}),e.jsx(u,{value:n.title,onChange:t=>A({...n,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Intro line"}),e.jsx(u,{value:n.introText,onChange:t=>A({...n,introText:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student ID label"}),e.jsx(u,{value:n.studentIdLabel,onChange:t=>A({...n,studentIdLabel:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Requirement text"}),e.jsx(u,{value:n.requirementText,onChange:t=>A({...n,requirementText:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School year label"}),e.jsx(u,{value:n.schoolYearLabel,onChange:t=>A({...n,schoolYearLabel:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Issued on label"}),e.jsx(u,{value:n.issuedOnLabel,onChange:t=>A({...n,issuedOnLabel:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{children:"Signatory label"}),e.jsx(u,{value:n.signatoryLabel,onChange:t=>A({...n,signatoryLabel:t.target.value})})]})]}),e.jsx("div",{className:"rounded border bg-white p-4 shadow-sm dark:bg-gray-800 overflow-auto max-h-[600px]",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:we}})}),e.jsx("div",{children:e.jsx(g,{type:"submit",disabled:ve,children:"Save Template"})})]})})]})}),e.jsxs(Q,{value:"generate",className:"space-y-6",children:[e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(G,{children:"Generate (Individual)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate a single certificate for one student. Fill in the details below."})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template"}),e.jsxs(f,{value:p.template_id,onValueChange:t=>C("template_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select template"})}),e.jsx(S,{children:ne.length>0?ne.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"loading",disabled:!0,children:"No templates for this level"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the certificate template to use"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(f,{value:p.academic_level_id,onValueChange:t=>C("academic_level_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select level"})}),e.jsx(S,{children:s&&s.length>0?s.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),e.jsxs(f,{value:p.school_year,onValueChange:t=>C("school_year",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select year"})}),e.jsx(S,{children:d&&d.length>0?d.map(t=>e.jsx(r,{value:t,children:t},t)):e.jsx(r,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Identifier"}),e.jsx(u,{value:p.student_id,onChange:t=>C("student_id",t.target.value),placeholder:"Enter numeric user ID or student_number (e.g., EL-2024-001)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the student's User ID or Student Number"}),p.student_id&&e.jsx($e,{identifier:p.student_id,onResolved:t=>ge(t)}),le&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800",children:["âœ“ Student Found: ",le]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{type:"submit",disabled:ae,className:"flex items-center gap-2",children:ae?"Generating...":"Generate Certificate"}),e.jsx(g,{type:"button",variant:"outline",onClick:()=>C("student_id",""),children:"Clear Form"})]})]})})]}),e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ†"}),"Qualified Students for Certificate Generation"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Students who have qualified for honors and are eligible for certificate generation."})]}),e.jsx(B,{children:_&&_.length>0?e.jsx("div",{className:"space-y-4",children:s&&s.map(t=>{if(!t||!t.id)return null;const i=_.filter(a=>a&&a.academic_level_id===t.id);return i.length===0?null:e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 text-blue-600",children:[t.name||"Unknown Level"," (",i.length," student",i.length!==1?"s":"",")"]}),e.jsx("div",{className:"grid gap-3",children:i.map(a=>!a||!a.student||!a.honor_type?null:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.student.name||"Unknown Student"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",a.student.student_number||"N/A"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:a.honor_type.name||"Unknown Honor"}),e.jsxs(O,{variant:"outline",className:"bg-green-100 text-green-800",children:["GPA: ",a.gpa||"N/A"]})]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{var v;a.student&&a.student.student_number&&(C("student_id",a.student.student_number),C("academic_level_id",((v=a.academic_level_id)==null?void 0:v.toString())||""),C("school_year",a.school_year||"2024-2025"))},className:"text-blue-600 hover:text-blue-800",disabled:!a.student||!a.student.student_number,children:"Generate Certificate"})})]},a.id))})]},t.id)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No qualified students found"}),e.jsx("p",{className:"text-sm",children:"Students need to have approved honor qualifications to appear here."})]})})]})]}),e.jsx(Q,{value:"bulk",className:"space-y-6",children:e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(G,{children:"Generate (Bulk)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate multiple certificates at once. Enter student identifiers (one per line) in the text area below."})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:ke,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template"}),e.jsxs(f,{value:T.template_id,onValueChange:t=>w("template_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select template"})}),e.jsx(S,{children:Ce.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id))})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the certificate template to use for all students"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(f,{value:T.academic_level_id,onValueChange:t=>w("academic_level_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select level"})}),e.jsx(S,{children:s&&s.length>0?s.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"no-levels",disabled:!0,children:"No levels available"})})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),e.jsxs(f,{value:T.school_year,onValueChange:t=>w("school_year",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select year"})}),e.jsx(S,{children:d&&d.length>0?d.map(t=>e.jsx(r,{value:t,children:t},t)):e.jsx(r,{value:"no-years",disabled:!0,children:"No years available"})})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Identifiers (one per line)"}),e.jsx(Pe,{value:T.student_ids_text,onChange:t=>w("student_ids_text",t.target.value),placeholder:`Enter user IDs or student numbers, one per line
Example:
EL-2024-001
EL-2024-002
12345`,rows:8}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:T.student_ids_text?`${T.student_ids_text.split(`
`).filter(t=>t.trim()).length} student(s) detected`:"Enter student identifiers above"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: User ID, Student Number"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{type:"submit",disabled:re,className:"flex items-center gap-2",children:re?"Generating...":"Generate Bulk Certificates"}),e.jsx(g,{type:"button",variant:"outline",onClick:()=>w("student_ids_text",""),children:"Clear List"})]})]})})]})}),e.jsxs(Q,{value:"certificates",className:"space-y-6",children:[e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Search & Filter Certificates"]}),e.jsx("p",{className:"text-sm text-gray-600",children:'Use the filters below to find specific certificates. Leave filters empty or set to "All" to see broader results.'})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Serial Number"}),e.jsx(u,{value:x.serial_number,onChange:t=>k("serial_number",t.target.value),placeholder:"e.g., CERT-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by partial serial number"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Name"}),e.jsx(u,{value:x.student_name,onChange:t=>k("student_name",t.target.value),placeholder:"e.g., Maria Santos"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student's full or partial name"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Student Number"}),e.jsx(u,{value:x.student_number,onChange:t=>k("student_number",t.target.value),placeholder:"e.g., EL-2024-001"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Search by student number"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Template"}),e.jsxs(f,{value:x.template_id,onValueChange:t=>k("template_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"All templates"})}),e.jsxs(S,{children:[e.jsx(r,{value:"all",children:"All templates"}),m&&m.length>0?m.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"no-templates",disabled:!0,children:"No templates available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Academic Level"}),e.jsxs(f,{value:x.academic_level_id,onValueChange:t=>k("academic_level_id",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"All levels"})}),e.jsxs(S,{children:[e.jsx(r,{value:"all",children:"All levels"}),s&&s.length>0?s.map(t=>e.jsx(r,{value:t.id.toString(),children:t.name},t.id)):e.jsx(r,{value:"no-levels",disabled:!0,children:"No levels available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"School Year"}),e.jsxs(f,{value:x.school_year,onValueChange:t=>k("school_year",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"All years"})}),e.jsxs(S,{children:[e.jsx(r,{value:"all",children:"All years"}),d&&d.length>0?d.map(t=>e.jsx(r,{value:t,children:t},t)):e.jsx(r,{value:"no-years",disabled:!0,children:"No years available"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Status"}),e.jsxs(f,{value:x.status,onValueChange:t=>k("status",t),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"All statuses"})}),e.jsxs(S,{children:[e.jsx(r,{value:"all",children:"All statuses"}),e.jsx(r,{value:"generated",children:"Generated"}),e.jsx(r,{value:"downloaded",children:"Downloaded"}),e.jsx(r,{value:"printed",children:"Printed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Date From"}),e.jsx(u,{type:"date",value:x.date_from,onChange:t=>k("date_from",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Date To"}),e.jsx(u,{type:"date",value:x.date_to,onChange:t=>k("date_to",t.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{type:"submit",disabled:J,className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),J?"Searching...":"Search"]}),e.jsxs(g,{type:"button",variant:"outline",onClick:Se,className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Clear Filters"]})]})]})})]}),e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(G,{children:"Search Results"}),H.length>0&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Found ",H.length," certificate(s)"]}),x.serial_number&&e.jsxs("span",{children:["â€¢ Serial: ",x.serial_number]}),x.student_name&&e.jsxs("span",{children:["â€¢ Student: ",x.student_name]}),x.status!=="all"&&e.jsxs("span",{children:["â€¢ Status: ",x.status]})]})]}),e.jsx(B,{children:H.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(he,{children:e.jsxs(q,{children:[e.jsx(c,{children:"Serial"}),e.jsx(c,{children:"Student"}),e.jsx(c,{children:"Student Number"}),e.jsx(c,{children:"Template"}),e.jsx(c,{children:"Level"}),e.jsx(c,{children:"School Year"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Generated"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(xe,{children:H.map(t=>{var i,a,v,D;return e.jsxs(q,{className:"hover:bg-gray-50",children:[e.jsx(o,{className:"font-mono text-sm",children:t.serial_number}),e.jsx(o,{className:"font-medium",children:(i=t.student)==null?void 0:i.name}),e.jsx(o,{children:((a=t.student)==null?void 0:a.student_number)||"-"}),e.jsx(o,{children:(v=t.template)==null?void 0:v.name}),e.jsx(o,{children:(D=t.academicLevel)==null?void 0:D.name}),e.jsx(o,{children:t.school_year}),e.jsx(o,{children:e.jsx(O,{variant:t.status==="generated"?"secondary":t.status==="downloaded"?"default":"outline",children:t.status})}),e.jsx(o,{children:t.generated_at?new Date(t.generated_at).toLocaleDateString():"-"}),e.jsxs(o,{className:"space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",asChild:!0,children:e.jsx("a",{href:route("admin.academic.certificates.download",{certificate:t.id}),children:e.jsx(Le,{className:"h-4 w-4"})})}),e.jsx(g,{size:"sm",variant:"outline",asChild:!0,children:e.jsx("a",{href:route("admin.academic.certificates.print",{certificate:t.id}),target:"_blank",children:e.jsx(Ve,{className:"h-4 w-4"})})})]})]},t.id)})})]}),W>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",L," of ",W]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>ie(L-1),disabled:L<=1,children:"Previous"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>ie(L+1),disabled:L>=W,children:"Next"})]})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:J?"Searching...":"No certificates found. Use the search filters above to find certificates."})})]})]})]}),e.jsxs(I,{children:[e.jsx(P,{children:e.jsx(G,{children:"Recent Certificates"})}),e.jsx(B,{children:e.jsxs(oe,{children:[e.jsx(he,{children:e.jsxs(q,{children:[e.jsx(c,{children:"Serial"}),e.jsx(c,{children:"Student"}),e.jsx(c,{children:"Template"}),e.jsx(c,{children:"Level"}),e.jsx(c,{children:"School Year"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Generated"}),e.jsx(c,{children:"Downloaded"}),e.jsx(c,{children:"Printed"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(xe,{children:K.map(t=>{var i,a,v;return e.jsxs(q,{children:[e.jsx(o,{children:t.serial_number}),e.jsx(o,{children:(i=t.student)==null?void 0:i.name}),e.jsx(o,{children:(a=t.template)==null?void 0:a.name}),e.jsx(o,{children:(v=t.academicLevel)==null?void 0:v.name}),e.jsx(o,{children:t.school_year}),e.jsx(o,{children:e.jsx(O,{variant:t.status==="generated"?"secondary":t.status==="downloaded"?"default":"outline",children:t.status})}),e.jsx(o,{children:t.generated_at?new Date(t.generated_at).toLocaleString():"-"}),e.jsx(o,{children:t.downloaded_at?new Date(t.downloaded_at).toLocaleString():"-"}),e.jsx(o,{children:t.printed_at?new Date(t.printed_at).toLocaleString():"-"}),e.jsxs(o,{className:"space-x-2",children:[e.jsx("a",{className:"text-blue-600 hover:text-blue-800",href:route("admin.academic.certificates.download",{certificate:t.id}),children:"Download"}),e.jsx("a",{className:"text-blue-600 hover:text-blue-800",href:route("admin.academic.certificates.print",{certificate:t.id}),target:"_blank",children:"Print"})]})]},t.id)})})]})})]})]})})]})]})})}function $e({identifier:E,onResolved:s}){return j.useEffect(()=>{let m=!0;if(!E)return;const K=route("admin.academic.certificates.resolve-student",{q:E});return fetch(K).then(_=>_.json()).then(_=>{m&&(_.found?s(_.name+(_.student_number?` (${_.student_number})`:"")):s(""))}).catch(()=>{m&&s("")}),()=>{m=!1}},[E]),null}export{Nt as default};
