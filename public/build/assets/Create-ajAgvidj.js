import{m as A,r as V,j as e,$ as y}from"./app-0TNFwnus.js";import{S as Y,H as U}from"./sidebar-bdtYXnRA.js";import{C as B,b as H,c as D,a as R}from"./card-dmKNXiu7.js";import{B as x}from"./button-Cg-cUhb0.js";import{I as f}from"./input-Bt2PfQ3H.js";import{L as i}from"./label-DC38C1mO.js";import{S as h,a as u,b as g,c as j,d as c}from"./select-DRGfn34J.js";import{A as T}from"./arrow-left-BT0wFGA4.js";import{P as $}from"./plus-C-uDfaQv.js";import{S as G}from"./save-sntlvWag.js";/* empty css            */import"./dropdown-menu-BieTSFD5.js";import"./Combination-B04g0BTx.js";import"./index-r0F0kDWm.js";import"./user-Dj-A_5Os.js";import"./log-out-CH1I5seq.js";import"./book-open-C1wJxWWC.js";import"./graduation-cap-lwq_PMnd.js";import"./upload-BlEAPimq.js";import"./crown-DPF9sYjF.js";import"./index-BO0l3lML.js";import"./index-CeSwYtyd.js";import"./check-BVELoB9z.js";function he({user:b,academicLevels:o,gradingPeriods:N,assignedSubjects:m}){var w,C,k,I;const{data:a,setData:t,post:F,processing:_,errors:s}=A({student_id:"",subject_id:"",academic_level_id:"",grading_period_id:"0",school_year:"2024-2025",year_of_study:"",grade:""});V.useEffect(()=>{const r=new URLSearchParams(window.location.search),d=r.get("student_id"),l=r.get("subject_id"),p=r.get("academic_level_id"),P=r.get("school_year");d&&l&&p&&(t("student_id",d),t("subject_id",l),t("academic_level_id",p),t("school_year",P||"2024-2025"),window.history.replaceState({},"",window.location.pathname))},[t]);const E=r=>{if(!r)return null;for(const d of m)if(d.enrolled_students.find(p=>p.student.id.toString()===r))return{subjectId:d.subject.id,academicLevelId:d.academicLevel.id,schoolYear:d.school_year};return null},L=r=>{if(t("student_id",r),r){const d=E(r);d&&(t("subject_id",d.subjectId.toString()),t("academic_level_id",d.academicLevelId.toString()),t("school_year",d.schoolYear))}else t("subject_id",""),t("academic_level_id",""),t("grade","")},n=()=>{var r;return a.academic_level_id?(r=o.find(d=>d.id.toString()===a.academic_level_id))==null?void 0:r.key:null},S=r=>{r.preventDefault(),F(route("adviser.grades.store"))},v=a.student_id&&a.subject_id&&a.academic_level_id;return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(Y,{user:b}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(U,{user:b}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{href:route("adviser.grades.index"),children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:v?"Input Grade":"Input New Grade"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:v?"Enter a grade for the selected student.":"Enter a new grade for a student in your advisory subject."})]})]}),e.jsxs(B,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Grade Information"]})}),e.jsx(R,{children:v?e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Student:"}),e.jsx("p",{className:"font-medium",children:((C=(w=m.find(r=>r.enrolled_students.some(d=>d.student.id.toString()===a.student_id)))==null?void 0:w.enrolled_students.find(r=>r.student.id.toString()===a.student_id))==null?void 0:C.student.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Subject:"}),e.jsx("p",{className:"font-medium",children:((k=m.find(r=>r.subject.id.toString()===a.subject_id))==null?void 0:k.subject.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Academic Level:"}),e.jsx("p",{className:"font-medium",children:((I=o.find(r=>r.id.toString()===a.academic_level_id))==null?void 0:I.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"School Year:"}),e.jsx("p",{className:"font-medium",children:a.school_year})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(f,{id:"grade",type:"number",step:"0.01",min:n()==="college"?"1.0":"0",max:n()==="college"?"5.0":"100",placeholder:n()==="college"?"Enter grade (1.0-5.0)":"Enter grade (0-100)",value:a.grade,onChange:r=>t("grade",r.target.value),className:s.grade?"border-red-500":"",autoFocus:!0}),s.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.grade})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(h,{value:a.grading_period_id,onValueChange:r=>t("grading_period_id",r),children:[e.jsx(u,{className:s.grading_period_id?"border-red-500":"",children:e.jsx(g,{placeholder:"Select grading period"})}),e.jsx(j,{children:N.filter(r=>{const d=o.find(l=>l.id.toString()===a.academic_level_id);return!d||r.academic_level_id!==d.id?!1:d.key==="senior_highschool"||d.key==="college"?!r.parent_id:!0}).map(r=>e.jsx(c,{value:r.id.toString(),children:r.name},r.id))})]}),s.grading_period_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.grading_period_id})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(x,{type:"submit",disabled:_,className:"flex-1",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),_?"Saving...":"Save Grade"]}),e.jsx(y,{href:route("adviser.grades.index"),className:"flex-1",children:e.jsx(x,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]}):e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"student_id",children:"Student"}),e.jsxs(h,{value:a.student_id,onValueChange:L,children:[e.jsx(u,{className:s.student_id?"border-red-500":"",children:e.jsx(g,{placeholder:"Select a student"})}),e.jsx(j,{children:m.filter(r=>r.subject&&r.subject.id&&r.enrolled_students).flatMap(r=>r.enrolled_students.filter(d=>d.student&&d.student.id).map(d=>e.jsxs(c,{value:d.student.id.toString(),children:[d.student.name," - ",r.subject.name]},d.student.id)))})]}),s.student_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.student_id})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(h,{value:a.subject_id,onValueChange:r=>t("subject_id",r),children:[e.jsx(u,{className:s.subject_id?"border-red-500":"",children:e.jsx(g,{placeholder:"Select a subject"})}),e.jsx(j,{children:m.filter(r=>r.subject&&r.subject.id).map(r=>e.jsx(c,{value:r.subject.id.toString(),children:r.subject.name},r.subject.id))})]}),s.subject_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.subject_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"academic_level_id",children:"Academic Level"}),e.jsxs(h,{value:a.academic_level_id,onValueChange:r=>t({...a,academic_level_id:r,grading_period_id:"0"}),children:[e.jsx(u,{className:s.academic_level_id?"border-red-500":"",children:e.jsx(g,{placeholder:"Select academic level"})}),e.jsx(j,{children:o.map(r=>e.jsx(c,{value:r.id.toString(),children:r.name},r.id))})]}),s.academic_level_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.academic_level_id})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grading_period_id",children:"Grading Period"}),e.jsxs(h,{value:a.grading_period_id,onValueChange:r=>t("grading_period_id",r),disabled:!a.academic_level_id,children:[e.jsx(u,{children:e.jsx(g,{placeholder:"Select grading period (optional)"})}),e.jsxs(j,{children:[e.jsx(c,{value:"0",children:"No Period"}),N.filter(r=>{const d=o.find(l=>l.id.toString()===a.academic_level_id);return!d||r.academic_level_id!==d.id?!1:d.key==="senior_highschool"||d.key==="college"?!r.parent_id:!0}).map(r=>e.jsx(c,{value:r.id.toString(),children:r.name},r.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"school_year",children:"School Year"}),e.jsx(f,{id:"school_year",type:"text",placeholder:"e.g., 2024-2025",value:a.school_year,onChange:r=>t("school_year",r.target.value),className:s.school_year?"border-red-500":""}),s.school_year&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.school_year})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"year_of_study",children:"Year of Study"}),e.jsx(f,{id:"year_of_study",type:"number",min:"1",max:"10",placeholder:"e.g., 1, 2, 3, 4",value:a.year_of_study,onChange:r=>t("year_of_study",r.target.value),className:s.year_of_study?"border-red-500":""})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"grade",children:"Grade"}),e.jsx(f,{id:"grade",type:"number",step:"0.01",min:n()==="college"?"1.0":"0",max:n()==="college"?"5.0":"100",placeholder:n()==="college"?"Enter grade (1.0-5.0)":"Enter grade (0-100)",value:a.grade,onChange:r=>t("grade",r.target.value),className:s.grade?"border-red-500":""}),s.grade&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.grade})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs(x,{type:"submit",disabled:_,className:"flex-1",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),_?"Saving...":"Save Grade"]}),e.jsx(y,{href:route("adviser.grades.index"),className:"flex-1",children:e.jsx(x,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})})]})]})})]})]})})]})]})}export{he as default};
