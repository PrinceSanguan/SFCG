import{c as _,r as B,j as e,L as U,$ as N,C as w,S as $}from"./app-amIQygQf.js";import{H as I}from"./header-Cml728-S.js";import{S as H}from"./sidebar-ibX9gxvY.js";import{C as t,b as r,c as l,a as i,d as m}from"./card-BZz6pFlG.js";import{B as d}from"./button-D-ThuB9i.js";import{B as c}from"./badge-JzcZ6yjG.js";import{T as X,a as K,b as h,c as j}from"./tabs-Cn6Fq89N.js";import{A as D}from"./activity-Bo55wKeq.js";import{U as y}from"./users-BLYZFxe1.js";import{C as M}from"./circle-x-D2PHe94H.js";import{S as E}from"./shield-U0gS447d.js";import{C as G}from"./clock-D0IqkncT.js";import{D as Q}from"./download-B_jtdacu.js";import{T as J}from"./trash-2-DtJowx3p.js";import{T as z}from"./triangle-alert-sa9353sq.js";import{E as W}from"./eye-tamQMhTH.js";/* empty css            */import"./dropdown-menu-DX9DNke_.js";import"./Combination-B9WtIDLh.js";import"./index-DnDAp_6W.js";import"./separator-CxQfMZie.js";import"./chevron-right-CvhPdniM.js";import"./crown-AjgVpnV1.js";import"./building-2-Bbl4mEZ4.js";import"./user-cog-TYV4yRVL.js";import"./book-open-5YNx6lOt.js";import"./user-check-C9amUJxK.js";import"./graduation-cap-D3PXwbfu.js";import"./notebook-CJWGgRPa.js";import"./chart-no-axes-column-increasing-qrIUYeeg.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],b=_("Database",Y);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],L=_("PowerOff",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],F=_("Power",ee);function De({user:k,recentActivities:C,sessionStats:x,securityStats:a,backupInfo:u,maintenanceMode:v,flash:o}){const[g,A]=B.useState(!1),[p,f]=B.useState(!1),T=async()=>{var s;A(!0);try{await fetch(route("admin.security.create-backup"),{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),window.location.reload()}catch(n){console.error("Failed to create backup:",n)}finally{A(!1)}},S=()=>{f(!0),$.post(route("admin.security.toggle-maintenance-mode"),{},{onSuccess:()=>{f(!1)},onError:s=>{console.error("Failed to toggle maintenance mode:",s),alert("Failed to toggle maintenance mode. Please try again."),f(!1)},onFinish:()=>{f(!1)}})},O=s=>{window.open(route("admin.security.download-backup",{filename:s}),"_blank")},P=async s=>{var n;if(confirm(`Are you sure you want to delete backup: ${s}?`))try{await fetch(route("admin.security.delete-backup",{filename:s}),{method:"DELETE",headers:{"X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""}}),window.location.reload()}catch(q){console.error("Failed to delete backup:",q)}},R=s=>({login:"bg-green-100 text-green-800",logout:"bg-gray-100 text-gray-800",failed_login:"bg-red-100 text-red-800",unauthorized_admin_access:"bg-red-100 text-red-800",reset_password:"bg-blue-100 text-blue-800",create_backup:"bg-purple-100 text-purple-800",download_backup:"bg-blue-100 text-blue-800",delete_backup:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",V=s=>new Date(s).toLocaleString();return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(H,{user:k}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(I,{user:k}),e.jsxs("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:[e.jsx(U,{title:"System Audit & Security"}),(o==null?void 0:o.success)&&e.jsx("div",{className:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded",children:o.success}),(o==null?void 0:o.error)&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:o.error}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"System Audit & Security"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Monitor system activity, manage login sessions, and perform data backups"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(N,{href:route("admin.security.activity-logs"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"View All Logs"]})}),e.jsx(N,{href:route("admin.security.login-sessions"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Manage Sessions"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.active_sessions}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.total_sessions," total sessions"]})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Today's Logins"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.today_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_logins," total logins"]})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(M,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.total_failed_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_unauthorized_access," unauthorized attempts"]})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Database Backups"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u.total_backups}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.total_size_formatted," total size"]})]})]})]}),e.jsxs(X,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(K,{className:"grid w-full grid-cols-5",children:[e.jsx(h,{value:"overview",children:"Overview"}),e.jsx(h,{value:"recent-activity",children:"Recent Activity"}),e.jsx(h,{value:"system-control",children:"System Control"}),e.jsx(h,{value:"backups",children:"Backup Management"}),e.jsx(h,{value:"security",children:"Security Status"})]}),e.jsx(j,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),"Session Overview"]}),e.jsx(m,{children:"Current login session statistics"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Sessions"}),e.jsx(c,{variant:"secondary",children:x.total_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Sessions"}),e.jsx(c,{variant:"default",children:x.active_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unique Users"}),e.jsx(c,{variant:"outline",children:x.unique_users})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Inactive Sessions"}),e.jsx(c,{variant:"destructive",children:x.inactive_sessions})]})]})]}),e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Security Overview"]}),e.jsx(m,{children:"System security statistics"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Logins"}),e.jsx(c,{variant:"default",children:a.total_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Failed Logins"}),e.jsx(c,{variant:"destructive",children:a.total_failed_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unauthorized Access"}),e.jsx(c,{variant:"destructive",children:a.total_unauthorized_access})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Password Resets"}),e.jsx(c,{variant:"outline",children:a.total_password_resets})]})]})]})]})}),e.jsx(j,{value:"recent-activity",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Recent System Activity"]}),e.jsx(m,{children:"Latest system events and user actions"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:C.length>0?C.map(s=>{var n;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:R(s.action),children:s.action.replace("_"," ")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((n=s.user)==null?void 0:n.name)||"System"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.entity_type," • ",s.ip_address]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm text-gray-500",children:V(s.created_at)})})]},s.id)}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent activity found"})})})]})}),e.jsx(j,{value:"system-control",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),"System Control & Maintenance"]}),e.jsx(m,{children:"Control system access and perform emergency actions"})]}),e.jsx(i,{className:"space-y-6",children:e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold flex items-center gap-2 mb-2",children:v?e.jsxs(c,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"}),"MAINTENANCE MODE ACTIVE"]}):e.jsxs(c,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),"System Normal"]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v?"All user accounts are shut down. Only admin accounts can access the system.":"System is running normally. All users can access their accounts."})]}),e.jsx("div",{className:"flex gap-3",children:v?e.jsxs(d,{variant:"default",onClick:S,disabled:p,className:"flex-1",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),p?"Enabling...":"Enable System"]}):e.jsxs(d,{variant:"destructive",onClick:S,disabled:p,className:"flex-1",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),p?"Disabling...":"Disable System"]})})]})})]})}),e.jsx(j,{value:"backups",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5"}),"Database Backup Management"]}),e.jsx(m,{children:"Create, download, and manage database backups"})]}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Create New Backup"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Generate a new database backup"})]}),e.jsx(d,{onClick:T,disabled:g,className:"bg-blue-600 hover:bg-blue-700",children:g?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Create Backup"]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4",children:"Available Backups"}),u.backups.length>0?e.jsx("div",{className:"space-y-3",children:u.backups.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.filename}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.size_formatted," • ",s.created_at]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>O(s.filename),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Download"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>P(s.filename),className:"text-red-600 hover:text-red-700",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]},n))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No backups available"})]})]})]})}),e.jsx(j,{value:"security",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-yellow-600"}),"Security Alerts"]}),e.jsx(m,{children:"Recent security events and warnings"})]}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-3",children:[a.total_failed_logins>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx(z,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_failed_logins," failed login attempts detected"]})]}),a.total_unauthorized_access>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx(M,{className:"w-4 h-4 text-red-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_unauthorized_access," unauthorized access attempts"]})]}),a.total_failed_logins===0&&a.total_unauthorized_access===0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[e.jsx(w,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:"No security alerts - system is secure"})]})]})})]}),e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Quick Actions"]}),e.jsx(m,{children:"Common security management tasks"})]}),e.jsxs(i,{className:"space-y-3",children:[e.jsx(N,{href:route("admin.security.activity-logs"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"View Activity Logs"]})}),e.jsx(N,{href:route("admin.security.login-sessions"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Manage Login Sessions"]})}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:T,disabled:g,children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),g?"Creating Backup...":"Create Database Backup"]})]})]})]})})]})]})]})]})]})}export{De as default};
