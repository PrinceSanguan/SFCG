import{j as e,$ as k}from"./app-BAqdKzRe.js";import{S as B,H as D}from"./sidebar-DSitLY2H.js";import{C as f,b,c as y,a as p}from"./card-DGY5CJ_r.js";import{B as _}from"./button-Dgg7RRwo.js";import{B as N}from"./badge-YBJD95uJ.js";import{A as E}from"./arrow-left-DiqEuVbo.js";import{U as v}from"./user-dAO1XXi5.js";import{M as L}from"./mail-__JSTUW0.js";import{B as C}from"./book-open-DabesNP2.js";import{G as w}from"./graduation-cap-BX1Tk1aW.js";import{C as G}from"./calendar-CeJjuctv.js";import{P as M}from"./plus-CC2NAYO2.js";import{S as V}from"./square-pen-CJyDCZot.js";/* empty css            */import"./dropdown-menu-CQybs8HY.js";import"./Combination-5NOhm_Dh.js";import"./index-C93lzRn6.js";import"./log-out-C5wyPJbW.js";import"./upload-B63ZtUBD.js";import"./crown-CxBrFsG-.js";function ie({user:S,student:n,subject:x,academicLevel:g,grades:u,gradingPeriods:j}){const o=u.length>0?u[0]:null,h=g.key,F=(s,l)=>l==="college"?s<=1.5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s<=2.5?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s<=3?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":s>=90?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s>=80?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s>=75?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",A=(s,l)=>l==="college"?s<=1.5?"Superior":s<=2?"Very Good":s<=2.5?"Good":s<=3?"Satisfactory":"Failing":s>=95?"Outstanding":s>=90?"Very Good":s>=85?"Good":s>=80?"Satisfactory":s>=75?"Fair":"Failing",c=(()=>{console.log("ðŸ” DEBUG - getSemesterStructure called with:",{academicLevelKey:h,allGradingPeriods:j.map(t=>({id:t.id,name:t.name,code:t.code}))});let s=j.filter(t=>{const a=h,r=t.code.toLowerCase().includes(a.toLowerCase());return console.log(`ðŸ” Period "${t.name}" (${t.code}) relevant for ${a}:`,r),r});if(s.length===0&&(console.log("ðŸ” No level-specific periods found, using all active periods"),s=j.filter(t=>t.is_active)),console.log("ðŸ” DEBUG - Relevant periods after filtering:",s.map(t=>({id:t.id,name:t.name,code:t.code}))),["senior_highschool","college"].includes(h)){const t={};s.forEach(r=>{let d=1;const i=r.name.toLowerCase(),m=r.code.toLowerCase();(m.includes("s2")||m.includes("2nd")||m.includes("second")||i.includes("second")||i.includes("2nd")||m.includes("_s2")||m.includes("semester_2"))&&(d=2),t[d]||(t[d]={name:`${d===1?"First":"Second"} Semester`,periods:[]}),!r.name.toLowerCase().includes("final average")&&!r.code.includes("FA")&&!r.name.toLowerCase().includes("final")&&!r.code.toLowerCase().includes("final")&&t[d].periods.push({id:r.id,name:r.name,code:r.code,gradingPeriodId:r.id})});let a=Object.keys(t).map(r=>({semesterNumber:parseInt(r),...t[r]}));if(a.length===0||a.every(r=>r.periods.length===0)){console.log("ðŸ” No periods grouped by semester, creating fallback structure");const r=s.filter(d=>!d.name.toLowerCase().includes("final average")&&!d.code.includes("FA")&&!d.name.toLowerCase().includes("final")&&!d.code.toLowerCase().includes("final"));if(console.log("ðŸ” All input periods for fallback:",r.map(d=>({id:d.id,name:d.name,code:d.code}))),r.length>0)if(r.length>=2){const d=Math.ceil(r.length/2);a=[{semesterNumber:1,name:"First Semester",periods:r.slice(0,d).map(i=>({id:i.id,name:i.name,code:i.code,gradingPeriodId:i.id}))},{semesterNumber:2,name:"Second Semester",periods:r.slice(d).map(i=>({id:i.id,name:i.name,code:i.code,gradingPeriodId:i.id}))}].filter(i=>i.periods.length>0)}else a=[{semesterNumber:1,name:"Semester",periods:r.map(d=>({id:d.id,name:d.name,code:d.code,gradingPeriodId:d.id}))}]}return console.log("ðŸ” Final semester structure (semester-based):",a),a}else{const t=[{semesterNumber:1,name:"Academic Year",periods:s.filter(a=>!a.name.toLowerCase().includes("final average")&&!a.code.includes("FA")).sort((a,r)=>a.id-r.id).map(a=>({id:a.id,name:a.name,code:a.code,gradingPeriodId:a.id}))}];return console.log("ðŸ” Final quarter structure:",t),t}})();return console.log("ðŸ” DEBUG - Show component data:",{academicLevelKey:h,academicLevel:g,gradingPeriods:j.map(s=>({id:s.id,name:s.name,code:s.code})),semesterStructure:c,totalGradingPeriods:j.length,semesterStructureLength:c.length,totalPeriodsInStructure:c.reduce((s,l)=>s+l.periods.length,0)}),c.reduce((s,l)=>s+l.periods.length,0),e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(B,{user:S}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(D,{user:S}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{href:route("instructor.grades.index"),children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Back to Grades"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Student Details"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["View and manage grades for ",n.name]})]})]})}),e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"Personal Information"]})}),e.jsx(p,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(v,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx("p",{className:"font-medium",children:n.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(v,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Student ID"}),e.jsx("p",{className:"font-medium",children:n.student_number||n.id})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"font-medium",children:n.email})]})]})]})})]}),n.parents&&n.parents.length>0&&e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"Linked Parents"]})}),e.jsx(p,{children:e.jsx("div",{className:"space-y-3",children:n.parents.map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]}),e.jsx(N,{variant:"outline",children:s.pivot.relationship_type.charAt(0).toUpperCase()+s.pivot.relationship_type.slice(1)})]}),s.pivot.emergency_contact&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Emergency Contact: ",s.pivot.emergency_contact]}),s.pivot.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Notes: ",s.pivot.notes]})]})},s.id))})})]}),e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Subject & Course Information"]})}),e.jsx(p,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(C,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Subject"}),e.jsxs("p",{className:"font-medium",children:[x.name," (",x.code,")"]})]})]}),x.course&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Course"}),e.jsxs("p",{className:"font-medium",children:[x.course.name," (",x.course.code,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Academic Level"}),e.jsx("p",{className:"font-medium",children:g.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center",children:e.jsx(G,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"School Year"}),e.jsx("p",{className:"font-medium",children:(o==null?void 0:o.school_year)||"N/A"})]})]})]})})]}),e.jsxs(f,{children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Grading Periods"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Available grading periods for ",g.name]})]}),e.jsx(p,{children:j.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:j.map(s=>e.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx(N,{variant:"outline",className:"text-xs",children:s.code})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}),e.jsx("div",{className:"mt-2",children:e.jsx(N,{className:s.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",children:s.is_active?"Active":"Inactive"})})]},s.id))}):e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["No grading periods configured for ",g.name]})})})]}),e.jsxs(f,{className:"bg-white shadow-sm",children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(w,{className:"h-5 w-5 text-gray-600"}),"Grade Summary"]})}),e.jsx(p,{children:(()=>{const s=u.filter(l=>l.grade!==null&&l.grade!==void 0);if(s.length>0||c.length>0){const l=s.reduce((i,m)=>i+m.grade,0),t=s.length>0?l/s.length:0,a=t>0?A(t,h):"No Grade",r=c.flatMap(i=>i.periods.map(m=>({...m,semesterName:i.name}))),d=["bg-blue-500 text-white","bg-green-500 text-white","bg-orange-500 text-white","bg-purple-500 text-white","bg-pink-500 text-white","bg-indigo-500 text-white"];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.map((i,m)=>{const I=u.find($=>$.grading_period_id===i.gradingPeriodId),P=d[m%d.length];return e.jsxs("div",{className:`${P} rounded-lg p-4 text-center`,children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:I?I.grade:"-"}),e.jsx("div",{className:"text-sm opacity-90",children:i.name})]},i.id)})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 text-center min-w-48",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:t>0?t.toFixed(2):"-"}),e.jsx("div",{className:"text-gray-600 mb-2",children:"Overall Average"}),t>0&&e.jsx(N,{className:`${["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(a)?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:a})]})})]})}else return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(w,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Grade Yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This student hasn't received a grade for this subject yet."})]})})()})]}),e.jsxs(f,{className:"bg-white shadow-sm",children:[e.jsx(b,{children:e.jsxs(y,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(G,{className:"h-5 w-5 text-gray-600"}),"Detailed Grades"]})}),e.jsx(p,{children:u.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:(()=>{const s=["senior_highschool","college"].includes(h),l=c.reduce((a,r)=>a+r.periods.length,0);if(s&&l>0&&c.length>1)return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-900 text-white",children:[e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Student ID"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Subject"}),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"Faculty"}),c.map(a=>e.jsx("th",{className:"text-center p-2 border-r border-gray-600",colSpan:a.periods.length,children:a.name},a.semesterNumber)),e.jsx("th",{className:"p-2 border-r border-gray-600",rowSpan:2,children:"AVERAGE"}),e.jsx("th",{className:"p-2",rowSpan:2,children:"Grade Status"})]}),e.jsx("tr",{className:"bg-gray-800 text-white",children:c.flatMap(a=>a.periods.map(r=>e.jsx("th",{className:"text-center p-2 border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)))})]});{const a=c.flatMap(r=>r.periods);return e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Student ID"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Subject"}),e.jsx("th",{className:"text-left p-3 font-medium border-r border-gray-700",children:"Faculty"}),a.map(r=>e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:r.name.replace(/First Semester /,"").replace(/Second Semester /,"").replace(/First /,"").replace(/Second /,"").replace(/Semester /,"").trim()},r.id)),e.jsx("th",{className:"text-center p-3 font-medium border-r border-gray-700",children:"AVERAGE"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Grade Status"})]})}})()}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b bg-white hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-r border-gray-200 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2 text-gray-400"}),n.student_number||n.id]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:x.name}),e.jsx("div",{className:"text-sm text-gray-500",children:x.code})]})]})}),e.jsx("td",{className:"p-3 border-r border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("div",{className:"text-sm text-gray-600",children:S.name})]})}),c.flatMap(l=>l.periods).map(l=>{const t=u.find(a=>a.grading_period_id===l.gradingPeriodId);return e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:t?e.jsx(N,{className:F(t.grade,h),children:t.grade}):e.jsx("span",{className:"text-gray-400",children:"-"})},l.id)}),e.jsx("td",{className:"p-3 border-r border-gray-200 text-center",children:(()=>{const s=u.filter(l=>l.grade!==null&&l.grade!==void 0).map(l=>l.grade);if(s.length>0){const l=s.reduce((t,a)=>t+a,0)/s.length;return e.jsx(N,{className:`text-lg px-3 py-1 ${F(l,h)}`,children:l.toFixed(2)})}else return e.jsx("span",{className:"text-gray-400",children:"-"})})()}),e.jsx("td",{className:"p-3 text-center",children:(()=>{const s=u.filter(l=>l.grade!==null&&l.grade!==void 0).map(l=>l.grade);if(s.length>0){const l=s.reduce((a,r)=>a+r,0)/s.length,t=A(l,h);return e.jsx(N,{className:`${["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(t)?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t})}else return e.jsx("span",{className:"text-gray-400",children:"No Grade"})})()})]})})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-gray-500",children:"No grade history available"})]})})]}),e.jsx(f,{children:e.jsx(p,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(k,{href:route("instructor.grades.create")+`?student_id=${n.id}&subject_id=${x.id}&academic_level_id=${g.id}&academic_level_key=${g.key}&school_year=${(o==null?void 0:o.school_year)||"2024-2025"}`,className:"flex-1",onClick:()=>{console.log("Navigating to grade creation with params:",{student_id:n.id,subject_id:x.id,academic_level_id:g.id,academic_level_key:g.key,school_year:(o==null?void 0:o.school_year)||"2024-2025"})},children:e.jsxs(_,{className:"w-full",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Input New Grade"]})}),o&&e.jsx(k,{href:route("instructor.grades.edit",o.id),className:"flex-1",children:e.jsxs(_,{variant:"outline",className:"w-full",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Edit Current Grade"]})})]})})})]})})]})]})}export{ie as default};
