import{m as W,R as w,r as X,K as Y,j as e,$ as F,S as O}from"./app-DDII9HhH.js";import{H as Z}from"./header-DvV7OMo7.js";import{S as U}from"./sidebar-CRoDqs2g.js";import{C as y,b as f,c as g,a as S}from"./card-D07m7gMr.js";import{B as ee}from"./badge-1xcu611Q.js";import{B as j}from"./button-DXrvcmA2.js";import{I as m}from"./input-BmXRpMLV.js";import{L as d}from"./label-eWcCo5v0.js";import{S as x,a as p,b as u,c as _,d as o}from"./select-DE_6tRoY.js";import{A as t,a as s}from"./alert-BDVC7Xqm.js";import{P as ie}from"./PasswordResetModal-Ch0dMywk.js";import{A as ne}from"./arrow-left-DlH31aNs.js";import{S as ae}from"./save-D6lWoK-z.js";import{R as ce}from"./rotate-ccw-Z1CHNSYD.js";/* empty css            */import"./dropdown-menu-B_fnoprz.js";import"./Combination-CjKBS6xB.js";import"./index-JuYvo5xb.js";import"./separator-BqHQRHGZ.js";import"./users-DqFhZmfP.js";import"./chevron-right-BOzxW_-M.js";import"./crown-CeXaD_Th.js";import"./building-2-CThWSM9q.js";import"./user-cog-AFzEmo05.js";import"./book-open-B6c1fpNO.js";import"./user-check-CC2sRs2e.js";import"./graduation-cap-I5YI9Xe2.js";import"./notebook-ClSqw8Mv.js";import"./chart-no-axes-column-increasing-CxsMWIm9.js";import"./shield-DVtSEr6Z.js";import"./index-Bj6IIrOj.js";import"./index-DF2IYx7E.js";import"./check-CXC9Mpci.js";import"./dialog-DjfECiWc.js";import"./eye-DtMNpBKL.js";const le=h=>{if(!h)return"";const n=new Date(h);if(isNaN(n.getTime()))return"";const N=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),v=String(n.getDate()).padStart(2,"0");return`${N}-${a}-${v}`};function Oe({user:h,targetUser:n,roles:N,errors:a,yearLevels:v,specificYearLevels:b,strands:E,courses:k,departments:D}){var $,M,B,H;const{data:c,setData:l,put:T,processing:R}=W({name:(n==null?void 0:n.name)||"",email:(n==null?void 0:n.email)||"",user_role:(n==null?void 0:n.user_role)||"",academic_level:(n==null?void 0:n.year_level)||"",specific_year_level:(n==null?void 0:n.specific_year_level)||"",strand_id:(($=n==null?void 0:n.strand_id)==null?void 0:$.toString())||"",course_id:((M=n==null?void 0:n.course_id)==null?void 0:M.toString())||"",department_id:((B=n==null?void 0:n.department_id)==null?void 0:B.toString())||"",section_id:((H=n==null?void 0:n.section_id)==null?void 0:H.toString())||"",student_number:(n==null?void 0:n.student_number)||"",birth_date:le(n==null?void 0:n.birth_date),gender:(n==null?void 0:n.gender)||"",phone_number:(n==null?void 0:n.phone_number)||"",address:(n==null?void 0:n.address)||"",emergency_contact_name:(n==null?void 0:n.emergency_contact_name)||"",emergency_contact_phone:(n==null?void 0:n.emergency_contact_phone)||"",emergency_contact_relationship:(n==null?void 0:n.emergency_contact_relationship)||""}),[A,C]=w.useState([]),[P,L]=w.useState(!1),[q,V]=X.useState(!1),{errors:G}=Y().props;if(!h||!n)return e.jsx("div",{children:"Loading..."});w.useEffect(()=>{const i={};if(!c.academic_level){C([]);return}c.academic_level&&(i.academic_level_key=c.academic_level),c.specific_year_level&&(i.specific_year_level=c.specific_year_level),c.strand_id&&(i.strand_id=c.strand_id.toString()),c.department_id&&(i.department_id=c.department_id.toString()),c.course_id&&(i.course_id=c.course_id.toString());const r=new URLSearchParams(i).toString();L(!0),fetch(route("admin.academic.api.sections")+(r?`?${r}`:"")).then(async I=>{if(!I.ok)throw new Error("Failed to load sections");const Q=await I.json();C(Q||[])}).catch(()=>C([])).finally(()=>L(!1))},[c.academic_level,c.specific_year_level,c.strand_id,c.department_id,c.course_id]);const J=i=>{i.preventDefault(),T(route("admin.students.update",n.id))},z=()=>{V(!0)},K=i=>{switch(i){case"admin":return"default";case"registrar":case"teacher":case"instructor":case"adviser":case"chairperson":case"principal":return"secondary";case"student":case"parent":return"outline";default:return"outline"}};return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(U,{user:h}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Z,{user:h}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{href:route("admin.students.index"),children:e.jsxs(j,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Back to Students"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Edit Student"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Update student information and role assignments."})]})]}),e.jsxs(y,{children:[e.jsx(f,{children:e.jsx(g,{children:"Current Student Information"})}),e.jsx(S,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx("p",{className:"text-lg",children:n.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"text-lg",children:n.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Current Role"}),e.jsx(ee,{variant:K(n.user_role),className:"mt-1",children:N[n.user_role]||n.user_role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Member Since"}),e.jsx("p",{className:"text-lg",children:new Date(n.created_at).toLocaleDateString()})]})]})})]}),e.jsxs(y,{children:[e.jsx(f,{children:e.jsx(g,{children:"Update Student Information"})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Full Name *"}),e.jsx(m,{id:"name",type:"text",value:c.name,onChange:i=>l("name",i.target.value),placeholder:"Enter full name",required:!0}),(a==null?void 0:a.name)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email Address *"}),e.jsx(m,{id:"email",type:"email",value:c.email,onChange:i=>l("email",i.target.value),placeholder:"Enter email address",required:!0}),(a==null?void 0:a.email)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.email})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"academic_level",children:"Academic Level *"}),e.jsxs(x,{value:c.academic_level,onValueChange:i=>{l("academic_level",i),l("specific_year_level",""),l("strand_id",""),l("course_id",""),l("department_id",""),l("section_id","")},children:[e.jsx(p,{children:e.jsx(u,{placeholder:"Select academic level"})}),e.jsx(_,{children:(v||{elementary:"Elementary",junior_highschool:"Junior High School",senior_highschool:"Senior High School",college:"College"})&&Object.entries(v||{elementary:"Elementary",junior_highschool:"Junior High School",senior_highschool:"Senior High School",college:"College"}).map(([i,r])=>e.jsx(o,{value:i,children:r},i))})]}),(a==null?void 0:a.academic_level)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.academic_level})})]}),c.academic_level&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"specific_year_level",children:"Year Level *"}),e.jsxs(x,{value:c.specific_year_level,onValueChange:i=>{l("specific_year_level",i),l("section_id","")},children:[e.jsx(p,{children:e.jsx(u,{placeholder:"Select year level"})}),e.jsx(_,{children:b&&b[c.academic_level]&&Object.entries(b[c.academic_level]).map(([i,r])=>e.jsx(o,{value:i,children:r},i))})]}),(a==null?void 0:a.specific_year_level)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.specific_year_level})})]}),c.academic_level==="senior_highschool"&&c.specific_year_level&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"strand_id",children:"Strand *"}),e.jsxs(x,{value:c.strand_id,onValueChange:i=>{l("strand_id",i),l("section_id","")},children:[e.jsx(p,{children:e.jsx(u,{placeholder:"Select a strand"})}),e.jsx(_,{children:E&&E.map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")",i.track?` - ${i.track.name}`:""]},i.id))})]}),(a==null?void 0:a.strand_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.strand_id})})]}),c.academic_level==="college"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"department_id",children:"Department *"}),e.jsxs(x,{value:c.department_id,onValueChange:i=>{l("department_id",i),l("course_id",""),l("section_id","")},children:[e.jsx(p,{children:e.jsx(u,{placeholder:"Select a department"})}),e.jsx(_,{children:D&&D.filter(i=>i.academic_level_id===4).map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")"]},i.id))})]}),(a==null?void 0:a.department_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.department_id})})]}),c.academic_level==="college"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"course_id",children:"Course *"}),e.jsxs(x,{value:c.course_id,onValueChange:i=>{l("course_id",i),l("section_id","")},disabled:!c.department_id,children:[e.jsx(p,{children:e.jsx(u,{placeholder:c.department_id?"Select a course":"Select department first"})}),e.jsx(_,{children:k&&k.filter(i=>!c.department_id||i.department_id.toString()===c.department_id).map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name," (",i.code,")"]},i.id))})]}),(a==null?void 0:a.course_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.course_id})})]}),c.academic_level&&e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"section_id",children:"Section *"}),e.jsxs(x,{value:c.section_id,onValueChange:i=>l("section_id",i),disabled:P||!c.specific_year_level&&c.academic_level!=="college",children:[e.jsx(p,{children:e.jsx(u,{placeholder:P?"Loading sections...":A.length?"Select a section":"No sections available"})}),e.jsx(_,{children:A.map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.name,i.code?` (${i.code})`:"",typeof i.max_students=="number"&&typeof i.current_students=="number"?` â€¢ ${i.current_students}/${i.max_students}`:""]},i.id))})]}),(a==null?void 0:a.section_id)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.section_id})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"student_number",children:"Student Number"}),e.jsx(m,{id:"student_number",type:"text",value:c.student_number,onChange:i=>l("student_number",i.target.value),placeholder:"e.g. EL-2025-000123"}),(a==null?void 0:a.student_number)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.student_number})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Last Login"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded border dark:bg-gray-800",children:n.last_login_at?new Date(n.last_login_at).toLocaleString():"Never logged in"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"birth_date",children:"Birth Date"}),e.jsx(m,{id:"birth_date",type:"date",value:c.birth_date,onChange:i=>l("birth_date",i.target.value)}),(a==null?void 0:a.birth_date)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.birth_date})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"gender",children:"Gender"}),e.jsxs(x,{value:c.gender,onValueChange:i=>l("gender",i),children:[e.jsx(p,{children:e.jsx(u,{placeholder:"Select gender"})}),e.jsxs(_,{children:[e.jsx(o,{value:"male",children:"Male"}),e.jsx(o,{value:"female",children:"Female"}),e.jsx(o,{value:"other",children:"Other"})]})]}),(a==null?void 0:a.gender)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.gender})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(m,{id:"phone_number",type:"tel",value:c.phone_number,onChange:i=>l("phone_number",i.target.value),placeholder:"Enter phone number"}),(a==null?void 0:a.phone_number)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.phone_number})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"address",children:"Address"}),e.jsx(m,{id:"address",type:"text",value:c.address,onChange:i=>l("address",i.target.value),placeholder:"Enter complete address"}),(a==null?void 0:a.address)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.address})})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"emergency_contact_name",children:"Emergency Contact Name"}),e.jsx(m,{id:"emergency_contact_name",type:"text",value:c.emergency_contact_name,onChange:i=>l("emergency_contact_name",i.target.value),placeholder:"Enter emergency contact name"}),(a==null?void 0:a.emergency_contact_name)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"emergency_contact_phone",children:"Emergency Contact Phone"}),e.jsx(m,{id:"emergency_contact_phone",type:"tel",value:c.emergency_contact_phone,onChange:i=>l("emergency_contact_phone",i.target.value),placeholder:"Enter emergency contact phone"}),(a==null?void 0:a.emergency_contact_phone)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_phone})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"emergency_contact_relationship",children:"Relationship"}),e.jsx(m,{id:"emergency_contact_relationship",type:"text",value:c.emergency_contact_relationship,onChange:i=>l("emergency_contact_relationship",i.target.value),placeholder:"e.g., Father, Mother, Guardian, etc."}),(a==null?void 0:a.emergency_contact_relationship)&&e.jsx(t,{variant:"destructive",children:e.jsx(s,{children:a.emergency_contact_relationship})})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-6",children:[e.jsxs(j,{type:"submit",disabled:R,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),R?"Updating...":"Update Student"]}),e.jsx(F,{href:route("admin.students.index"),children:e.jsx(j,{type:"button",variant:"outline",children:"Cancel"})})]})]})})]}),e.jsxs(y,{children:[e.jsx(f,{children:e.jsx(g,{children:"Password Management"})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Reset the student's password to allow them to regain access to their account. A new temporary password will be generated."}),e.jsxs(j,{onClick:z,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Reset Password"]})]})})]}),e.jsxs(y,{children:[e.jsx(f,{children:e.jsx(g,{children:"Additional Actions"})}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(F,{href:route("admin.students.show",n.id),children:e.jsx(j,{variant:"outline",children:"View Full Profile"})}),n.id!==h.id&&e.jsx(j,{variant:"destructive",onClick:()=>{confirm("Are you sure you want to delete this student? This action cannot be undone.")&&O.delete(route("admin.students.destroy",n.id),{onSuccess:()=>{O.visit(route("admin.students.index"))},onError:i=>{console.error("Delete failed:",i)}})},children:"Delete Student"})]})})]})]})})]}),e.jsx(ie,{user:n,isOpen:q,onClose:()=>V(!1),errors:G})]})}export{Oe as default};
