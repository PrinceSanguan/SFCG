import{c as b,r as S,j as e,L as V,$ as g,C as v}from"./app-CwAilDmJ.js";import{H as U}from"./header-qWElt4da.js";import{S as $}from"./sidebar-DzyMPBPd.js";import{C as l,b as r,c as i,a as c,d as o}from"./card-CwQ73FwS.js";import{B as d}from"./button-2LR9sYmP.js";import{B as n}from"./badge-CEDDdRU7.js";import{T as I,a as X,b as x,c as h}from"./tabs-CTDCssES.js";import{A as B}from"./activity-BLBym7j3.js";import{U as f}from"./users-Dl_rufss.js";import{C as D}from"./circle-x-BBO7vJbH.js";import{S as M}from"./shield-CRMRCL2c.js";import{C as H}from"./clock-BPLS-fff.js";import{D as K}from"./download-C3ltAYTf.js";import{T as G}from"./trash-2-CQUYG9TL.js";import{T as E}from"./triangle-alert-DessB0eg.js";import{E as Q}from"./eye-TZlKRIb9.js";/* empty css            */import"./dropdown-menu-Cfl7VJny.js";import"./Combination-DwvEvkyY.js";import"./index-DrYiIGug.js";import"./separator-Co_LPU4D.js";import"./chevron-right--K6MafSv.js";import"./crown-BKqZHP4v.js";import"./building-2-CJa9d8cV.js";import"./user-cog-DPqi_Dvp.js";import"./book-open-CwKKKHEz.js";import"./user-check-wFI1XRo-.js";import"./graduation-cap-CZDr064K.js";import"./notebook-CTJA3rAC.js";import"./chart-no-axes-column-increasing-DnyhkLdh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],N=b("Database",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],z=b("PowerOff",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],L=b("Power",Y);function Se({user:w,recentActivities:_,sessionStats:m,securityStats:a,backupInfo:j,maintenanceMode:y}){const[u,k]=S.useState(!1),[p,C]=S.useState(!1),A=async()=>{var s;k(!0);try{await fetch(route("admin.security.create-backup"),{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),window.location.reload()}catch(t){console.error("Failed to create backup:",t)}finally{k(!1)}},T=async()=>{var s;C(!0);try{await fetch(route("admin.security.toggle-maintenance-mode"),{method:"POST",headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}}),window.location.reload()}catch(t){console.error("Failed to toggle maintenance mode:",t)}finally{C(!1)}},O=s=>{window.open(route("admin.security.download-backup",{filename:s}),"_blank")},F=async s=>{var t;if(confirm(`Are you sure you want to delete backup: ${s}?`))try{await fetch(route("admin.security.delete-backup",{filename:s}),{method:"DELETE",headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}}),window.location.reload()}catch(q){console.error("Failed to delete backup:",q)}},R=s=>({login:"bg-green-100 text-green-800",logout:"bg-gray-100 text-gray-800",failed_login:"bg-red-100 text-red-800",unauthorized_admin_access:"bg-red-100 text-red-800",reset_password:"bg-blue-100 text-blue-800",create_backup:"bg-purple-100 text-purple-800",download_backup:"bg-blue-100 text-blue-800",delete_backup:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",P=s=>new Date(s).toLocaleString();return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx($,{user:w}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(U,{user:w}),e.jsxs("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:[e.jsx(V,{title:"System Audit & Security"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"System Audit & Security"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Monitor system activity, manage login sessions, and perform data backups"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(g,{href:route("admin.security.activity-logs"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"View All Logs"]})}),e.jsx(g,{href:route("admin.security.login-sessions"),children:e.jsxs(d,{variant:"outline",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Manage Sessions"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.active_sessions}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.total_sessions," total sessions"]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Today's Logins"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.today_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_logins," total logins"]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.total_failed_logins}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.total_unauthorized_access," unauthorized attempts"]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Database Backups"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.total_backups}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[j.total_size_formatted," total size"]})]})]})]}),e.jsxs(I,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(X,{className:"grid w-full grid-cols-5",children:[e.jsx(x,{value:"overview",children:"Overview"}),e.jsx(x,{value:"recent-activity",children:"Recent Activity"}),e.jsx(x,{value:"system-control",children:"System Control"}),e.jsx(x,{value:"backups",children:"Backup Management"}),e.jsx(x,{value:"security",children:"Security Status"})]}),e.jsx(h,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5"}),"Session Overview"]}),e.jsx(o,{children:"Current login session statistics"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Sessions"}),e.jsx(n,{variant:"secondary",children:m.total_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Sessions"}),e.jsx(n,{variant:"default",children:m.active_sessions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unique Users"}),e.jsx(n,{variant:"outline",children:m.unique_users})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Inactive Sessions"}),e.jsx(n,{variant:"destructive",children:m.inactive_sessions})]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Security Overview"]}),e.jsx(o,{children:"System security statistics"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Logins"}),e.jsx(n,{variant:"default",children:a.total_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Failed Logins"}),e.jsx(n,{variant:"destructive",children:a.total_failed_logins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unauthorized Access"}),e.jsx(n,{variant:"destructive",children:a.total_unauthorized_access})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Password Resets"}),e.jsx(n,{variant:"outline",children:a.total_password_resets})]})]})]})]})}),e.jsx(h,{value:"recent-activity",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Recent System Activity"]}),e.jsx(o,{children:"Latest system events and user actions"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:_.length>0?_.map(s=>{var t;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:R(s.action),children:s.action.replace("_"," ")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((t=s.user)==null?void 0:t.name)||"System"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.entity_type," • ",s.ip_address]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm text-gray-500",children:P(s.created_at)})})]},s.id)}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent activity found"})})})]})}),e.jsx(h,{value:"system-control",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"System Control & Maintenance"]}),e.jsx(o,{children:"Control system access and perform emergency actions"})]}),e.jsx(c,{className:"space-y-6",children:e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold flex items-center gap-2 mb-2",children:y?e.jsxs(n,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3"}),"MAINTENANCE MODE ACTIVE"]}):e.jsxs(n,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"}),"System Normal"]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y?"All user accounts are shut down. Only admin accounts can access the system.":"System is running normally. All users can access their accounts."})]}),e.jsx("div",{className:"flex gap-3",children:y?e.jsxs(d,{variant:"default",onClick:T,disabled:p,className:"flex-1",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),p?"Enabling...":"Enable System"]}):e.jsxs(d,{variant:"destructive",onClick:T,disabled:p,className:"flex-1",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),p?"Disabling...":"Disable System"]})})]})})]})}),e.jsx(h,{value:"backups",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Database Backup Management"]}),e.jsx(o,{children:"Create, download, and manage database backups"})]}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Create New Backup"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Generate a new database backup"})]}),e.jsx(d,{onClick:A,disabled:u,className:"bg-blue-600 hover:bg-blue-700",children:u?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Create Backup"]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4",children:"Available Backups"}),j.backups.length>0?e.jsx("div",{className:"space-y-3",children:j.backups.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.filename}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.size_formatted," • ",s.created_at]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>O(s.filename),children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Download"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>F(s.filename),className:"text-red-600 hover:text-red-700",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]},t))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No backups available"})]})]})]})}),e.jsx(h,{value:"security",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-yellow-600"}),"Security Alerts"]}),e.jsx(o,{children:"Recent security events and warnings"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[a.total_failed_logins>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx(E,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_failed_logins," failed login attempts detected"]})]}),a.total_unauthorized_access>0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx(D,{className:"w-4 h-4 text-red-600"}),e.jsxs("span",{className:"text-sm",children:[a.total_unauthorized_access," unauthorized access attempts"]})]}),a.total_failed_logins===0&&a.total_unauthorized_access===0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[e.jsx(v,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:"No security alerts - system is secure"})]})]})})]}),e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Quick Actions"]}),e.jsx(o,{children:"Common security management tasks"})]}),e.jsxs(c,{className:"space-y-3",children:[e.jsx(g,{href:route("admin.security.activity-logs"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"View Activity Logs"]})}),e.jsx(g,{href:route("admin.security.login-sessions"),className:"w-full",children:e.jsxs(d,{variant:"outline",className:"w-full justify-start",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Manage Login Sessions"]})}),e.jsxs(d,{variant:"outline",className:"w-full justify-start",onClick:A,disabled:u,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),u?"Creating Backup...":"Create Database Backup"]})]})]})]})})]})]})]})]})]})}export{Se as default};
