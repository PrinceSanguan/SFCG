import{K as J,r as h,m as S,j as e,$ as W,S as X}from"./app-BqRVH9uQ.js";import{H as Z}from"./header-C99s7Elc.js";import{S as ee}from"./sidebar-lw5bz39z.js";import{C,b as _,c as w,a as L}from"./card-uib_UIld.js";import{B as F}from"./badge-BGANasZD.js";import{B as r}from"./button-YZOPFkNi.js";import{I as p}from"./input-DqRekPdm.js";import{L as l}from"./label-BPqe6qMS.js";import{S as E,a as T,b as A,c as I,d as u}from"./select-UD00BQ0b.js";import{T as se}from"./textarea-P74hodEW.js";import{I as c}from"./input-error-D3ip3enk.js";import{A as te}from"./arrow-left-iBiA4jBX.js";import{S as ae}from"./save-B4tgMGUr.js";import{U as P}from"./users-CZvbsWs7.js";import{P as $}from"./plus-Cb6gMuPD.js";import{T as re}from"./trash-2-CY3aduef.js";/* empty css            */import"./dropdown-menu-LRhVYsUU.js";import"./Combination-BtaHBhlH.js";import"./index-C1SyYpBH.js";import"./separator-Cl5fbbUy.js";import"./chevron-right-BwK9V5E3.js";import"./crown-ZJaPoKkh.js";import"./user-check-C5ARbRPB.js";import"./user-cog-Czph-bh7.js";import"./book-open-JtwdhjKy.js";import"./graduation-cap-CVPr4A6q.js";import"./chart-no-axes-column-increasing-Dr8H6bj5.js";import"./shield-SYMVJH89.js";import"./index-DvjneCxi.js";import"./index-cBu56d7h.js";function ze({user:j,parent:t,allStudents:z,relationshipTypes:B}){var N,k;const{errors:i}=J().props,[d,m]=h.useState(!1),{data:g,setData:v,put:D,processing:y}=S({name:t.name||"",email:t.email||""}),{data:x,setData:o,post:U,processing:f,reset:R}=S({student_id:"",relationship_type:"",emergency_contact:"no",notes:""}),[V,H]=h.useState(""),O=s=>{s.preventDefault(),D(route("admin.parents.update",t.id))},q=s=>{s.preventDefault(),U(route("admin.parents.link-student",t.id),{onSuccess:()=>{R(),m(!1)}})},M=(s,a)=>{confirm(`Are you sure you want to unlink ${a} from this parent?`)&&X.delete(route("admin.parents.unlink-student",[t.id,s]))},Q=s=>{switch(s){case"father":return"default";case"mother":return"secondary";case"guardian":return"outline";case"other":return"destructive";default:return"outline"}},K=s=>s.charAt(0).toUpperCase()+s.slice(1),Y=((N=t.students)==null?void 0:N.map(s=>s.id))||[],n=z.filter(s=>!Y.includes(s.id)),G=h.useMemo(()=>{const s={};return n.forEach(a=>{s[`${a.name} (${a.email})`]=a.id}),s},[n]);return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(ee,{user:j}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Z,{user:j}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{href:route("admin.parents.index"),children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Back to Parents"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Edit Parent Account"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Update parent information and manage student relationships."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(C,{children:[e.jsx(_,{children:e.jsx(w,{children:"Parent Information"})}),e.jsx(L,{children:e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(p,{id:"name",type:"text",value:g.name,onChange:s=>v("name",s.target.value),required:!0,className:"mt-1"}),e.jsx(c,{message:i.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",children:"Email Address"}),e.jsx(p,{id:"email",type:"email",value:g.email,onChange:s=>v("email",s.target.value),required:!0,className:"mt-1"}),e.jsx(c,{message:i.email,className:"mt-2"})]}),e.jsx("div",{className:"flex items-center gap-4 pt-4",children:e.jsxs(r,{type:"submit",disabled:y,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Update Parent"]})})]})})]}),e.jsxs(C,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),"Student Relationships (",((k=t.students)==null?void 0:k.length)||0,")"]}),n.length>0&&e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>m(!d),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Link Student"]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"space-y-4",children:[d&&e.jsx("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-800",children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"student_search",children:"Select Student"}),e.jsx(p,{id:"student_search",className:"mt-1",list:"available-students",placeholder:"Type to search students by name or email...",value:V,onChange:s=>{const a=s.target.value;H(a);const b=G[a];o("student_id",b?String(b):"")}}),e.jsx("datalist",{id:"available-students",children:n.map(s=>e.jsx("option",{value:`${s.name} (${s.email})`},s.id))}),e.jsx(c,{message:i.student_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"relationship_type",children:"Relationship Type"}),e.jsxs(E,{value:x.relationship_type,onValueChange:s=>o("relationship_type",s),children:[e.jsx(T,{className:"mt-1",children:e.jsx(A,{placeholder:"Select relationship..."})}),e.jsx(I,{children:Object.entries(B).map(([s,a])=>e.jsx(u,{value:s,children:a},s))})]}),e.jsx(c,{message:i.relationship_type,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emergency_contact",children:"Emergency Contact"}),e.jsxs(E,{value:x.emergency_contact,onValueChange:s=>o("emergency_contact",s),children:[e.jsx(T,{className:"mt-1",children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(u,{value:"yes",children:"Yes"}),e.jsx(u,{value:"no",children:"No"})]})]}),e.jsx(c,{message:i.emergency_contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(se,{id:"notes",value:x.notes,onChange:s=>o("notes",s.target.value),placeholder:"Any additional information about this relationship...",className:"mt-1"}),e.jsx(c,{message:i.notes,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{type:"submit",disabled:f,size:"sm",children:f?"Linking...":"Link Student"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>m(!1),children:"Cancel"})]})]})}),t.students&&t.students.length>0?e.jsx("div",{className:"space-y-3",children:t.students.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]}),e.jsx(F,{variant:Q(s.pivot.relationship_type),children:K(s.pivot.relationship_type)}),s.pivot.emergency_contact==="yes"&&e.jsx(F,{variant:"secondary",children:"Emergency Contact"})]}),s.pivot.notes&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",s.pivot.notes]})]}),e.jsx(r,{variant:"destructive",size:"sm",onClick:()=>M(s.id,s.name),children:e.jsx(re,{className:"h-3 w-3"})})]},s.id))}):e.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[e.jsx(P,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No students linked to this parent."}),n.length>0&&e.jsxs(r,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>m(!0),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Link First Student"]})]}),n.length===0&&!d&&e.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:e.jsx("p",{className:"text-sm",children:"All available students are already linked."})})]})})]})]})]})})]})]})}export{ze as default};
