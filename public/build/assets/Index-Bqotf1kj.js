import{r as j,j as e,$ as f}from"./app-CwAilDmJ.js";import{S as $,H as D}from"./sidebar-D6fO2APU.js";import{C as v,b,c as k,a as w}from"./card-CwQ73FwS.js";import{B as c}from"./button-2LR9sYmP.js";import{B as G}from"./badge-CEDDdRU7.js";import{I as F}from"./input-ChjALQnL.js";import{S as I}from"./search-C0n5B2zl.js";import{P as S}from"./plus-yOdL6nxf.js";import{U as V}from"./upload-BJRLRGIF.js";import{S as B}from"./square-pen-DGFk9Rns.js";/* empty css            */import"./dropdown-menu-Cfl7VJny.js";import"./Combination-DwvEvkyY.js";import"./index-DrYiIGug.js";import"./user-Bk_bOO8x.js";import"./log-out-BGJKr-3e.js";import"./book-open-CwKKKHEz.js";import"./graduation-cap-CZDr064K.js";import"./crown-BKqZHP4v.js";function te({user:m,grades:n,assignedSubjects:t}){var y;const[o,L]=j.useState(""),[d,C]=j.useState("");if(console.log("GradesIndex props:",{user:m,grades:n,assignedSubjects:t}),console.log("assignedSubjects type:",typeof t),console.log("assignedSubjects is array:",Array.isArray(t)),console.log("assignedSubjects length:",t==null?void 0:t.length),!t||!Array.isArray(t))return console.log("Safety check failed - showing loading state"),e.jsx("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ“š"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Loading..."}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Please wait while we load your assigned subjects."}),e.jsxs("div",{className:"mt-4 text-sm text-gray-400",children:["Debug: assignedSubjects = ",JSON.stringify(t)]})]})})});const _=(a,r)=>r==="college"?a<=1.5?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":a<=2.5?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":a<=3?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":a>=90?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":a>=80?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":a>=75?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",x=(a,r)=>a===0?"No Grade":r==="college"?a<=1.5?"Superior":a<=2?"Very Good":a<=2.5?"Good":a<=3?"Satisfactory":"Failing":a>=95?"Outstanding":a>=90?"Very Good":a>=85?"Good":a>=80?"Satisfactory":a>=75?"Fair":"Failing",A=a=>{if(!a||!t||!Array.isArray(t))return[];const r=t.find(s=>{var l,i;return((i=(l=s.subject)==null?void 0:l.id)==null?void 0:i.toString())===a});return!r||!r.enrolled_students?[]:r.enrolled_students.map(s=>{var i,u,p;const l=(i=n==null?void 0:n.data)==null?void 0:i.find(N=>N.student.id===s.student.id&&N.subject.id===parseInt(a));return{id:s.student.id,name:s.student.name,email:s.student.email,latestGrade:l?l.grade:0,latestGradeDate:l?l.updated_at:"",academicLevel:{key:((u=r.academicLevel)==null?void 0:u.key)||"",name:((p=r.academicLevel)==null?void 0:p.name)||""},gradingPeriod:r.gradingPeriod?{name:r.gradingPeriod.name}:void 0,schoolYear:s.school_year}})},g=(t||[]).map(a=>{var s,l,i;if(console.log("Processing subject assignment:",a),!((s=a==null?void 0:a.subject)!=null&&s.id)||!((l=a==null?void 0:a.subject)!=null&&l.name)||!((i=a==null?void 0:a.academicLevel)!=null&&i.name))return console.log("Skipping subject - missing required structure:",a),null;const r={id:a.subject.id.toString(),name:a.subject.name,code:a.subject.code||"N/A",academicLevel:a.academicLevel.name,schoolYear:a.school_year||"N/A"};return console.log("Mapped subject:",r),r}).filter(a=>a!==null),P=a=>{const r=t.find(s=>s.enrolled_students.some(l=>l.student.id===a.id));r&&(window.location.href=route("instructor.grades.create")+`?student_id=${a.id}&subject_id=${r.subject.id}&academic_level_id=${r.academicLevel.id}&academic_level_key=${r.academicLevel.key}&school_year=${r.school_year}`)},h=d?A(d).filter(a=>a.name.toLowerCase().includes(o.toLowerCase())||a.email.toLowerCase().includes(o.toLowerCase())):[];return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx($,{user:m}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(D,{user:m}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Grade Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"View and manage student grades for your assigned subjects."})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(F,{placeholder:"Search students or subjects...",value:o,onChange:a=>L(a.target.value),className:"pl-10 w-full sm:w-64"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{href:route("instructor.grades.create"),className:d?"":"pointer-events-none",children:e.jsxs(c,{className:"flex items-center gap-2",disabled:!d,children:[e.jsx(S,{className:"h-4 w-4"}),"Input Grade"]})}),e.jsx(f,{href:route("instructor.grades.upload"),children:e.jsxs(c,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Upload CSV"]})})]})]}),e.jsxs(v,{children:[e.jsxs(b,{children:[e.jsx(k,{className:"text-lg",children:"Select Subject"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a subject to view and manage student grades"})]}),e.jsx(w,{children:g.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map(a=>e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${d===a.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 hover:border-gray-300 hover:bg-gray-50 dark:border-gray-700 dark:hover:border-gray-600 dark:hover:bg-gray-800/50"}`,onClick:()=>C(d===a.id?"":a.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.code}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[a.academicLevel," â€¢ ",a.schoolYear]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${d===a.id?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`})]})},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ“š"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Subjects Assigned"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"You haven't been assigned to any subjects yet."})]})})]}),d&&e.jsxs(v,{children:[e.jsx(b,{children:e.jsxs(k,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Student Grades - ",(y=g.find(a=>a.id===d))==null?void 0:y.name]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[h.length," students"]})]})}),e.jsx(w,{children:h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Student"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Latest Grade"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Last Updated"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:h.map(a=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.email})]})}),e.jsx("td",{className:"p-3",children:a.latestGrade===0?e.jsx(G,{variant:"outline",className:"text-gray-500",children:"No Grade"}):e.jsx(G,{className:_(a.latestGrade,a.academicLevel.key),children:a.latestGrade})}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`text-sm ${x(a.latestGrade,a.academicLevel.key)==="No Grade"?"text-gray-600 dark:text-gray-400":["Superior","Very Good","Good","Satisfactory","Fair","Outstanding"].includes(x(a.latestGrade,a.academicLevel.key))?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:x(a.latestGrade,a.academicLevel.key)})}),e.jsx("td",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:a.latestGradeDate?new Date(a.latestGradeDate).toLocaleDateString():"N/A"}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{href:route("instructor.grades.show-student",[a.id,d]),children:e.jsxs(c,{variant:"outline",size:"sm",onClick:r=>r.stopPropagation(),children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"View Details"]})}),e.jsxs(c,{size:"sm",onClick:r=>{r.stopPropagation(),P(a)},children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Input Grade"]})]})})]},a.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"h-16 w-16 text-gray-400 mx-auto mb-4",children:"ðŸ‘¥"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Students Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:o?"No students match your search criteria.":"No students are enrolled in this subject."})]})})]})]})})]})]})}export{te as default};
