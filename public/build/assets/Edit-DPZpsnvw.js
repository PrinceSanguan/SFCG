import{K as J,r as h,m as S,j as e,$ as W,S as X}from"./app-ZdS4OC5J.js";import{H as Z}from"./header-DlJxZVVf.js";import{S as ee}from"./sidebar-Bcw6_Rxa.js";import{C,b as _,c as w,a as L}from"./card-Ddd3ZDAH.js";import{B as F}from"./badge-D-F64-8i.js";import{B as r}from"./button-CRfWz0Rd.js";import{I as p}from"./input-DjsHE3Jf.js";import{L as l}from"./label-L9a_NpuG.js";import{S as A,a as E,b as T,c as $,d as u}from"./select-XybGIZ4S.js";import{T as se}from"./textarea-BIm0kf4c.js";import{I as c}from"./input-error-TCXzObEe.js";import{A as ae}from"./arrow-left-DSNOzxFV.js";import{S as te}from"./save-DCVqyyuw.js";import{U as I}from"./users-DsJfB1Io.js";import{P}from"./plus-DVeib6JZ.js";import{T as re}from"./trash-2-DONo3o6j.js";/* empty css            */import"./dropdown-menu-Dmm9VMiH.js";import"./Combination-BKxoB5vP.js";import"./index-C-5ELxtK.js";import"./separator-CkTjeCy1.js";import"./chevron-down-C36zrTJ1.js";import"./chevron-right-DKp3CJs3.js";import"./crown-Cc24jfQn.js";import"./building-2-DlXCgp8j.js";import"./user-cog-DdI29PYV.js";import"./book-open-DYnzbfKt.js";import"./user-plus-CA7tG-aU.js";import"./user-check-CrRY5aw3.js";import"./graduation-cap-BPUGZrbu.js";import"./notebook-B1MBnJt5.js";import"./chart-no-axes-column-increasing-B8-vL2CQ.js";import"./shield-C_NIAwsP.js";import"./index-BEZNt5OZ.js";import"./index-CaGGLmSV.js";import"./check-BKos4PBA.js";function Ve({user:j,parent:t,allStudents:z,relationshipTypes:B}){var N,k;const{errors:i}=J().props,[d,m]=h.useState(!1),{data:g,setData:v,put:D,processing:y}=S({name:t.name||"",email:t.email||""}),{data:x,setData:o,post:U,processing:f,reset:R}=S({student_id:"",relationship_type:"",emergency_contact:"no",notes:""}),[V,H]=h.useState(""),O=s=>{s.preventDefault(),D(route("admin.parents.update",t.id))},q=s=>{s.preventDefault(),U(route("admin.parents.link-student",t.id),{onSuccess:()=>{R(),m(!1)}})},M=(s,a)=>{confirm(`Are you sure you want to unlink ${a} from this parent?`)&&X.delete(route("admin.parents.unlink-student",[t.id,s]))},Q=s=>{switch(s){case"father":return"default";case"mother":return"secondary";case"guardian":return"outline";case"other":return"destructive";default:return"outline"}},K=s=>s.charAt(0).toUpperCase()+s.slice(1),Y=((N=t.students)==null?void 0:N.map(s=>s.id))||[],n=z.filter(s=>!Y.includes(s.id)),G=h.useMemo(()=>{const s={};return n.forEach(a=>{s[`${a.name} - ${a.academic_level||"N/A"} (${a.email})`]=a.id}),s},[n]);return e.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx(ee,{user:j}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Z,{user:j}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-100 p-4 md:p-6 dark:bg-gray-900",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{href:route("admin.parents.index"),children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Back to Parents"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Edit Parent Account"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Update parent information and manage student relationships."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(C,{children:[e.jsx(_,{children:e.jsx(w,{children:"Parent Information"})}),e.jsx(L,{children:e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(p,{id:"name",type:"text",value:g.name,onChange:s=>v("name",s.target.value),required:!0,className:"mt-1"}),e.jsx(c,{message:i.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",children:"Email Address"}),e.jsx(p,{id:"email",type:"email",value:g.email,onChange:s=>v("email",s.target.value),required:!0,className:"mt-1"}),e.jsx(c,{message:i.email,className:"mt-2"})]}),e.jsx("div",{className:"flex items-center gap-4 pt-4",children:e.jsxs(r,{type:"submit",disabled:y,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Update Parent"]})})]})})]}),e.jsxs(C,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Student Relationships (",((k=t.students)==null?void 0:k.length)||0,")"]}),n.length>0&&e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>m(!d),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Link Student"]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"space-y-4",children:[d&&e.jsx("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-800",children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"student_search",children:"Select Student"}),e.jsx(p,{id:"student_search",className:"mt-1",list:"available-students",placeholder:"Type to search students by name or email...",value:V,onChange:s=>{const a=s.target.value;H(a);const b=G[a];o("student_id",b?String(b):"")}}),e.jsx("datalist",{id:"available-students",children:n.map(s=>e.jsx("option",{value:`${s.name} - ${s.academic_level||"N/A"} (${s.email})`},s.id))}),e.jsx(c,{message:i.student_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"relationship_type",children:"Relationship Type"}),e.jsxs(A,{value:x.relationship_type,onValueChange:s=>o("relationship_type",s),children:[e.jsx(E,{className:"mt-1",children:e.jsx(T,{placeholder:"Select relationship..."})}),e.jsx($,{children:Object.entries(B).map(([s,a])=>e.jsx(u,{value:s,children:a},s))})]}),e.jsx(c,{message:i.relationship_type,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emergency_contact",children:"Emergency Contact"}),e.jsxs(A,{value:x.emergency_contact,onValueChange:s=>o("emergency_contact",s),children:[e.jsx(E,{className:"mt-1",children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(u,{value:"yes",children:"Yes"}),e.jsx(u,{value:"no",children:"No"})]})]}),e.jsx(c,{message:i.emergency_contact,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(se,{id:"notes",value:x.notes,onChange:s=>o("notes",s.target.value),placeholder:"Any additional information about this relationship...",className:"mt-1"}),e.jsx(c,{message:i.notes,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{type:"submit",disabled:f,size:"sm",children:f?"Linking...":"Link Student"}),e.jsx(r,{type:"button",variant:"outline",size:"sm",onClick:()=>m(!1),children:"Cancel"})]})]})}),t.students&&t.students.length>0?e.jsx("div",{className:"space-y-3",children:t.students.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]}),e.jsx(F,{variant:Q(s.pivot.relationship_type),children:K(s.pivot.relationship_type)}),s.pivot.emergency_contact==="yes"&&e.jsx(F,{variant:"secondary",children:"Emergency Contact"})]}),s.pivot.notes&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",s.pivot.notes]})]}),e.jsx(r,{variant:"destructive",size:"sm",onClick:()=>M(s.id,s.name),children:e.jsx(re,{className:"h-3 w-3"})})]},s.id))}):e.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[e.jsx(I,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No students linked to this parent."}),n.length>0&&e.jsxs(r,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>m(!0),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Link First Student"]})]}),n.length===0&&!d&&e.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:e.jsx("p",{className:"text-sm",children:"All available students are already linked."})})]})})]})]})]})})]})]})}export{Ve as default};
